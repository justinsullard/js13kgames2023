(()=>{let now=0,$dC=500,$gC=144e3,D=0,$zB=0,$FD=0,$DC=0,measure=0,beat=0,bar=0,step=0,$m=!0,$SC=1,$BD=32,$G=20,$R=-2,$C=4,$L=-1/8;const{cos,sin,min,max,sqrt,floor:$KB,ceil,round:$ZB,imul,abs,PI,sign:$XC}=Math,$u=(E=0,t=E=>E)=>new Array(E).fill(0).map((E,t)=>t).map(t),$CD=([E,t],T)=>[E*cos(T)-t*sin(T),E*sin(T)+t*cos(T)],$JC=([E,t,T],[A,s,n])=>[E+A,t+s,T+n],$oB=([E,t,T],[A,s,n])=>[E-A,t-s,T-n],$pC=(E,t=1e3)=>$ZB(E*t)/t,OF=(E,t)=>E<t?E/t:1,$yC=(E,t)=>max(0,OF(E,t)),IN=(E,t,T)=>t<E&&E<T,IS=(E,t)=>E instanceof t,$0C=(E,t=(E,t)=>E-t)=>E.sort(t),$0B=([E,t],T=1)=>[E*T,t*T],$MC=([E,t],T=1)=>{T/=$tC([E,t])||1;return[E*T,t*T]},$tC=([E,t],[T=0,A=0]=[])=>sqrt((T-E)**2+(A-t)**2),$z=E=>(0<E?$KB:ceil)(E),$cB=E=>(E<0?$KB:ceil)(E),$AB=E=>$XC(E)*$ZB(abs(E)),$d=2*PI,$VB=$u(128,E=>E?$d/E:0),$AD=(...E)=>Object.assign(...E),$rB=(E,t)=>E.forEach?.(t),$vC=(E,t)=>E.map(t),$I=(E,t)=>E.y-t.y||E.z-t.z||E.x-t.x,$oC=E=>1+2.70158*(E-1)**3+1.70158*(E-1)**2,$lC=E=>E*E*(2.70158*E-1.70158),$mC=E=>1-cos(E*PI/2),$tB=E=>-(cos(PI*E)-1)/2,$IB=E=>sin(E*PI),$vB=E=>sin(E*$d),$iC=2.5949095,$jC=$d/4.5,$0=()=>min(500/$gC,.05),$Y=E=>{let t=max(0,sin(E*$d)),T=$0();return T<E&&E<=2*T?t+=2*$oC((E-T)/T):2*T<E&&E<.5?t+=2:.5<=E&&E<.5+T&&(t+=2-2*$lC((E-.5)/T)),t/3},$6=E=>2*$tB(OF(E,.5))-1,$6C=E=>[(min(2*E,0)-(1-cos(E*$d)))/2,-$mC(-min(sin(E*$d),0))/2],$XB=(E=0)=>{let A=0|E;return let=fn=()=>{var E=(A=A+2654435769|0)^A>>>16,E=imul(E,569420461);return E^=E>>>15,(((E=imul(E,1935289751))^E>>15)>>>0)/4294967296*2},$AD(fn,{$WC:E=>void 0!==E?A=0|E:A,$sC:(E=1)=>$ZB(fn()*E),$fB:()=>1-2*fn(),$XC:()=>$cB(fn.$fB()),bit:()=>$ZB(fn()),bool:()=>!!$ZB(fn()),$5:E=>E.slice().sort(fn.$fB),$PC:E=>E[$z(fn()*E.length)],$qC:(E,t,T,A,s,n)=>`hwb(${$ZB(E+fn.$fB()*t)} ${$ZB(T+fn.$fB()*A)}% ${$ZB(s+fn.$fB()*n)}%)`,XY:(E,t,T=1)=>[E+fn.$fB()*T,t+fn.$fB()*T],DO:(E,t)=>{var T=A;return A=0|(E??A),t(),A=T,E??T}})},$2C=new Map,$DD=E=>($2C.has(E)||$2C.set(E,new Set),$2C.get(E)),ON=(E,t)=>$DD(E).add(t),$xC=(E,t)=>$DD(E).delete(t),$uB=(E,...t)=>$rB([...$DD(E)],E=>E(...t)),$NC=(t,T)=>{let A=(...E)=>{$xC(t,A),T(...E)};ON(t,A)};let DJ=0;const $ZC=(E=0,t=0,T=16)=>{let A=E?T/E:0;return $0C($u(E,E=>$KB(E*A+t+T)%T))},CM=$ZC(7,2,12),$8B=32/27,Q=$u(51,E=>440*2**((E-36)/12)).filter((E,t)=>CM.includes(t%12)).slice(2),$PB=(E,t=[])=>$0C([...new Set([...E,...t])]),$J=()=>{let T=Q.slice(1,14);return[[Q[0],.3,0,[0,3,8,11,14]],...$u(13,E=>{let t=rand.$PC(T);return T=T.filter(E=>E!==t),[t,.05+.15*rand(),rand.$fB(),$ZC(1+rand.$sC(),rand.$sC(15))]})]},$l=()=>[Q[15],...rand.$5(Q.slice(16))].slice(0,8),$8C=(E,t,T,A,s,n,i=6)=>{const e=E.createOscillator();var r=E.createGain(),E=E.createStereoPanner();e.frequency.setValueAtTime(A/$8B,n),$rB($ZC(i,2),(E,t)=>e.frequency.exponentialRampToValueAtTime(t%2?T*$8B:T/$8B,n+t/8)),r.gain.setValueAtTime(.1*A,n),r.gain.exponentialRampToValueAtTime(.5*A,n),r.gain.exponentialRampToValueAtTime(A,n+.325),r.gain.exponentialRampToValueAtTime(.01,n+2),E.pan.setValueAtTime(s,n),E.pan.exponentialRampToValueAtTime(-s,n+2),e.connect(r),r.connect(E),E.connect(t),e.start(n),e.stop(n+2)},$eB=(E,t,T,A,s,n,i,e)=>{var r=E.createOscillator(),R=E.createGain(),h=E.createStereoPanner(),E=E.createDynamicsCompressor(),i=$pC(i||A);r.frequency.setValueAtTime(T,n),r.frequency.exponentialRampToValueAtTime(T/1.5,n+.5),R.gain.setValueAtTime(.01,n),R.gain.exponentialRampToValueAtTime(i,n+1/32),R.gain.exponentialRampToValueAtTime(i/5,n+1/16),R.gain.linearRampToValueAtTime(0,n+.5),h.pan.setValueAtTime(e??s,n),E.threshold.setValueAtTime(-50,n),E.knee.setValueAtTime(40,n),E.ratio.setValueAtTime(12,n),E.attack.setValueAtTime(0,n),E.release.setValueAtTime(.25,n),r.connect(R),R.connect(h),h.connect(E),E.connect(t),r.start(n),r.stop(n+.51)},$r=(E,t,T,A=0,s)=>{var n=.04+.03*rand(),i=1/8+rand()/16,e=E.createOscillator(),r=E.createGain(),E=E.createStereoPanner();e.type="triangle",e.frequency.setValueAtTime(T,s),r.gain.setValueAtTime(n,s),r.gain.exponentialRampToValueAtTime(n/2,s+1/32),r.gain.linearRampToValueAtTime(0,s+i),E.pan.setValueAtTime(A,s),e.connect(r),r.connect(E),E.connect(t),e.start(s),e.stop(s+i)},$2B=()=>{const n=new AudioContext,i=n.createAnalyser(),E=(i.connect(n.destination),i.fftSize=256,i.frequencyBinCount),t=new Uint8Array(E);let T=-$pC(D/4e3,10)%1,e=T,A=[0],r=[],s=[],R=null,h=null;var I=(E=$J(),t=$l())=>{R=E,h=t};return setInterval(()=>{n.currentTime+.25<e||e<0||(R&&(r=R,R=null),h&&(s=h,h=null),$8C(n,i,(s[7-(beat+measure%8)%8]||2*Q[rand.$sC(6)])/2,.2,.5*rand.$fB(),e,$KB(e-T)%3+4),$rB(A,E=>{const[t,T,A,s]=r[E];$rB(s,E=>$eB(n,i,t,$pC(T),A,.25*E+e))}),e+=4)},100),ON("$r",(E=0)=>{$r(n,i,(s[beat]||Q[15])/2,"number"==typeof E?E:0,n.currentTime)}),ON("$eB",()=>{var[,E,t,,]=r[0];$eB(n,i,Q[14],E,t,n.currentTime)}),ON("$8C",()=>$8C(n,i,2*(s[7-(beat+measure%8)%8]||Q[0]),.3,.5*rand.$fB(),n.currentTime,6)),ON("pause",()=>{"running"===n.state&&$m?n.suspend():"suspended"!==n.state||$m||n.resume()}),I(),{$LB:I,n:e,get track(){return r},get voices(){return A},get melody(){return s},get $lB(){return i.getByteFrequencyData(t),Array.from(t).slice(0,E/2)},$YC:(E=[],t)=>{A=$PB([0,...E]),s=t||s}}},$OC=($t=({$aB:E=min(1920,window.innerWidth),$h:t=min(1080,window.innerHeight),os:A=!1}={})=>{let s=A?null:document.createElement("canvas"),n=(s&&(s.width=E,s.height=t),A?new OffscreenCanvas(E,t):s.transferControlToOffscreen()),e=n.getContext("2d");n.width=E,n.height=t;const r={get W1(){return n.width},get W2(){return n.width/2},get W3(){return n.width/3},get H1(){return n.height},H2:n.height/2,get H3(){return n.height/3},get R3(){return min(r.H3,r.W3)},get Rm(){return min(r.H1,r.W1)},get RM(){return max(r.H1,r.W1)},$fC:n,$TC:s,ctx:e,$s:(E,t)=>{var T;A||(T=document.createElement("canvas"),s.replaceWith(T),(s=T).width=E,T.height=t,n=s.transferControlToOffscreen(),e=n.getContext("2d"),$AD(r,{$fC:n,ctx:e,$TC:s})),n.width=E,n.height=t,r.H2=n.height/2},DO:E=>(e.save(),E(r),e.restore(),r),E:()=>(e.clearRect(0,0,r.W1,r.H1),r),center:()=>(r.T(r.W2,r.H2),r),FX:(E="none")=>(e.filter=E,r),T:(E,t)=>(e.translate(E,t),r),R:E=>(e.rotate(E),r),RR:(...E)=>(e.roundRect(...E),r),M:(...E)=>(e.moveTo(...E),r),L:(...E)=>(e.lineTo(...E),r),A:(E=0,t=0,T=1,A=0,s=$VB[1],n=!1)=>(e.arc(E,t,T,A,s,n),r),B:(...E)=>(e.bezierCurveTo(...E),r),P:E=>(e.beginPath(),E?.match(/[MLABCTREOSFW](?:\s*-?\d+(?:\.\d+)?|\s*#[a-f0-9]{3,8}|\s*hwb\([^)]+?\))*/g).forEach(E=>{var[E,...t]=E.includes("(")?[E[0],E.slice(1).trim()]:E.split(" ");r[E](...$vC(t,E=>"#"===E[0]||E.includes("(")?E:parseFloat(E,10)))}),r),C:()=>(e.closePath(),r),O:E=>(e.globalAlpha=E,r),S:(E=1,t=1)=>(e.scale(E,t),r),GS:(T,A)=>$rB(A,(E,t)=>T.addColorStop(t/A.length,E)),GL:(E,t,T,A,s)=>{E=e.createLinearGradient(E,t,T,A);return r.GS(E,s),E},GR:(E,t,T,A,s,n,i)=>{E=e.createRadialGradient(E,t,T,A,s,n);return r.GS(E,i),E},F:E=>(e.fillStyle=E,e.fill(),r),FP:(E,t)=>(e.fillStyle=E,e.fill(t),r),W:(E,t)=>(e.strokeStyle=E,e.lineWidth=t,e.stroke(),r),WP:(E,t,T)=>(e.strokeStyle=E,e.lineWidth=t,e.stroke(T),r),$rC:(...E)=>(e.drawImage(...E),r)};return r.E(),r.$pB=(E,t)=>E.$pB(r,t),r},()=>{const i=new Path2D;return i.M=(...E)=>(i.moveTo(...E),i),i.L=(...E)=>(i.lineTo(...E),i),i.A=(E=0,t=0,T=1,A=0,s=$VB[1],n=!1)=>(i.arc(E,t,T,A,s,n),i),i.AT=(...E)=>(i.arcTo(...E),i),i.B=(...E)=>(i.bezierCurveTo(...E),i),i.Q=(...E)=>(i.quadraticBezierCurveTo(...E),i),i.C=()=>(i.closePath(),i),i}),$5C=(E,t)=>$t({$aB:E,$h:t||E,os:!0}),$ED=(t=32,E="#840")=>{const T=$5C(3*t),A=t/4,s=1.4*t;return T.DO(()=>{T.E().center().P().A(0,0,t).C().F(E).P().M(-s,-A).L(s,-A).M(-s,A).L(s,A).M(-A,-s).L(-A,s).M(A,-s).L(A,s).W(E,3)}),{R:1.5*t,D:3*t,get $rC(){return T.$fC},$pB(E){E.$rC(T.$fC,0,0,2*t,2*t)}}},$GC=(Array.$S=()=>[],(a,d,m={},p="$nC")=>{const dd=window[p].$S?.()??[],o=dd.length,dv=$vC(d,([,E])=>"function"==typeof E?E.toString().replace(/^\(\) ?=> ?/,""):JSON.stringify(E)).join(","),e=`window.${a}=class ${a} extends ${p}{`+`static $S=()=>[...${p}.$S(),${dv}];`+`constructor(...x){super(...(x.length ? x : ${a}.$S()))}`+"*[Symbol.iterator]() {for(let i = 0,l=this.length;i<l;i++){yield this[i]}}"+$vC(d,([E],t)=>`  get ${E}(){return this[${t+o}]} set ${E}(x){return this[${t+o}]=x}`).join("")+$vC(Object.values(m),E=>E.toString()).join("")+"};";return eval(e)}),$BC=($GC("$nC",[["x",0],["y",0],["z",0],["$bC",0],["$dB",[]],["$WC",null],["$aB",0],["$h",0]],{$iB(){return new this.constructor(...this)},$JC(E){return[this.x,this.y,this.z]=$JC(this,E),this},$CD(E){return[this.x,this.y]=$CD(this,E),this},$oB(E){return new $nC(...$oB(this,E))},$zC(){return $vC([this.x,this.y,this.z],$ZB)},$MC(E=1){return[this.x,this.y]=$MC([this.x,this.y],E),this},$0B(E=1){return this.$MC(this.$tC()*E),this},$tC(){return $tC([this.x,this.y])},$RC(E){var[t,T,A]=this.$F();return E.S(A,A),E.T(t,T),this},$F(){var[E,t,T]=this.$oB($c),A=t<0?4/-t*5:0;return[E*=4,t=4*T*A,A]},$4(E=1){var[t,T,A]=this.$F(),s=(t*=A*$BD,T*=A*$BD,1===this.$aB?1:2),n=E?-$BD*s*A:0;return new $nC(t+TV.W2,T+TV.H2+n,s*A*(E?$BD:1))},$M(){var[E,t,T]=this.$4();return $OC().A(E,t,abs(T)).C()},$y(){},$7B(){},$pB(){},$eC(){},$V(){}},"Array"),$GC("$3C",[["$FD",0],["$2",{}],["$w",null],["$5B",null],["$1C",null],["$y",null]],{},"Array"),{w:0,a:0,s:0,d:0}),$1B=($GC("$9C",[["shell",null],["$4B",0],["$SB",0],["$N",1],["$E",1],["$X",()=>new $nC],["$NB",()=>new $nC],["$9",()=>new $nC(1,1,0)],["$Z",[]],["w",0],["a",0],["s",0],["d",0],["$K",2],["$O",[]],["$B",0],["$HB",[]],["$W",0],["$Q",[0,0,0]]],{$e(){return this.$4B?abs(this.$4B):0},$7(){var E=this.$SB%1;return E*=this.$X.$tC?.()||IN(E,1/32,31/32)?1:0,(this.$N<0?1-E:E)%1},$GB(){return this.$7()?OF(this.$7()%.5,.5)%1:1-bar%.5*2%1},$y(E){E=min(1,E/1e3);let{w:t,a:T,s:A,d:s}=this;var n=$ZB(this.x)+128,i=$ZB(this.y)+128,e=this.$Z.filter(E=>E.$FD<=$FD),e=(e.length?($rB(e,E=>{var t,T,A;E.$5B=E.$5B||E.$FD,E.$w?$tC(this,E.$w)>1/16?(E.$FD=$FD,[T,A]=(t=$MC($oB(E.$w,this),1)).map(abs),$AD(E.$2,t[0]<0?{a:T,d:0}:{a:0,d:T},t[1]<0?{w:A,s:0}:{w:0,s:A})):(E.$1C=E.$FD,E.$2={w:0,a:0,s:0,d:0}):(E.$FD=-1,E.$1C=$FD),$AD(this,E.$2)}),e.length&&({w:t,a:T,s:A,d:s}=this),this.$Z=this.$Z.filter(E=>!E.$1C||E.$1C>$FD||E.$FD>$FD)):$AD(this,{w:0,a:0,s:0,d:0}),this.$NB=new $nC(s-T,A-t,0),this.$N=$XC(this.$NB.x||this.$N),this.$E=$XC(this.$NB.y||this.$E),new $nC(...this.$NB)),r=new $nC(...this.$X),R=this.$GB();if(0===e.$tC()&&IN(r.$tC(),1/16,R)&&e.$JC(new $nC(...this.$9).$MC((1-R)/2)),e.$MC(4*E),this.$NB.$tC()){const A=.75+OF(e.$iB().$MC(2).$JC(r.$iB().$MC(1)).$tC(),3)/4;r.$0B(A)}r.$JC(e),r.$MC(min(r.$tC(),this.$K));var h,e=(this.$X=r).$tC(),I=new $nC(...r);I.$MC(I.$tC()*E);const O=$JC(this,I);this.$dB.length&&!this.$dB.find(E=>$tC($oB(E,O))<E.$q)&&I.$0B(-.5);let S=$ZB(this.x+I.x)+128,a=$ZB(this.y+I.y)+128;if(n===S&&i===a||((h=world.$xB[a][S])&&h!==this&&(I.$0B(-.1),S=$ZB(this.x+I.x)+128,a=$ZB(this.y+I.y)+128),world.$xB[i][n]=null,world.$xB[a][S]=this),this.$JC(I),this.$SB+=I.$tC(),this.$4B=e*this.$N,this.$9=e?r.$iB().$MC(1):this.$9,this.$NB.$tC()<.25&&r.$tC()&&r.$0B(this.$GB()<1/8?0:$yC(1-2*E,1)),0===r.$tC()&&this.$7()&&R&&(r.$0B(0),this.$SB=$ZB(2*this.$SB)/2),this===$o){const A=$KB(this.$SB/.25);A>this.$W&&$uB("$r",this.$9.x/-2),this.$W=A}}},"$nC"),({$nB:A=512,$HB:s=[]}={})=>{const n=$5C(A),i=A/2,e=A/12,T={R:i,$nB:A,$HB:s,$pB:(E=n,t)=>(E.DO(()=>{let T=5.6*e;t?E.$rC(n.$fC,0,0,64,64):(E===n&&E.E().center(),E.P().A(0,0,i).C().F(E.GR(0,2*e,4*e,0,0,A,["#242","#262"])),n.P().A(0,0,T),$u(28,E=>{var[E,t]=$CD([1,0],$VB[28]*(E-.5)-$VB[4]);n.M(E*T,t*T).L(E*i,t*i)}),n.W(n.GR(0,2*e,3*e,0,0,A,["#3536","#4846"]),2),$u(13,E=>{let t=0,T=(E-11)*e*2.25;var A;E<10&&(A=$VB[10]*(E+2.5),[t,T]=$CD([4.5*e,0],A)),n.P().A(t,T,e).C().F("rgba(127,127,127,0.25)"),s[E]&&n.P().A(t,T,e).C().F("#aa9")}))}),T),$aC(E){return s[world.$HB.indexOf(E)]=1,T.$pB(),T},get $rC(){return n.$fC}};return T.$pB(),T}),$H=new Map,$JB=($GC("$n",[["$yB",null],["$FB",()=>`hwb(${$ZB(30+10*rand.$fB()-2)} ${$ZB(0+10*rand())}% ${$ZB(47+10*rand())}%)`],["$v",()=>`hwb(${$ZB(30+2*rand.$fB()-2)} 0% ${$ZB(67+4*rand())}%)`],["$YB",0],["$TB",[]],["$9B",[]]],{$OC(E,t,T,A,s){var n,i,e,r,R,h,[E,t,T,A,s]=[$pC(E,4),$pC(t,64),T,A,$pC(s[0],4)],A=[E,t,T,A,s].join();return $H.has(A)||(n=$vB(t)/8,i=E?E/8:$vB(t)/16,e=$IB(t)/8,abs(E/16),[t,r]=[E?$6C(t):[0,0],E?$6C(1-t):[0,0]],[[t,r],[R,h]]=[t,r],s=sqrt(abs(s)/(abs(E)||1)),$H.set(A,$OC().A(0+i*s,e-3,1,$d[4],$d).M(0+i*s,e-2).L(2+R/3,n*T-1.5).L(1+t/16,n*T-1).L(1+t*s,r).L(0,e-1).L(-1-R*s,h).L(R/16-1,-1-n*T).L(-2-t/3,-1.5-n*T).C())),$H.get(A)},$pB(i,e){const r=bar%.5*2;i.DO(()=>{e?i.T(32,64).S(16,16):this.$RC(i);var E=this.$7()%.5,E=E?OF(E%.5,.5):1-r,t=this["$4B"];let T=t?t/8:$vB(E)/16,A=$IB(E)/8,s=abs(t/16);const n=sqrt(abs(this.$X[0])/(abs(t)||1));this.shell&&0<this.$E&&i.P().A(0-T*n/2,-1.75-A/2+s,7/8).C().W("#242",1/16).F("#131");t=this.$OC(this.$4B,E,this.$N,this.$E,this.$X);i.WP(this.$v,1/8,t).FP(this.$FB,t),this.shell&&(this.$E<0||$m)&&i.DO(()=>{i.P().A(0-T*n/2,-1.75-A/2+s,7/8).C(),i.W("#242",1/16),i.T(0-T*n/2,-1.75-A/2+s),i.R(this.$X[0]/16),i.$rC(shell.$rC,-1,-1,2,2)}),$RB.$w})},$7B(){var E,t,T;this.$yB||(this.$yB=this.$zC()),this.$YB&&!this.$Z?.length&&(E=$FD%576,E=$FD-E,t=this.$dB[0],t=$oB(t,this),T=$tC(t),this.$Z=[$AD(new $3C,{$FD:288+E+rand.$sC(16),$w:$JC($0B(t,(T-2)/T),this)}),$AD(new $3C,{$FD:528+E+rand.$sC(16),$w:this.$yB}),$AD(new $3C,{$FD:575+E})].filter(E=>E.$FD>=$FD))},$eC(E){return this!==E&&this.$oB(E).$tC()<=4&&(!this.$YB&&!this.$TB.length||this.$TB.find(t=>$o.$O.find(E=>IS(E,t)))||this.$YB&&this.$9B.find(t=>$o.$O.find(E=>IS(E,t))))},$V(E){var t,T;this.$YB||this.$TB.length||($uB("$8C"),this.$YB=1,t=this.$dB[0],t=$oB(t,this),T=$tC(t),this.$Z.push($AD(new $3C,{$FD:$FD+1+rand.$sC(8),$w:$JC($0B(t,(T-2)/T),this)})));const A=$vC(this.$TB,t=>E.$O.find(E=>IS(E,t))).filter(E=>E);if(A.$i){const s=this.$TB.filter(t=>A.find(E=>IS(E,t)));E.$O=E.$O.filter(E=>!A.includes(E)),this.$TB=this.$TB.filter(E=>!s.includes(E))}}},"$9C"),$GC("$a",[["$yB",null],["$BB",1]],{$7B(){if(this.$yB||(this.$yB=this.$zC()),this.$BB){if(!this.$Z?.length){var E=$FD%576;const t=$FD-E,T=this.$dB[0],A=this.$oB(T);$tC(A);const s=$VB[14];this.$Z=$u(14,E=>$AD(new $3C,{$FD:t+42*E+rand.$sC(4),$1C:t+42*E+42-1,$w:A.$iB().$CD(s*(E+rand()/8)).$JC(T)})).filter(E=>E.$FD>=$FD)}return this}}},"$9C"),$GC("$WB",[["TV",null],["$LC",0]],{$pB(E,t){if(this.TV)return t?E.$rC(this.TV.$fC,0,0,64,64):E.DO(()=>{this.$RC(E),E.$rC(this.TV.$fC,-this.$aB/2,-this.$h,4*this.$aB,4*this.$h)}),this},$eC(E){return 2<this.$bC&&this.$oB(E).$tC()<=4&&E.$O.length<E.$B},$y(E){this.$LC=this.$LC||4+rand.$sC(284),$FD>=this.$LC&&this.$bC<this.$wC&&(this.$U(this.$bC+(rand()+1)/8),this.$LC=$FD+576)}},"$nC"),$GC("$mB",[],{$pB(n,i){n.DO(()=>{i?n.T(32,64).S(16,16):this.$RC(n),n.S(this.$N,1);var E=this.$4B,[t,T]=E?$6C(this.$GB()):[0,0],[A,s]=E?$6C(1-this.$GB()):[0,0],[[A,s],[t,T]]=0<this.$N?[[t,T],[A,s]]:[[A,s],[t,T]],E=sqrt(abs(this.$X[0])/(abs(E)||1));n.P().M(1,s/4-2).L(0-t*E,0+T).L(0,s/4-1).C().M(-1,T/4-1).L(A*E-1,0+s).L(-2,T/4-1.5).C().F("#520"),n.P().M(1,s/4-3).L(2,s/4-2).L(1,s/4-2).L(1+A*E,0+s).L(0,s/4-1).L(-1,T/4-1).L(-2-t*E,0+T).L(-2,T/4-1.5).L(-1.75,T/4-1.75).L(-2,T/4-2).L(0,s/4-2).L(.5,s/4-2.5).L(0,s/4-3).C().W("#620",1/8).F("#840"),n.P().A(1,s/4-4,1,$VB[2],1,!0).W("#620",.125)})}},"$a"),$GC("$DB",[],{$pB(n,i){n.DO(()=>{i?n.T(32,64).S(16,16):this.$RC(n),n.S(this.$N,1);var E=this.$4B,[t,T]=E?$6C(this.$GB()):[0,0],[A,s]=E?$6C(1-this.$GB()):[0,0],[[A,s],[t,T]]=0<this.$N?[[t,T],[A,s]]:[[A,s],[t,T]],E=sqrt(abs(this.$X[0])/(abs(E)||1));n.P().M(1,s/4-2).L(0-t*E,0+T).L(0,s/4-1).C().M(-1,T/4-1).L(A*E-1,0+s).L(-2,T/4-1.5).C().F("#520"),n.P().M(2,s/4-2).L(2,s/4-1).L(1.5,s/4-.5).L(1,s/4-1).L(1+A*E,0+s).L(0,s/4-1).L(-1,T/4-1).L(-2-t*E,0+T).L(-2,T/4-1.5).L(-1.75,T/4-1.75).L(-2,T/4-2).L(0,s/4-3).L(1,s/4-2.25).L(1.5,s/4-2.5).C().W("#620",1/8).F("#840"),n.P().A(2,s/4-2.25,.75,$VB[2],$VB[2]+$VB[7]).W("#620",.125)})}},"$a"),$GC("$IC",[["$UB",0],["$q",32],["$FB","#ccf"],["$v","#ccf4"]],{$pB(i,e){i.DO(()=>{var E,t,{$UB:T,$q:A}=this,s=(e&&i.T(A,A),A-1),n=1.3*A;T&&(E=$z(cos($VB[28]*T)*n),t=T<14?E:-n,T=14<T?-E:n,i.P().M(0,s).B(T,A,T,-A,0,-s).B(t,-A,t,A,0,s).C().F(this.$FB)),i.P().A(0,0,s).C().W(this.$v,A/16)})},$OB(){return abs(sin($VB[2]*this.$UB/28))}},"$nC"),$GC("$dB",[["$FB",()=>`hwb(${120+rand.$sC(25)} ${10+rand.$sC(5)}% ${$ZB(65+rand.$sC(5))}%)`],["$q",16],["$p",[]],["$T",[]],["$P",[]],["$J",null],["$l",null]],{$U(t=16){this.$q=t;rand();return this.$p=$u(16,E=>new $nC(0,-t,0).$CD($VB[16]*(E+rand()/4))),this},$y(t){$rB(this.$P,E=>E.$y(t))}},"$nC"),$GC("$7C",[["TV",null]],{$pB(E){return this.TV||(this.TV=$t({$aB:64,$h:64}).P().M(...rand.XY(1,28)).L(...rand.XY(24,24)).L(...rand.XY(21,12)).L(...rand.XY(31,11)).L(...rand.XY(33,23)).L(...rand.XY(47,14)).L(...rand.XY(53,21)).L(...rand.XY(61,31)).L(...rand.XY(52,44)).L(...rand.XY(42,47)).L(...rand.XY(43,43)).L(...rand.XY(39,48)).L(...rand.XY(16,57)).L(...rand.XY(9,54)).L(...rand.XY(3,42)).C().F(rand.$qC(15,2,17,2,68,4))),E.$rC(this.TV.$fC,0,0,64,64),E}},"$nC"),$GC("$QC",[["$FB",()=>rand.$qC(150,2,10,6,80,4)],["$wC",8]],{$U(E){return this.$WC=rand.DO(this.$WC,()=>{const n=min(this.$wC,this.$bC=E||this.$bC||4*rand()+3),i=ceil(n);let e=0,r=0,R=0;const t=$u(i,E=>{var t=(n-E)/(n-E+3),T=e-t/.125,A=t*(i-E),s=e+t+.5,E=OF(n-E,i),t=$pC(rand.$fB()*E*t/2),A=(r=max(A,r),`M ${t} ${$pC(T)} L ${$pC(-A)} ${$pC(s)-rand()*E} L ${$pC(R)} ${$pC(e+.25)} L ${$pC(A)} ${$pC(s)-rand()*E} L ${t} `+$pC(T));return R=t,e=T,A}).join(" ")+(" F "+this.$FB);this.$aB=ceil(2*r),this.$h=ceil(abs(e)),this.TV=$5C(this.$aB*$BD*4,this.$h*$BD*4).DO(E=>E.S($BD,$BD).T(this.$aB/2,this.$h).P(t))}),this},$eC(E){return 2<this.$bC&&this.$oB(E).$tC()<=4&&E.$HB?.find(E=>IS(E.$AC,$3))&&E.$O.length<E.$B},$V(E){E.$O.push(new $7C),this.$U(--this.$bC),$uB("beat")}},"$WB"),$GC("$g",[["TV",null],["$UB",0],["$FB",()=>rand.$qC(180,4,33,3,55,4)],["$DC",-1],["$EB",0]],{$U(){const T=this.$EB,A=(this.$aB=4,this.$h=4,this.TV=this.TV??$5C(this.$aB*$BD*4,this.$h*$BD*4),rand.$fB()/4);var E=T?-2:-1.5;const s=rand()/8,n=E+s;return this.TV.DO(E=>{var t;E.E().S($BD,$BD).T(this.$aB/2,this.$h).P().M(-1.5-A,0).B(-2.5,-3,-1,-3,A,s-2).B(1,-3,2.5,-3,1.5+A,0).C().F(this.$FB).P().M(0,0).B(2*-A,-s,4*A,n,A,n).W("#0002",1/8),E.P().A(A,n,T?.75:1/8).F(`hwb(${$ZB((180/28*this.$UB+240+rand.$fB()/4)%360)} ${$ZB(10+25*rand())}% 5%)`),this.$EB&&(t=$AD(new $IC,{$q:10,$UB:this.$UB,$FB:"#ccf",$v:"#000a"}),E.O(.5).T(1.25*A,n).S(1/16,1/16),t.$pB(E))}),this},$pB(E,t){if(this.TV)return t?E.$rC(this.TV.$fC,0,0,256,256):E.DO(()=>{this.$RC(E),E.$rC(this.TV.$fC,-this.$aB/2,-this.$h,4*this.$aB,4*this.$h)}),E},$y(E,t,T){t=t??moon?.$UB,T=T??$zB;return t!==this.$DC&&.5<=T&&!this.$EB&&(this.$DC=t,this.$EB=+((moon?.$UB??-1)===this.$UB),this.$U()),this},$eC(E){return this.$EB&&this.$oB(E).$tC()<=2&&E.$O.length<E.$B},$V(E){var t=$AD(this.$iB(),{TV:null});E.$O.push(t.$U()),this.$EB=0,this.$U(),$uB("$8C")}},"$nC"),$GC("$MB",[["$FB",()=>rand.$qC(120,2,20,2,67,2)],["$wC",4]],{$U(s){return this.$WC=rand.DO(this.$WC,()=>{const T=min(this.$wC,this.$bC=s||this.$bC||3*rand()+1);var E=ceil(T);const A=6*E+1,t="M 2 0 "+$u(A,E=>{var t=(E+.5)/A*PI,E=E%2;return`L ${$pC(2*cos(t)+(E?rand.$fB()/8:0))} `+(E?$pC(sin(t)*-T*2+rand.$fB()/2):-.5)}).join(" ")+" L -2 0 C F "+this.$FB;this.$aB=4,this.$h=2*E,this.TV=$t({$aB:this.$aB*$BD*4,$h:this.$h*$BD*4,os:!0}),this.TV.DO(E=>E.S($BD,$BD).T(this.$aB/2,this.$h).P(t))}),this},$V(E){E.$O.push($AD((new $MB).$U(1),{$bC:1})),this.$U(--this.$bC),$uB("$eB")}},"$WB"),$GC("$b",[["TV",null]],{$pB(E){return this.TV||(this.TV=$t({$aB:64,$h:64}).P().M(...rand.XY(2,32)).B(0,64,0,64,...rand.XY(16,62)).L(...rand.XY(48,62)).B(64,64,64,64,...rand.XY(62,32)).L(...rand.XY(48,32)).L(...rand.XY(48,12)).L(32,12).L(32,16).L(...rand.XY(44,16)).L(...rand.XY(44,32)).L(...rand.XY(20,32)).L(...rand.XY(20,16)).L(32,16).L(32,12).L(...rand.XY(16,12)).L(...rand.XY(16,32)).C().F(rand.$qC(42,2,16,2,53,4)).P().M(...rand.XY(14,38)).L(...rand.XY(28,58)).M(...rand.XY(36,38)).L(...rand.XY(50,58)).M(...rand.XY(52,38)).L(...rand.XY(38,58)).M(...rand.XY(30,38)).L(...rand.XY(16,58)).W("#4404",2)),E.$rC(this.TV.$fC,0,0,64,64),E}},"$nC"),$GC("$hC",[["TV",null]],{$pB(E){return this.TV||(this.TV=$t({$aB:64,$h:64}).DO(E=>{var t=rand.XY(32,2,2),T=rand.$qC(105,2,12,2,65,2);E.P().M(...t).B(60,4,64,60,...rand.XY(32,60,2)).B(0,60,4,4,...t).F(rand.$qC(70,2,25,2,15,2)).P().M(...rand.XY(32,6,2)).L(...rand.XY(32,50,2)).M(...rand.XY(16,16,2)).L(...rand.XY(48,16,2)).M(...rand.XY(16,32,2)).L(...rand.XY(48,32,2)).M(...rand.XY(16,48,2)).L(...rand.XY(48,48,2)).W("#641",1).P().M(32,64).B(...rand.XY(26,24),...rand.XY(16,24),...rand.XY(2,14)).B(...rand.XY(8,64),...rand.XY(4,54),32,64).B(...rand.XY(38,24),...rand.XY(48,24),...rand.XY(62,14)).B(...rand.XY(56,64),...rand.XY(56,54),32,64).F(T)})),E.$rC(this.TV.$fC,0,0,64,64),E}},"$nC"),$GC("$jB",[["$FB",()=>rand.$qC(105,2,12,2,65,2)],["$wC",4],["$sB",[]]],{$U(t){return this.$WC=rand.DO(this.$WC,()=>{const s=rand.$XC();var E=min(this.$wC,this.$bC=t||this.$bC||3*rand()+1);this.$sB.length=0,this.$sB.push(...$u(max(0,$KB(E-1)),E=>new $hC));const n=2*min(E,3);this.$aB=4,this.$h=$ZB(2+n),this.TV=$5C(this.$aB*$BD*4,this.$h*$BD*4).DO(A=>{A.S($BD,$BD).T(2,this.$h).P().M(0,-n).L(0,-1/8).W(this.$FB,.25),$u(3,T=>A.DO(E=>{0===T?A.T(0,-n).R(rand.$fB()/8):A.T(0,-n/2+rand.$fB()/2).R(s*$XC(1.5-T)*$VB[7]);var t=this.$sB[T];t?(0===T?A.T(-1,-1):A.T(-1,-2),A.S(1/$BD,1/$BD).$pB(t,!0)):A.P().M(0,0).B(-.5,-.5,-.5,-.5,0,-1).B(.5,-.5,.5,-.5,0,0).C().F(this.$FB)}))})}),this},$V(E){E.$O.push(this.$sB.pop()),this.$U(--this.$bC),$uB("$eB")}},"$WB"),$GC("$6B",[["TV",null]],{$pB(E){return this.TV||(this.TV=$t({$aB:64,$h:64}).P().M(...rand.XY(2,58)).L(...rand.XY(4,61)).L(...rand.XY(61,9)).L(...rand.XY(58,6)).C().F(rand.$qC(15,2,17,2,68,4)).P().M(...rand.XY(7,4)).L(...rand.XY(7,8)).L(...rand.XY(58,61)).L(...rand.XY(61,58)).L(...rand.XY(18,18)).L(...rand.XY(20,12)).L(...rand.XY(18,10)).L(...rand.XY(16,16)).C().F(rand.$qC(15,2,17,2,68,4))),E.$rC(this.TV.$fC,0,0,64,64),E}},"$nC"),$GC("$hB",[["$FB",()=>rand.$qC(105,2,12,2,65,2)],["$wC",4]],{$U(s){return this.$WC=rand.DO(this.$WC,()=>{const t=min(this.$wC,this.$bC=s||this.$bC||3*rand()+1);var E=ceil(t);const T=2*E+1,A="M 2 0 "+$u(T,E=>{E=(E+.5)/T*PI;return`L ${$pC(2.75*cos(E)+rand.$fB()/2)} `+$pC(sin(E)*-t+rand.$fB()/4)}).join(" ")+` L -2 0 C F ${this.$FB} W #1324 0.125`;this.$aB=6,this.$h=2*E,this.TV=$t({$aB:this.$aB*$BD*4,$h:this.$h*$BD*4,os:!0}),this.TV.DO(E=>E.S($BD,$BD).T(this.$aB/2,this.$h).P(A))}),this},$V(E){E.$O.push(new $6B),this.$U(--this.$bC),$uB("$eB")}},"$WB"),$GC("$UC",[["TV",null],["$FB",()=>rand.$qC(32,3,37,4,55,4)]],{$U(){return this.$WC=rand.DO(this.$WC,()=>{this.TV=$5C(64).P().M(...rand.XY(4,60,3)).L(...rand.XY(9,32,4)).L(...rand.XY(16,16,7)).L(...rand.XY(32,20,8)).L(...rand.XY(48,16,6)).L(...rand.XY(53,32,4)).L(...rand.XY(60,60,3)).L(57,64).L(7,64).C().F(this.$FB).W("#332",1),this.$aB=1,this.$h=1}),this},$pB(E,t){return this.TV||this.$U(),t?E.$rC(this.TV.$fC,0,0,64,64):E.DO(()=>{this.$RC(E),E.$rC(this.TV.$fC,-this.$aB/2,-this.$h,this.$aB,this.$h)}),this},$eC(E){return this.$oB(E).$tC()<=4},$V(E){E.$O.push(this);var[E,t]=this.$zC(),t=(world.$xB[t+128][E+128]=null,this.$dB[0].$T),E=world.$T;t.splice(t.indexOf(this),1),E.splice(E.indexOf(this),1),$uB("$eB")}},"$nC"),$GC("$3",[["TV",null]],{$pB(E){return this.TV||(this.TV=$5C(64).P().A(24,24,20,PI/2,PI).L(...rand.XY(48,8)).C().F(rand.$qC(32,3,37,4,55,4)).P().M(...rand.XY(24,8)).L(...rand.XY(20,12)).L(...rand.XY(59,61)).L(...rand.XY(61,59)).C().F(rand.$qC(15,2,17,2,68,4))),E.$rC(this.TV.$fC,0,0,64,64),E}},"$nC"),$GC("$cC",[["TV",null]],{$pB(E){return this.TV||(this.TV=$5C(64).P().M(64,32).L(...rand.XY(52,25)).L(54,32).L(...rand.XY(52,39)).C().F(rand.$qC(32,3,37,4,55,4)).P().M(20,32).L(...rand.XY(17,28)).L(0,28).L(4,32).L(0,36).L(...rand.XY(17,36)).C().F("#fffc").P().M(3,32).L(59,32).M(...rand.XY(20,4)).L(...rand.XY(20,60)).W(rand.$qC(15,2,17,2,68,4),2).P().A(20,32,29,-PI/2-1/8,PI/2+1/8).W(rand.$qC(15,2,17,2,68,4),4)),E.$rC(this.TV.$fC,0,0,64,64),E}},"$nC"),$GC("$x",[["TV",null],["$FB",()=>rand.$qC(46,3,30,5,40,4)]],{$U(){return this.$WC=rand.DO(this.$WC,()=>{const t=rand.XY(32,16,5),T=rand.XY(32,38,3),A=3*rand.$fB(),s=rand.$qC(10,3,11,3,50,4),n=this.$FB,i=rand.$qC(46,3,5,2,75,4);this.TV=$5C(512).S(8,8).DO(E=>E.P().M(3+A,64).L(...t).L(61+A,64).C().F(E.GR(32,0,16,32,-32,112,[s,n,n,n,s])).W(s,.5).P().M(21+A,64).L(...T).L(43+A,64).C().F(i).P().M(t[0]-4,t[1]-7).L(...t).L(t[0]+5,t[1]-8).W(i,1)),this.$aB=8,this.$h=8}),this},$pB(E,t){return this.TV||this.$U(),t?E.$rC(this.TV.$fC,0,0,64,64):E.DO(()=>{this.$RC(E),E.$rC(this.TV.$fC,-this.$aB/2,-this.$h,this.$aB,this.$h)}),this}},"$nC"),$GC("$3B",[["TV",null]],{$pB(E){return this.TV||(this.TV=$5C(64).P().M(...rand.XY(3,8)).L(...rand.XY(6,3)).L(...rand.XY(48,45)).L(...rand.XY(45,48)).C().F(rand.$qC(15,2,17,2,68,4)).P().M(...rand.XY(63,63)).L(...rand.XY(59,47)).L(...rand.XY(42,42)).L(...rand.XY(47,59)).C().F(rand.$qC(32,3,37,4,55,4))),E.$rC(this.TV.$fC,0,0,64,64),E}},"$nC"),$GC("$A",[["TV",null]],{$pB(E){return this.TV||(this.TV=$5C(64).P(),this.TV.DO(t=>{$u(4,E=>{t.M(...$JC([32,28],$CD([0,26],$VB[12]*E))).L(...$JC([32,28],$CD([0,26],$VB[12]*(E+4)))).L(...$JC([32,28],$CD([0,26],$VB[12]*(E+8)))).L(...$JC([32,28],$CD([0,26],$VB[12]*E)))}),t.W("#ffcc",1).P().M(6,28).L(2,47).L(6,63).L(10,50).L(6,28).M(58,28).L(54,52).L(58,63).L(62,53).L(58,28).F("#fffc").P().A(32,28,26).W(rand.$qC(15,2,17,2,68,4),4)})),E.$rC(this.TV.$fC,0,0,64,64),E}},"$nC"),$GC("$gB",[["TV",null]],{$pB(E){}},"$nC"),$GC("$qB",[["TV",null],["$AC",null],["$TB",[]],["$FB",()=>rand.$qC(46,3,30,5,40,4)]],{$U(t){try{this.$AC=new t}catch(E){this.$AC=t()}return this.TV=$5C(256).DO(E=>{E.P().A(128,128,128).F(E.GR(128,112,112,128,128,128,[this.$FB,rand.$qC(46,3,20,5,50,4)]));try{E.T(64,48).S(2,2).$pB(this.$AC,!0)}catch(E){console.error("Error drawing drum",t,this.$AC)}}),this},$pB(E,t){return t?E.$rC(this.TV.$fC,0,0,64,64):E.$rC(this.TV.$fC,-1,-3,2,2),E}},"$nC"),new Map),ww=($GC("$wB",[["$uC",()=>new $7C],["O",()=>rand()],["$qB",null]],{$pB(n,E){n.DO(()=>{var E,t,T,A=!this.$eC($o),s=(this.$RC(n),$pC((this.O+bar%.5*2)%1,64));n.DO(()=>n.T(-1.5,-2).S(1/32,1/32).$pB(this.$uC)),n.DO(()=>n.T(1.5,-1.75).S(-1/32,1/32).$pB(this.$uC)),$JB.has(s)||(E=$5C(128,256),t=$vB(s),T=$vB((s+.25)%1),E.S(64,64).T(1,4).P().M(1,-1.5).A(0,-1.5,1,0,$VB[2]).B(-1,-2.5-T/2,0+t,-2.5-T,0-t/2,-3.5).B(0-t,-2.5-T,1,-2.5-T/2,1,-1.5).F(n.GR(0,-1.25,.5+T/8,0,0,4-T/4,["#ff0a","#e206","#d004"])),$JB.set(s,E)),this.$qB&&!A||n.$rC($JB.get(s).$fC,-1,-4,2,4),this.$qB&&(A&&n.O(.5).T($vB(bar),-5),this.$qB.$pB(n))})},$eC(E){return!(this.$dB[0].$T.filter(E=>IS(E,$n)).find(E=>!E.$YB)||!this.$qB)},$V(E){var t=this["$qB"];t&&($o.$HB.push(t),$o.shell.$aC(t),DJ.$YC($vC($o.shell.$HB,(E,t)=>E?t+1:null).filter(E=>E)),this.$qB=0,$uB("$8C"),$uB("$eB"))}},"$nC"),$GC("$bB",[["$WC",13],["$bC",0],["$HB",[]],["$QB",[]],["$1",[]],["$f",[]],["$xB",()=>$u(256,E=>$u(256,E=>null))],["$CB",[]],["$vC",null],["$KB",null],["$8",[]],["$T",[]],["$P",[]],["$D",[]],["$J",null],["$l",null]],{$U(E){this.$vC=this.$vC||$t({$aB:256,$h:256,os:!0}),this.$KB=this.$KB||$t({$aB:256,$h:256,os:!0}),this.$WC=E,rand.$WC(E);var[E,t]=rand.$5([$b,$3]),[T,A]=rand.$5([rand.$5([$3B,$DB,$hC]),rand.$5([$cC,$mB,$x])]);this.$HB=[$n,E,...T,$ED,...A,t,...rand.$5([$IC,$A]),$1B],this.$J=$J(),this.$l=$l();this.$QB=$u(28,E=>(new $dB).$U(12).$JC([96,0,0]).$CD(E*$VB[28]-$VB[4])),this.$1=$u(13,E=>{E=E<10?(new $dB).$U(18).$JC([80,0,0]).$CD($VB[10]*(E+2.5)):(new $dB).$U(18).$JC([0,16*(E-11)*2.5,0]);return E.$J=$J(),E.$l=$l(),E}),this.$f=$u(3,E=>[$AD((new $dB).$U(16).$JC([0,56,0]).$CD($VB[16]*(2*E+2)),{$l:$l()}),$AD((new $dB).$U(16).$JC([0,56,0]).$CD($VB[16]*(2*E+10)),{$l:$l()})]).flat();const s=this.$1[this.$HB.indexOf($DB)];E=this.$f.find(E=>E.$oB(s).$tC()<E.$q+s.$q);const n=this.$1[this.$HB.indexOf($mB)];T=this.$f.find(E=>E.$oB(n).$tC()<E.$q+n.$q);$rB([[E,$DB,$MB],[T,$mB,$QC]],([T,t,A])=>{T.$T.push(...$u(7,E=>$AD((new t).$JC([0,12,0]).$CD($VB[7]*(E+rand()/8)).$JC(T),{$dB:[T]}))),$u(32,E=>{const t=new $nC(0,-T.$q,0).$CD($VB[32]*(E+rand.$fB()/4));this.$1.filter(E=>t.$iB().$JC(T).$oB(E).$tC()<=E.$q+.05).length<1?((E=(new A).$U().$JC(T).$JC(t)).$dB.push(T),T.$P.push(E),this.$P.push(E)):((E=(new $UC).$U().$JC(T).$JC(t)).$dB.push(T),T.$T.push(E),this.$T.push(E))})});const i=this.$1[this.$HB.indexOf($hC)],e=this.$f.reduce((E,t)=>!E||E.$oB(i).$tC()>t.$oB(i).$tC()&&0===t.$T.length?t:E,null),r=($u(13,E=>{E=(new $jB).$U().$JC([4+rand.$sC(7),0,0]).$CD($VB[13]*E).$JC(e);E.$dB.push(e),e.$P.push(E),this.$P.push(E)}),this.$f.push((new $dB).$U(8).$JC([0,-62,0]),(new $dB).$U(8).$JC([0,-16,0]),(new $dB).$U(8).$JC([0,16,0])),this.$CB=[...this.$QB,...this.$1,...this.$f],$rB(this.$QB,(T,E)=>{T.$KC="moon "+E,$rB(T.$p,t=>{var E;this.$CB.filter(E=>t.$iB().$JC(T).$oB(E).$tC()<=E.$q+.05).length<2&&((E=(new $QC).$U().$JC(T).$JC(t)).$dB.push(T),T.$P.push(E),this.$P.push(E))});E=$AD(new $g,{x:T.x,y:T.y,$UB:E}).$y(0,0,.5);T.$P.push(E),this.$P.push(E)}),this.$HB=$vC(this.$HB,E=>(new $qB).$U(E)),$rB(this.$1,(A,E)=>{var t=(new $wB).$JC(A);t.$qB=this.$HB[E],A.$T.push(t),t.$dB.push(A),$u(3,E=>{var E=$VB[3]*(E+rand.$fB()/8),t=10+rand.$sC(2),T=(new $n).$JC(new $nC(0,t,0).$CD(E).$JC(A)),t=(new $x).$JC(new $nC(0,t+2,0).$CD(E+$VB[32]*rand.$XC()).$JC(A));$rB(([])=>E=>{var{x:t,y:T}=this.$zC();$AD(E,{x:t,y:T})}),A.$T.push(T,t),$rB([t,T],E=>E.$dB.push(A))}),12!==E&&$u(32,E=>{const t=new $nC(0,-A.$q,0).$CD($VB[32]*(E+rand.$fB()/4));this.$CB.filter(E=>t.$iB().$JC(A).$oB(E).$tC()<=E.$q+.05).length<2&&((E=new(rand.bit()?$MB:$hB)).$U().$JC(A).$JC(t),E.$dB.push(A),A.$P.push(E),this.$P.push(E))})}),this.$T.push(...$vC(this.$CB,E=>E.$T).flat().sort($I)),this.$vC.DO(A=>{A.E().center(),$rB(this.$CB.filter(E=>!this.$f.includes(E)),T=>{A.P(),$rB(T.$p,(E,t)=>(t?A.L:A.M)(E[0]+T.x,E[1]+T.y)),A.C().F(A.GR(0,90,90,0,0,256,["#242","#262"])).O(.25).W(A.GR(0,184,276,0,0,256,["#353","#484"]),1).O(1)})}),this)["$KB"],R=(r.P().A(128,128,108).W("#202",16).P().A(128,164,80).M(128,128).L(25,150).L(25,80).L(55,50).L(128,30).L(206,50).L(231,80).L(231,150).L(128,128).F(this.$KB.GR(128,164,23,128,164,28,["#fff2","#2026","#202"])).P().A(128,102,40).F(this.$KB.GR(128,128,32,128,128,256,["hwb(250deg 14% 57%)","hwb(220deg 65% 12%)"])).P().A(128,164,22).F(this.$KB.GR(128,164,16,128,160,30,["#fff8","#fff4"])),r.P(),$rB(this.$f,E=>r.M(E.x+128,E.y+128).A(E.x+128,E.y+128,E.$q)),r.F(r.GR(128,128,48,128,108,192,["#141","#263"])),this.$KB.$rC(this.$vC.$fC,0,0,256,256),$AD(new $IC,{$q:10}));return $rB(this.$QB,(t,E)=>{$AD(R,{$UB:E}),this.$KB.DO(E=>{E.T(128+t.x,128+t.y).O(.875).P().A(0,0,t.$q).F(t.$FB).O(.125),R.$pB(E)})}),this.$KB.DO(E=>{E.center(),$rB(this.$P.filter(E=>!(E instanceof $g)),E=>this.$KB.P().A(E.x,E.y+.5,1.25).F(E.$FB))}),$rB([...this.$T,...this.$P,$o],E=>{E.y=$AB(E.y),E.x=$AB(E.x),this.$xB[E.y+128][E.x+128]=E,IS(E,$x)&&(this.$xB[E.y+128][E.x+127]=E,this.$xB[E.y+128][E.x+129]=E)}),this},$VC(){},$EC(){},$y(t){const T=this.$CB.filter(E=>$tC($oB(E,$o))<E.$q);return(T.find(E=>!$o.$dB.includes(E))||$o.$dB.find(E=>!T.includes(E)))&&($o.$dB=T,DJ?.$LB?.((T.find(E=>E.$J)||this).$J,(T.find(E=>E.$l)||this).$l)),$rB(this.$CB,E=>E.$y(t)),this},$pB(t){this.$D.length=0;var T=-t.W2/$BD,A=t.W1/$BD;let s=1;const n=max(0,$ZB($c.y));for(let E=n;E<=min(256,$ZB($c.y+132));E+=1){s&&t.O(1-s);const n=new $nC($c.x,E-128,0).$4(0);var i=n[2];if(0===i)break;var e=i*$BD*2,r=max(0,$KB($c.x+128-t.W2/e)-4);min(256-r,ceil(t.W1/e)+8);t.$rC(this.$KB.$fC,$c.x+128-t.W2/e,E,t.W1/e,1,T,(n[1]-t.H2)/$BD,A,2*i),$rB($0C(this.$xB[E].filter(E=>E),$I),E=>{E.$pB(t),E.$eC?.($o)&&this.$D.unshift(E)}),s&&(t.O(1),s=max(0,s-i/4))}return t.$fC}},"$nC")),TV=$t();let moon=new $IC,sun=$ED(32,"#ffd"),rand=$XB(13),stars=$u(91,()=>[rand.$fB(),rand.$fB()]),shell=$1B(),$o=$AD(new $n,{x:0,y:104,z:0,shell:shell,$E:-1,$FB:"#840",$v:"#620"}),$RB=new $nC,world=($RB.$OC=$OC().M(-2,-2).L(2,2).L(-2,2).L(2,-2).C(),(new $bB).$U(13)),$c=new $nC($o.x,$o.y+$C,$o.z+$L);const $4C=t=>{$m||(D+=t*$SC,$zB=D%$gC/$gC,measure=$KB(D/4e3),bar=D%4e3/4e3,beat=$KB(8*bar),$FD=$KB(D/250),$DC!==$FD&&$uB("tick"),$DC=$FD,step=D%$dC/$dC,$CC.change&&$o.$Z.unshift($AD(new $3C,{$FD:$FD,$2:$CC.$JC})),$CC.shift?$o.$K=4:$o.$K=2,world.$y(t),$o.$y(t),$rB(world.$T,E=>E.$7B?.()),$rB(world.$T,E=>E.$y?.(t))),$c.x+=($o.x-$c.x)/16,$c.y+=($o.y+($m?$C:$G)-$c.y)/16,$c.z+=($o.z-$c.z+($m?$L:$R))/16};let $HC=$u(256,E=>[E,E]).flat().map(E=>E/$BD);const $FC=(E=0)=>{performance.now();var t=E-now;now=E,$4C(t*$SC);const{H1:T,H2:e,H3:A,W1:s,W2:r,W3:n,R3:R,RM:h}=TV;E=$zB,t=E;const I=(E+.5)%1;moon.$UB=D?$KB((28+(D-$0()*$gC)/$gC)%28):0;let O=$6(t)*n;const S=$Y(t);let a=$6(I)*n;const L=$Y(I);.5<E?O=-a:a=-O;let N;TV.DO(()=>{if(TV.E(),TV.ctx.fillStyle=.1<S?"#840":"#202",TV.ctx.fillRect(0,0,s,T),TV.center(),.25<L){const i=A-L*A*2;$rB(stars,([E,t])=>{var T=E*r,A=(t-I)*e,s=OF($tC([a,i],[T,A]),4*moon.$q),n=1+.5*sin((7.3*t+now%$gC/$gC+1.1*E)*$d),t=(1+n)**2*max(0,sin(7.3*t+now/$gC*130+11*E)**3);TV.O(max(0,1-moon.$OB()/2-(s<.25?1:1-s))).P().A(T,A,n).F("#ffd").C(),TV.P().M(T,A-t).L(T,A+t).M(T-t,A).L(T+t,A).W("#ffd",.5)}),N=`rgba(204,204,255,${$pC(.1*moon.$OB())})`,TV.O(max(0,L)).P().A(a,i,2*h).C().F(TV.GR(a,i,R*moon.$OB(),a,i,2*R,[`rgba(204,204,255,${$pC(.05+.2*moon.$OB())})`,N,N,"rgba(24,0,24,0)"])).T(a,i),moon.$pB(TV),N="#ccf6"}.25<S&&(TV.O(max(0,S)),N="#aae6",TV.P().A(O,A-S*A*2,2*h).C().F(TV.GR(O,A-S*A*2,sun.R*max(S,0),O,A-S*A*2,h,["#fff","#aae","#aaec","rgba(170,170,238,0)"])).$rC(sun.$rC,O-sun.R,A-S*A*2-sun.R,sun.D,sun.D))}),TV.DO(()=>{TV.T(r,e),TV.S($BD,$BD),world.$pB(TV)}),TV.DO(()=>TV.T($RB.x-2,$RB.y-2).S(4,4).R($d*$vB(now%4e3/4e3)).FP("#280c",$RB.$OC)),$RB.$w=$m?null:world.$D.find(E=>TV.ctx.isPointInPath(E.$M(),$RB.x,$RB.y)),$RB.$w&&TV.DO(()=>{var E=$RB.$w.$M();TV.ctx.setLineDash([13,7]),TV.ctx.lineDashOffset=now/1e3*20,TV.WP("#280",1,E)});const i=$o.$O.length;$rB($o.$O,(t,E)=>{const T=(TV.W1-128)/(i+1)*(E+1)+32,A=TV.H1-128;TV.DO(E=>t.$pB(E.T(T,A).P().RR(0,0,64,64,4).C().F("#fff4"),!0))}),$m&&(TV.ctx.fillStyle="#0f0",TV.ctx.font="32px monospace",$rB(["wasd = move","shift = run","esc = pause/resume","mouse = interact",DJ?"- paused -":"click to play"],(E,t)=>TV.ctx.fillText(E,TV.W2-TV.ctx.measureText(E).width/2,32*(t+1)))),requestAnimationFrame($FC)},$CC=($FC(0),{w:0,a:0,s:0,d:0,get change(){return this.w+this.a+this.s+this.d},get $JC(){var{w:E,a:t,s:T,d:A}=this;return{w:E,a:t,s:T,d:A}}}),$j=($NC("mousedown",()=>$m=!1),ON("click",()=>$RB.$w?.$V($o)),ON("keydown",E=>{$uB("input");E=E.key.toLowerCase();$CC[E]=1,$uB("key-"+E),"escape"===E&&($m=!$m,$uB("pause"))}),ON("keyup",E=>$CC[E.key.toLowerCase()]=0),ON("mousedown",()=>$uB("input")),ON("mousemove",({clientX:E,clientY:t})=>$AD($RB,{x:E,y:t})),ON("resize",()=>{TV.$s(min(1920,window.innerWidth),min(1080,window.innerHeight))}),$rB(["visibilitychange","blur"],E=>ON(E,()=>{$rB(Object.keys($CC),E=>$CC[E]=0)})),(E,t,T)=>E.addEventListener(t,T));$rB(["mousedown","mouseup","mousemove","click","keydown","keyup","visibilitychange"],t=>$j(document,t,(...E)=>$uB(t,...E))),$rB(["resize","blur"],t=>$j(window,t,(...E)=>$uB(t,...E))),$j(document,"click",()=>DJ=DJ||$2B()),document.body.appendChild(TV.$TC);})()