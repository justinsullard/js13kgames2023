(()=>{let now=0,$3=500,$6=144e3,D=0,$NA=0,$t=0,$RA=0,measure=0,beat=0,bar=0,step=0,$8B=!0,$6A=1,$p=32;const{cos,sin,min,max,sqrt,floor:$wA,ceil,round:$JB,imul,abs,PI,sign:$bA}=Math,$gB=(E=0,t=E=>E)=>new Array(E).fill(0).map((E,t)=>t).map(t),$q=([E,t],T)=>[E*cos(T)-t*sin(T),E*sin(T)+t*cos(T)],$XA=([E,t,T],[s,i,A])=>[E+s,t+i,T+A],$DA=([E,t,T],[s,i,A])=>[E-s,t-i,T-A],$d=(E,t=1e3)=>$JB(E*t)/t,$M=(E,t)=>E<t?E/t:1,$m=(E,t)=>max(0,$M(E,t)),$K=(E,t,T)=>t<E&&E<T,$L=(E,t)=>E instanceof t,$eA=(E,t=(E,t)=>E-t)=>E.sort(t),$KB=([E,t],T=1)=>[E*T,t*T],$0A=([E,t],T=1)=>{T/=$h([E,t])||1;return[E*T,t*T]},$h=([E,t],[T=0,s=0]=[])=>sqrt((T-E)**2+(s-t)**2),$mB=E=>(0<E?$wA:ceil)(E),$WB=E=>(E<0?$wA:ceil)(E),$nB=E=>$bA(E)*$JB(abs(E)),$0B=2*PI,$GB=$gB(128,E=>E?$0B/E:0),$o=(...E)=>Object.assign(...E),$GA=(E,t)=>E.forEach?.(t),$j=(E,t)=>E.map(t),$PC=(E,t)=>E.y-t.y||E.z-t.z||E.x-t.x,$c=E=>1+2.70158*(E-1)**3+1.70158*(E-1)**2,$9=E=>E*E*(2.70158*E-1.70158),$a=E=>1-cos(E*PI/2),$HA=E=>-(cos(PI*E)-1)/2,$uA=E=>sin(E*PI),$JA=E=>sin(E*$0B),$7=2.5949095,$8=$0B/4.5,$FC=()=>min(500/$6,.05),$DC=E=>{let t=max(0,sin(E*$0B)),T=$FC();return T<E&&E<=2*T?t+=2*$c((E-T)/T):2*T<E&&E<.5?t+=2:.5<=E&&E<.5+T&&(t+=2-2*$9((E-.5)/T)),t/3},$sB=E=>2*$HA($M(E,.5))-1,$lA=E=>[(min(2*E,0)-(1-cos(E*$0B)))/2,-$a(-min(sin(E*$0B),0))/2],$HB=(E=0)=>{let s=0|E;return let=fn=()=>{var E=(s=s+2654435769|0)^s>>>16,E=imul(E,569420461);return E^=E>>>15,(((E=imul(E,1935289751))^E>>15)>>>0)/4294967296*2},$o(fn,{$aA:E=>void 0!==E?s=0|E:s,$g:(E=1)=>$JB(fn()*E),$w:()=>1-2*fn(),$bA:()=>$WB(fn.$w()),bit:()=>$JB(fn()),bool:()=>!!$JB(fn()),$rB:E=>E.slice().sort(fn.$w),$3A:E=>E[$mB(fn()*E.length)],$e:(E,t,T,s,i,A)=>`hwb(${$JB(E+fn.$w()*t)} ${$JB(T+fn.$w()*s)}% ${$JB(i+fn.$w()*A)}%)`,$X:(E,t,T=1)=>[E+fn.$w()*T,t+fn.$w()*T],$B:(E,t)=>{var T=s;return s=0|(E??s),t(),s=T,E??T}})},$gA=new Map,$r=E=>($gA.has(E)||$gA.set(E,new Set),$gA.get(E)),$O=(E,t)=>$r(E).add(t),$l=(E,t)=>$r(E).delete(t),$IA=(E,...t)=>$GA([...$r(E)],E=>E(...t)),$1A=(t,T)=>{let s=(...E)=>{$l(t,s),T(...E)};$O(t,s)};let DJ=0;const $dA=(E=0,t=0,T=16)=>{let s=E?T/E:0;return $eA($gB(E,E=>$wA(E*s+t+T)%T))},$A=$dA(7,2,12),$SB=32/27,Q=$gB(51,E=>440*2**((E-36)/12)).filter((E,t)=>$A.includes(t%12)).slice(2),$AB=(E,t=[])=>$eA([...new Set([...E,...t])]),$QC=()=>{let T=Q.slice(1,14);return[[Q[0],.3,0,[0,3,8,11,14]],...$gB(13,E=>{let t=rand.$3A(T);return T=T.filter(E=>E!==t),[t,.05+.15*rand(),rand.$w(),$dA(1+rand.$g(),rand.$g(15))]})]},$7B=()=>[Q[15],...rand.$rB(Q.slice(16))].slice(0,8),$Y=(E,t,T,s,i,A,n=6)=>{const e=E.createOscillator();var r=E.createGain(),E=E.createStereoPanner();e.frequency.setValueAtTime(s/$SB,A),$GA($dA(n,2),(E,t)=>e.frequency.exponentialRampToValueAtTime(t%2?T*$SB:T/$SB,A+t/8)),r.gain.setValueAtTime(.1*s,A),r.gain.exponentialRampToValueAtTime(.5*s,A),r.gain.exponentialRampToValueAtTime(s,A+.325),r.gain.exponentialRampToValueAtTime(.01,A+2),E.pan.setValueAtTime(i,A),E.pan.exponentialRampToValueAtTime(-i,A+2),e.connect(r),r.connect(E),E.connect(t),e.start(A),e.stop(A+2)},$v=(E,t,T,s,i,A,n,e)=>{var r=E.createOscillator(),R=E.createGain(),h=E.createStereoPanner(),E=E.createDynamicsCompressor(),n=$d(n||s);r.frequency.setValueAtTime(T,A),r.frequency.exponentialRampToValueAtTime(T/1.5,A+.5),R.gain.setValueAtTime(.01,A),R.gain.exponentialRampToValueAtTime(n,A+1/32),R.gain.exponentialRampToValueAtTime(n/5,A+1/16),R.gain.linearRampToValueAtTime(0,A+.5),h.pan.setValueAtTime(e??i,A),E.threshold.setValueAtTime(-50,A),E.knee.setValueAtTime(40,A),E.ratio.setValueAtTime(12,A),E.attack.setValueAtTime(0,A),E.release.setValueAtTime(.25,A),r.connect(R),R.connect(h),h.connect(E),E.connect(t),r.start(A),r.stop(A+.51)},$dB=(E,t,T,s=0,i)=>{var A=.04+.03*rand(),n=1/8+rand()/16,e=E.createOscillator(),r=E.createGain(),E=E.createStereoPanner();e.type="triangle",e.frequency.setValueAtTime(T,i),r.gain.setValueAtTime(A,i),r.gain.exponentialRampToValueAtTime(A/2,i+1/32),r.gain.linearRampToValueAtTime(0,i+n),E.pan.setValueAtTime(s,i),e.connect(r),r.connect(E),E.connect(t),e.start(i),e.stop(i+n)},$MB=()=>{const A=new AudioContext,n=A.createAnalyser(),E=(n.connect(A.destination),n.fftSize=256,n.frequencyBinCount),t=new Uint8Array(E);let T=-$d(D/4e3,10)%1,e=T,s=[0],r=[],i=[],R=null,h=null;var I=(E=$QC(),t=$7B())=>{R=E,h=t};return setInterval(()=>{A.currentTime+.25<e||e<0||(R&&(r=R,R=null),h&&(i=h,h=null),$Y(A,n,(i[7-(beat+measure%8)%8]||2*Q[rand.$g(6)])/2,.2,.5*rand.$w(),e,$wA(e-T)%3+4),$GA(s,E=>{const[t,T,s,i]=r[E];$GA(i,E=>$v(A,n,t,$d(T),s,.25*E+e))}),e+=4)},100),$O("$dB",(E=0)=>{$dB(A,n,(i[beat]||Q[15])/2,"number"==typeof E?E:0,A.currentTime)}),$O("beat",()=>{var[,E,t,,]=r[0];$v(A,n,Q[14],E,t,A.currentTime)}),$O("$Y",()=>$Y(A,n,2*(i[7-(beat+measure%8)%8]||Q[0]),.3,.5*rand.$w(),A.currentTime,6)),$O("pause",()=>{"running"===A.state&&$8B?A.suspend():"suspended"!==A.state||$8B||A.resume()}),I(),{$xA:I,n:e,get track(){return r},get voices(){return s},get melody(){return i},get $AA(){return n.getByteFrequencyData(t),Array.from(t).slice(0,E/2)},$cA:(E=[],t)=>{s=$AB([0,...E]),i=t||i}}},$2A=($fB=({$UB:E=min(1920,window.innerWidth),$4B:t=min(1080,window.innerHeight),os:s=!1}={})=>{let i=s?null:document.createElement("canvas"),A=(i&&(i.width=E,i.height=t),s?new OffscreenCanvas(E,t):i.transferControlToOffscreen()),e=A.getContext("2d");A.width=E,A.height=t;const r={get $T(){return A.width},get $U(){return A.width/2},get $V(){return A.width/3},get $H(){return A.height},$I:A.height/2,get $J(){return A.height/3},get $P(){return min(r.$J,r.$V)},get Rm(){return min(r.$H,r.$T)},get $Q(){return max(r.$H,r.$T)},$5:A,$7A:i,ctx:e,$eB:(E,t)=>{var T;s||(T=document.createElement("canvas"),i.replaceWith(T),(i=T).width=E,T.height=t,A=i.transferControlToOffscreen(),e=A.getContext("2d"),$o(r,{$5:A,ctx:e,$7A:i})),A.width=E,A.height=t,r.$I=A.height/2},$B:E=>(e.save(),E(r),e.restore(),r),E:()=>(e.clearRect(0,0,r.$T,r.$H),r),center:()=>(r.T(r.$U,r.$I),r),$D:(E="none")=>(e.filter=E,r),T:(E,t)=>(e.translate(E,t),r),R:(E,t)=>(e.rotate(E,t),r),$R:(...E)=>(e.roundRect(...E),r),M:(...E)=>(e.moveTo(...E),r),L:(...E)=>(e.lineTo(...E),r),A:(E=0,t=0,T=1,s=0,i=$GB[1],A=!1)=>(e.arc(E,t,T,s,i,A),r),B:(...E)=>(e.bezierCurveTo(...E),r),P:E=>(e.beginPath(),E?.match(/[MLABCTREOSFW](?:\s*-?\d+(?:\.\d+)?|\s*#[a-f0-9]{3,8}|\s*hwb\([^)]+?\))*/g).forEach(E=>{var[E,...t]=E.includes("(")?[E[0],E.slice(1).trim()]:E.split(" ");r[E](...$j(t,E=>"#"===E[0]||E.includes("(")?E:parseFloat(E,10)))}),r),C:()=>(e.closePath(),r),O:E=>(e.globalAlpha=E,r),S:(E=1,t=1)=>(e.scale(E,t),r),$G:(T,s)=>$GA(s,(E,t)=>T.addColorStop(t/s.length,E)),$E:(E,t,T,s,i)=>{E=e.createLinearGradient(E,t,T,s);return r.$G(E,i),E},$F:(E,t,T,s,i,A,n)=>{E=e.createRadialGradient(E,t,T,s,i,A);return r.$G(E,n),E},F:E=>(e.fillStyle=E,e.fill(),r),$C:(E,t)=>(e.fillStyle=E,e.fill(t),r),W:(E,t)=>(e.strokeStyle=E,e.lineWidth=t,e.stroke(),r),$W:(E,t,T)=>(e.strokeStyle=E,e.lineWidth=t,e.stroke(T),r),$f:(...E)=>(e.drawImage(...E),r)};return r.E(),r.$EA=(E,t)=>E.$EA(r,t),r},()=>{const n=new Path2D;return n.M=(...E)=>(n.moveTo(...E),n),n.L=(...E)=>(n.lineTo(...E),n),n.A=(E=0,t=0,T=1,s=0,i=$GB[1],A=!1)=>(n.arc(E,t,T,s,i,A),n),n.$=(...E)=>(n.arcTo(...E),n),n.B=(...E)=>(n.bezierCurveTo(...E),n),n.Q=(...E)=>(n.quadraticBezierCurveTo(...E),n),n.C=()=>(n.closePath(),n),n}),$jA=(E,t)=>$fB({$UB:E,$4B:t||E,os:!0}),$s=(E=32,t="#840")=>{const T=$jA(3*E),s=E/4,i=1.4*E;return T.$B(()=>{T.E().center().P().A(0,0,E).C().F(t).P().M(-i,-s).L(i,-s).M(-i,s).L(i,s).M(-s,-i).L(-s,i).M(s,-i).L(s,i).W(t,3)}),{R:1.5*E,D:3*E,get $f(){return T.$5}}},$UA=(Array.$xB=()=>[],(a,d,m={},p="$b")=>{const dd=window[p].$xB?.()??[],o=dd.length,dv=$j(d,([,E])=>"function"==typeof E?E.toString().replace(/^\(\) ?=> ?/,""):JSON.stringify(E)).join(","),e=`window.${a}=class ${a} extends ${p}{`+`static $xB=()=>[...${p}.$xB(),${dv}];`+`constructor(...x){super(...(x.length ? x : ${a}.$xB()))}`+"*[Symbol.iterator]() {for(let i = 0,l=this.length;i<l;i++){yield this[i]}}"+$j(d,([E],t)=>`  get ${E}(){return this[${t+o}]} set ${E}(x){return this[${t+o}]=x}`).join("")+$j(Object.values(m),E=>E.toString()).join("")+"};";return eval(e)}),$PA=($UA("$b",[["x",0],["y",0],["z",0],["$1",0],["$u",[]],["$aA",null],["$UB",0],["$4B",0]],{$z(){return new this.constructor(...this)},$XA(E){return[this.x,this.y,this.z]=$XA(this,E),this},$q(E){return[this.x,this.y]=$q(this,E),this},$DA(E){return new $b(...$DA(this,E))},$n(){return $j([this.x,this.y,this.z],$JB)},$0A(E=1){return[this.x,this.y]=$0A([this.x,this.y],E),this},$KB(E=1){return this.$0A(this.$h()*E),this},$h(){return $h([this.x,this.y])},$5A(E){var[t,T,s]=this.$VC();return E.S(s,s),E.T(t,T),this},$VC(){var[E,t,T]=this.$DA($ZB),s=t<0?4/-t*5:0;return[E*=4,t=4*T*s,s]},$qB(E=1){var[t,T,s]=this.$VC(),i=(t*=s*$p,T*=s*$p,1===this.$UB?1:2),A=E?-$p*i*s:0;return new $b(t+$S.$U,T+$S.$I+A,i*s*(E?$p:1))},$IC(){var[E,t,T]=this.$qB();return $2A().A(E,t,abs(T)).C()},$lB(){},$RB(){},$EA(){},$4(){},$C(){}},"Array"),$UA("$hA",[["$t",0],["$oB",{}],["$iB",null],["$PB",null],["$fA",null],["$lB",null]],{},"Array"),{w:0,a:0,s:0,d:0}),$LB=($UA("$Z",[["shell",null],["$OB",0],["$DB",0],["$JC",1],["$UC",1],["$CC",()=>new $b],["$zA",()=>new $b],["$vB",()=>new $b(1,1,0)],["$EC",[]],["w",0],["a",0],["s",0],["d",0],["$RC",2],["$KC",[]],["$XC",1],["$tA",[]],["$AC",0],["$MC",[0,0,0]]],{$1B(){return this.$OB?abs(this.$OB):0},$tB(){var E=this.$DB%1;return E*=this.$CC.$h?.()||$K(E,1/32,31/32)?1:0,(this.$JC<0?1-E:E)%1},$sA(){return this.$tB()?$M(this.$tB()%.5,.5)%1:1-bar%.5*2%1},$lB(E){E=min(1,E/1e3);let{w:t,a:T,s,d:i}=this;var A=$JB(this.x)+128,n=$JB(this.y)+128,e=this.$EC.filter(E=>E.$t<=$t),e=(e.length?($GA(e,E=>{var t,T,s;E.$PB=E.$PB||E.$t,E.$iB?$h(this,E.$iB)>1/16?(E.$t=$t,[T,s]=(t=$0A($DA(E.$iB,this),1)).map(abs),$o(E.$oB,t[0]<0?{a:T,d:0}:{a:0,d:T},t[1]<0?{w:s,s:0}:{w:0,s:s})):(E.$fA=E.$t,E.$oB={w:0,a:0,s:0,d:0}):(E.$t=-1,E.$fA=$t),$o(this,E.$oB)}),e.length&&({w:t,a:T,s,d:i}=this),this.$EC=this.$EC.filter(E=>!E.$fA||E.$fA>$t||E.$t>$t)):$o(this,{w:0,a:0,s:0,d:0}),this.$zA=new $b(i-T,s-t,0),this.$JC=$bA(this.$zA.x||this.$JC),this.$UC=$bA(this.$zA.y||this.$UC),new $b(...this.$zA)),r=new $b(...this.$CC),R=this.$sA();if(0===e.$h()&&$K(r.$h(),1/16,R)&&e.$XA(new $b(...this.$vB).$0A((1-R)/2)),e.$0A(4*E),this.$zA.$h()){const s=.75+$M(e.$z().$0A(2).$XA(r.$z().$0A(1)).$h(),3)/4;r.$KB(s)}r.$XA(e),r.$0A(min(r.$h(),this.$RC));var h,e=(this.$CC=r).$h(),I=new $b(...r);I.$0A(I.$h()*E);const O=$XA(this,I);this.$u.length&&!this.$u.find(E=>$h($DA(E,O))<E.$cB)&&I.$KB(-.5);let S=$JB(this.x+I.x)+128,a=$JB(this.y+I.y)+128;if(A===S&&n===a||((h=world.$LA[a][S])&&h!==this&&(I.$KB(-.1),S=$JB(this.x+I.x)+128,a=$JB(this.y+I.y)+128),world.$LA[n][A]=null,world.$LA[a][S]=this),this.$XA(I),this.$DB+=I.$h(),this.$OB=e*this.$JC,this.$vB=e?r.$z().$0A(1):this.$vB,this.$zA.$h()<.25&&r.$h()&&r.$KB(this.$sA()<1/8?0:$m(1-2*E,1)),0===r.$h()&&this.$tB()&&R&&(r.$KB(0),this.$DB=$JB(2*this.$DB)/2),this===$aB){const s=$wA(this.$DB/.25);s>this.$AC&&$IA("$dB",this.$vB.x/-2),this.$AC=s}}},"$b"),({$CA:t=512,$tA:i=[]}={})=>{const A=$jA(t),s=t/2,n=t/12,T={R:s,$CA:t,$tA:i,$EA:(E=A)=>(E.$B(()=>{let T=5.6*n;E===A&&E.E().center(),E.P().A(0,0,s).C().F(E.$F(0,2*n,4*n,0,0,t,["#242","#262"])),A.P().A(0,0,T),$gB(28,E=>{var[E,t]=$q([1,0],$GB[28]*(E-.5)-$GB[4]);A.M(E*T,t*T).L(E*s,t*s)}),A.W(A.$F(0,2*n,3*n,0,0,t,["#3536","#4846"]),2),$gB(13,E=>{let t=0,T=(E-11)*n*2.25;var s;E<10&&(s=$GB[10]*(E+2.5),[t,T]=$q([4.5*n,0],s)),A.P().A(t,T,n).C().F("rgba(127,127,127,0.25)"),i[E]&&A.P().A(t,T,n).C().F("#aa9")})}),T),$0(E){return i[world.$tA.indexOf(E)]=1,T.$EA(),T},get $f(){return A.$5}};return T.$EA(),T}),$OC=new Map,$vA=($UA("$9B",[["$MA",null],["$rA",()=>`hwb(${$JB(30+10*rand.$w()-2)} ${$JB(0+10*rand())}% ${$JB(47+10*rand())}%)`],["$hB",()=>`hwb(${$JB(30+2*rand.$w()-2)} 0% ${$JB(67+4*rand())}%)`],["$IB",0],["$EB",[]],["$TB",[]]],{$2A(E,t,T,s,i){var A,n,e,r,R,h,[E,t,T,s,i]=[$d(E,4),$d(t,64),T,s,$d(i[0],4)],s=[E,t,T,s,i].join();return $OC.has(s)||(A=$JA(t)/8,n=E?E/8:$JA(t)/16,e=$uA(t)/8,abs(E/16),[t,r]=[E?$lA(t):[0,0],E?$lA(1-t):[0,0]],[[t,r],[R,h]]=[t,r],i=sqrt(abs(i)/(abs(E)||1)),$OC.set(s,$2A().A(0+n*i,e-3,1,$0B[4],$0B).M(0+n*i,e-2).L(2+R/3,A*T-1.5).L(1+t/16,A*T-1).L(1+t*i,r).L(0,e-1).L(-1-R*i,h).L(R/16-1,-1-A*T).L(-2-t/3,-1.5-A*T).C())),$OC.get(s)},$EA(n,e=bar%.5*2,r=!0){n.$B(()=>{r&&this.$5A(n);var E=this.$tB()%.5,E=E?$M(E%.5,.5):1-e,t=this["$OB"];let T=t?t/8:$JA(E)/16,s=$uA(E)/8,i=abs(t/16);const A=sqrt(abs(this.$CC[0])/(abs(t)||1));this.shell&&0<this.$UC&&n.P().A(0-T*A/2,-1.75-s/2+i,7/8).C().W("#242",1/16).F("#131");t=this.$2A(this.$OB,E,this.$JC,this.$UC,this.$CC);n.$W(this.$hB,1/8,t).$C(this.$rA,t),this.shell&&(this.$UC<0||$8B)&&n.$B(()=>{n.P().A(0-T*A/2,-1.75-s/2+i,7/8).C(),n.W("#242",1/16),n.T(0-T*A/2,-1.75-s/2+i),n.R(this.$CC[0]/16),n.$f(shell.$f,-1,-1,2,2)}),$CB.$iB})},$RB(){var E,t,T;this.$MA||(this.$MA=this.$n()),this.$IB&&!this.$EC?.length&&(E=$t%576,E=$t-E,t=this.$u[0],t=$DA(t,this),T=$h(t),this.$EC=[$o(new $hA,{$t:288+E+rand.$g(16),$iB:$XA($KB(t,(T-2)/T),this)}),$o(new $hA,{$t:528+E+rand.$g(16),$iB:this.$MA}),$o(new $hA,{$t:575+E})].filter(E=>E.$t>=$t))},$4(E){return this!==E&&this.$DA(E).$h()<=4&&(!this.$IB&&!this.$EB.length||this.$EB.find(t=>$aB.$KC.find(E=>$L(E,t)))||this.$IB&&this.$TB.find(t=>$aB.$KC.find(E=>$L(E,t))))},$C(E){var t,T;this.$IB||this.$EB.length||($IA("$Y"),this.$IB=1,t=this.$u[0],t=$DA(t,this),T=$h(t),this.$EC.push($o(new $hA,{$t:$t+1+rand.$g(8),$iB:$XA($KB(t,(T-2)/T),this)})));const s=$j(this.$EB,t=>E.$KC.find(E=>$L(E,t))).filter(E=>E);if(s.$5B){const i=this.$EB.filter(t=>s.find(E=>$L(E,t)));E.$KC=E.$KC.filter(E=>!s.includes(E)),this.$EB=this.$EB.filter(E=>!i.includes(E))}}},"$Z"),$UA("$XB",[["$MA",null],["$nA",1]],{$RB(){if(this.$MA||(this.$MA=this.$n()),this.$nA){if(!this.$EC?.length){var E=$t%576;const t=$t-E,T=this.$u[0],s=this.$DA(T);$h(s);const i=$GB[14];this.$EC=$gB(14,E=>$o(new $hA,{$t:t+42*E+rand.$g(4),$fA:t+42*E+42-1,$iB:s.$z().$q(i*(E+rand()/8)).$XA(T)})).filter(E=>E.$t>=$t)}return this}}},"$Z"),$UA("$BA",[],{$EA(A){A.$B(()=>{this.$5A(A),A.S(this.$JC,1);var E=this.$OB,[t,T]=E?$lA(this.$sA()):[0,0],[s,i]=E?$lA(1-this.$sA()):[0,0],[[s,i],[t,T]]=0<this.$JC?[[t,T],[s,i]]:[[s,i],[t,T]],E=sqrt(abs(this.$CC[0])/(abs(E)||1));A.P().M(1,i/4-2).L(0-t*E,0+T).L(0,i/4-1).C().M(-1,T/4-1).L(s*E-1,0+i).L(-2,T/4-1.5).C().F("#520"),A.P().M(1,i/4-3).L(2,i/4-2).L(1,i/4-2).L(1+s*E,0+i).L(0,i/4-1).L(-1,T/4-1).L(-2-t*E,0+T).L(-2,T/4-1.5).L(-1.75,T/4-1.75).L(-2,T/4-2).L(0,i/4-2).L(.5,i/4-2.5).L(0,i/4-3).C().W("#620",1/8).F("#840"),A.P().A(1,i/4-4,1,$GB[2],1,!0).W("#620",.125)})}},"$XB"),$UA("$pA",[],{$EA(A,E,t,T){A.$B(()=>{this.$5A(A),A.S(this.$JC,1);var E=this.$OB,[t,T]=E?$lA(this.$sA()):[0,0],[s,i]=E?$lA(1-this.$sA()):[0,0],[[s,i],[t,T]]=0<this.$JC?[[t,T],[s,i]]:[[s,i],[t,T]],E=sqrt(abs(this.$CC[0])/(abs(E)||1));A.P().M(1,i/4-2).L(0-t*E,0+T).L(0,i/4-1).C().M(-1,T/4-1).L(s*E-1,0+i).L(-2,T/4-1.5).C().F("#520"),A.P().M(2,i/4-2).L(2,i/4-1).L(1.5,i/4-.5).L(1,i/4-1).L(1+s*E,0+i).L(0,i/4-1).L(-1,T/4-1).L(-2-t*E,0+T).L(-2,T/4-1.5).L(-1.75,T/4-1.75).L(-2,T/4-2).L(0,i/4-3).L(1,i/4-2.25).L(1.5,i/4-2.5).C().W("#620",1/8).F("#840"),A.P().A(2,i/4-2.25,.75,$GB[2],$GB[2]+$GB[7]).W("#620",.125)})}},"$XB"),$UA("$WA",[["$FB",0],["$cB",32],["$rA","#ccf"],["$hB","#ccf4"]],{$EA(n){n.$B(()=>{var E,t,{$FB:T,$cB:s}=this,i=s-1,A=1.3*s;T&&(E=$mB(cos($GB[28]*T)*A),t=T<14?E:-A,T=14<T?-E:A,n.P().M(0,i).B(T,s,T,-s,0,-i).B(t,-s,t,s,0,i).C().F(this.$rA)),n.P().A(0,0,i).C().W(this.$hB,s/16)})},$B(){return abs(sin($GB[2]*this.$FB/28))}},"$b"),$UA("$u",[["$rA",()=>`hwb(${120+rand.$g(25)} ${10+rand.$g(5)}% ${$JB(65+rand.$g(5))}%)`],["$cB",16],["$bB",[]],["$yB",[]],["$LC",[]],["$QC",null],["$7B",null]],{$zB(t=16){this.$cB=t;rand();return this.$bB=$gB(16,E=>new $b(0,-t,0).$q($GB[16]*(E+rand()/4))),this},$lB(t){$GA(this.$LC,E=>E.$lB(t))}},"$b"),$UA("$mA",[["$S",null]],{$EA(E){return this.$S||(this.$S=$fB({$UB:64,$4B:64}).P().M(...rand.$X(1,28)).L(...rand.$X(24,24)).L(...rand.$X(21,12)).L(...rand.$X(31,11)).L(...rand.$X(33,23)).L(...rand.$X(47,14)).L(...rand.$X(53,21)).L(...rand.$X(61,31)).L(...rand.$X(52,44)).L(...rand.$X(42,47)).L(...rand.$X(43,43)).L(...rand.$X(39,48)).L(...rand.$X(16,57)).L(...rand.$X(9,54)).L(...rand.$X(3,42)).C().F(rand.$e(15,2,17,2,68,4))),E.$f(this.$S.$5,0,0,64,64),E}},"$b"),$UA("$4A",[["$2A",""],["$S",null],["$ZA",0],["$rA",()=>rand.$e(150,2,10,6,80,4)]],{$zB(E){return this.$aA=rand.$B(this.$aA,()=>{const A=min(8,this.$1=E||this.$1||4*rand()+3),n=ceil(A);let e=0,r=0,R=0;this.$2A=$gB(n,E=>{var t=(A-E)/(A-E+3),T=e-t/.125,s=t*(n-E),i=e+t+.5,E=$M(A-E,n),t=$d(rand.$w()*E*t/2),s=(r=max(s,r),`M ${t} ${$d(T)} L ${$d(-s)} ${$d(i)-rand()*E} L ${$d(R)} ${$d(e+.25)} L ${$d(s)} ${$d(i)-rand()*E} L ${t} `+$d(T));return R=t,e=T,s}).join(" ")+(" F "+this.$rA),this.$UB=ceil(2*r),this.$4B=ceil(abs(e)),this.$S=$fB({$UB:this.$UB*$p*4,$4B:this.$4B*$p*4,os:!0}),this.$S.$B(E=>E.S($p,$p).T(this.$UB/2,this.$4B).P(this.$2A))}),this},$EA(E){if(this.$S)return E.$B(()=>{this.$5A(E),E.$f(this.$S.$5,-this.$UB/2,-this.$4B,4*this.$UB,4*this.$4B)}),this},$lB(E){this.$ZA=this.$ZA||4+rand.$g(284),$t>=this.$ZA&&(this.$zB(this.$1+(rand()+1)/8),this.$ZA=$t+576)},$4(E){return 2<this.$1&&this.$DA(E).$h()<=4},$C(E){E.$KC.push(new $mA),this.$zB(--this.$1),$IA("beat")}},"$b"),$UA("$3B",[["$S",null],["$FB",0],["$rA",()=>rand.$e(180,4,33,3,55,4)],["$RA",-1],["$qA",0]],{$zB(){const T=this.$qA,s=(this.$UB=4,this.$4B=4,this.$S=this.$S??$jA(this.$UB*$p*4,this.$4B*$p*4),rand.$w()/4);var E=T?-2:-1.5;const i=rand()/8,A=E+i;return this.$S.$B(E=>{var t;E.E().S($p,$p).T(this.$UB/2,this.$4B).P().M(-1.5-s,0).B(-2.5,-3,-1,-3,s,i-2).B(1,-3,2.5,-3,1.5+s,0).C().F(this.$rA).P().M(0,0).B(2*-s,-i,4*s,A,s,A).W("#0002",1/8),E.P().A(s,A,T?.75:1/8).F(`hwb(${$JB((180/28*this.$FB+240+rand.$w()/4)%360)} ${$JB(10+25*rand())}% 5%)`),this.$qA&&(t=$o(new $WA,{$cB:10,$FB:this.$FB,$rA:"#ccf",$hB:"#000a"}),E.O(.5).T(1.25*s,A).S(1/16,1/16),t.$EA(E))}),this},$EA(E,t){if(this.$S)return t?E.$f(this.$S.$5,0,0,256,256):E.$B(()=>{this.$5A(E),E.$f(this.$S.$5,-this.$UB/2,-this.$4B,4*this.$UB,4*this.$4B)}),E},$lB(E,t,T){t=t??moon?.$FB,T=T??$NA;return t!==this.$RA&&.5<=T&&!this.$qA&&(this.$RA=t,this.$qA=+((moon?.$FB??-1)===this.$FB),this.$zB()),this},$4(E){return this.$qA&&this.$DA(E).$h()<=2},$C(E){var t=$o(this.$z(),{$S:null});E.$KC.push(t.$zB()),this.$qA=0,this.$zB(),$IA("$Y")}},"$b"),$UA("$yA",[["$2A",""],["$S",null],["$ZA",0],["$rA",()=>rand.$e(120,2,20,2,67,2)]],{$zB(t){return this.$aA=rand.$B(this.$aA,()=>{const T=min(4,this.$1=t||this.$1||3*rand()+1);var E=ceil(T);const s=6*E+1;this.$2A="M 2 0 "+$gB(s,E=>{var t=(E+.5)/s*PI,E=E%2;return`L ${$d(2*cos(t)+(E?rand.$w()/8:0))} `+(E?$d(sin(t)*-T*2+rand.$w()/2):-.5)}).join(" ")+" L -2 0 C F "+this.$rA,this.$UB=4,this.$4B=2*E,this.$S=$fB({$UB:this.$UB*$p*4,$4B:this.$4B*$p*4,os:!0}),this.$S.$B(E=>E.S($p,$p).T(this.$UB/2,this.$4B).P(this.$2A))}),this},$EA(E,t){if(this.$S)return t?E.$f(this.$S.$5,0,0,256,256):E.$B(()=>{this.$5A(E),E.$f(this.$S.$5,-this.$UB/2,-this.$4B,4*this.$UB,4*this.$4B)}),this},$lB(E){this.$ZA=this.$ZA||4+rand.$g(284),$t>=this.$ZA&&this.$1<4&&(this.$zB(this.$1+(rand()+1)/8),this.$ZA=$t+576)},$4(E){return 2<this.$1&&this.$DA(E).$h()<=4},$C(E){E.$KC.push($o((new $yA).$zB(1),{$1:1})),this.$zB(--this.$1),$IA("beat")}},"$b"),$UA("$YB",[["$S",null]],{$EA(E){return this.$S||(this.$S=$fB({$UB:64,$4B:64}).P().M(...rand.$X(2,32)).B(0,64,0,64,...rand.$X(16,62)).L(...rand.$X(48,62)).B(64,64,64,64,...rand.$X(62,32)).L(...rand.$X(48,32)).L(...rand.$X(48,12)).L(32,12).L(32,16).L(...rand.$X(44,16)).L(...rand.$X(44,32)).L(...rand.$X(20,32)).L(...rand.$X(20,16)).L(32,16).L(32,12).L(...rand.$X(16,12)).L(...rand.$X(16,32)).C().F(rand.$e(42,2,26,2,43,4)).P().M(...rand.$X(14,38)).L(...rand.$X(28,58)).M(...rand.$X(36,38)).L(...rand.$X(50,58)).M(...rand.$X(52,38)).L(...rand.$X(38,58)).M(...rand.$X(30,38)).L(...rand.$X(16,58)).W("#4404",2)),E.$f(this.$S.$5,0,0,64,64),E}},"$b"),$UA("$A",[["$S",null]],{$EA(E){}},"$b"),$UA("$QB",[["$S",null]],{$EA(E){return this.$S||(this.$S=$fB({$UB:64,$4B:64}).P().M(...rand.$X(2,58)).L(...rand.$X(4,61)).L(...rand.$X(61,9)).L(...rand.$X(58,6)).C().F(rand.$e(15,2,17,2,68,4)).P().M(...rand.$X(7,4)).L(...rand.$X(7,8)).L(...rand.$X(58,61)).L(...rand.$X(61,58)).L(...rand.$X(18,18)).L(...rand.$X(20,12)).L(...rand.$X(18,10)).L(...rand.$X(16,16)).C().F(rand.$e(15,2,17,2,68,4))),E.$f(this.$S.$5,0,0,64,64),E}},"$b"),$UA("$y",[["$2A",""],["$S",null],["$ZA",0],["$rA",()=>rand.$e(105,2,12,2,65,2)]],{$zB(s){return this.$aA=rand.$B(this.$aA,()=>{const t=min(4,this.$1=s||this.$1||3*rand()+1);var E=ceil(t);const T=2*E+1;this.$2A="M 2 0 "+$gB(T,E=>{E=(E+.5)/T*PI;return`L ${$d(2.75*cos(E)+rand.$w()/2)} `+$d(sin(E)*-t+rand.$w()/4)}).join(" ")+` L -2 0 C F ${this.$rA} W #1324 0.125`,this.$UB=6,this.$4B=2*E,this.$S=$fB({$UB:this.$UB*$p*4,$4B:this.$4B*$p*4,os:!0}),this.$S.$B(E=>E.S($p,$p).T(this.$UB/2,this.$4B).P(this.$2A))}),this},$EA(E,t){if(this.$S)return t?E.$f(this.$S.$5,0,0,256,256):E.$B(()=>{this.$5A(E),E.$f(this.$S.$5,-this.$UB/2,-this.$4B,4*this.$UB,4*this.$4B)}),this},$lB(E){this.$ZA=this.$ZA||4+rand.$g(284),$t>=this.$ZA&&this.$1<4&&(this.$zB(this.$1+(rand()+1)/8),this.$ZA=$t+576)},$4(E){return 2<this.$1&&this.$DA(E).$h()<=4},$C(E){E.$KC.push(new $QB),this.$zB(--this.$1),$IA("beat")}},"$b"),$UA("$8A",[["$S",null],["$rA",()=>rand.$e(32,3,37,4,55,4)]],{$zB(){return this.$aA=rand.$B(this.$aA,()=>{this.$S=$jA(64).P().M(...rand.$X(4,60,3)).L(...rand.$X(9,32,4)).L(...rand.$X(16,16,7)).L(...rand.$X(32,20,8)).L(...rand.$X(48,16,6)).L(...rand.$X(53,32,4)).L(...rand.$X(60,60,3)).L(57,64).L(7,64).C().F(this.$rA).W("#332",1),this.$UB=1,this.$4B=1}),this},$EA(E,t){return this.$S||this.$zB(),t?E.$f(this.$S.$5,0,0,64,64):E.$B(()=>{this.$5A(E),E.$f(this.$S.$5,-this.$UB/2,-this.$4B,this.$UB,this.$4B)}),this},$4(E){return this.$DA(E).$h()<=4},$C(E){E.$KC.push(this);var[E,t]=this.$n(),t=(world.$LA[t+128][E+128]=null,this.$u[0].$yB),E=world.$yB;t.splice(t.indexOf(this),1),E.splice(E.indexOf(this),1),$IA("beat")}},"$b"),$UA("$BC",[["$S",null]],{$EA(E){}},"$b"),$UA("$pB",[["$S",null]],{$EA(E){return this.$S||(this.$S=$jA(64).P().A(24,24,20,PI/2,PI).L(...rand.$X(48,8)).C().F(rand.$e(32,3,37,4,55,4)).P().M(...rand.$X(24,8)).L(...rand.$X(20,12)).L(...rand.$X(59,61)).L(...rand.$X(61,59)).C().F(rand.$e(15,2,17,2,68,4))),E.$f(this.$S.$5,0,0,64,64),E}},"$b"),$UA("$2",[["$S",null]],{$EA(E){return this.$S||(this.$S=$jA(64).P().M(64,32).L(...rand.$X(52,25)).L(54,32).L(...rand.$X(52,39)).C().F(rand.$e(32,3,37,4,55,4)).P().M(20,32).L(...rand.$X(17,28)).L(0,28).L(4,32).L(0,36).L(...rand.$X(17,36)).C().F("#fffc").P().M(3,32).L(59,32).M(...rand.$X(20,4)).L(...rand.$X(20,60)).W(rand.$e(15,2,17,2,68,4),2).P().A(20,32,29,-PI/2-1/8,PI/2+1/8).W(rand.$e(15,2,17,2,68,4),4)),E.$f(this.$S.$5,0,0,64,64),E}},"$b"),$UA("$jB",[["$S",null],["$rA",()=>rand.$e(46,3,30,5,40,4)]],{$zB(){return this.$aA=rand.$B(this.$aA,()=>{const t=rand.$X(32,16,5),T=rand.$X(32,38,3),s=3*rand.$w(),i=rand.$e(10,3,11,3,50,4),A=this.$rA,n=rand.$e(46,3,5,2,75,4);this.$S=$jA(512).S(8,8).$B(E=>E.P().M(3+s,64).L(...t).L(61+s,64).C().F(E.$F(32,0,16,32,-32,112,[i,A,A,A,i])).W(i,.5).P().M(21+s,64).L(...T).L(43+s,64).C().F(n).P().M(t[0]-4,t[1]-7).L(...t).L(t[0]+5,t[1]-8).W(n,1)),this.$UB=8,this.$4B=8}),this},$EA(E,t){return this.$S||this.$zB(),t?E.$f(this.$S.$5,0,0,64,64):E.$B(()=>{this.$5A(E),E.$f(this.$S.$5,-this.$UB/2,-this.$4B,this.$UB,this.$4B)}),this}},"$b"),$UA("$NB",[["$S",null]],{$EA(E){return this.$S||(this.$S=$jA(64).P().M(...rand.$X(3,8)).L(...rand.$X(6,3)).L(...rand.$X(48,45)).L(...rand.$X(45,48)).C().F(rand.$e(15,2,17,2,68,4)).P().M(...rand.$X(63,63)).L(...rand.$X(59,47)).L(...rand.$X(42,42)).L(...rand.$X(47,59)).C().F(rand.$e(32,3,37,4,55,4))),E.$f(this.$S.$5,0,0,64,64),E}},"$b"),$UA("$WC",[["$S",null]],{$EA(E){return this.$S||(this.$S=$jA(64).P(),this.$S.$B(t=>{$gB(4,E=>{t.M(...$XA([32,28],$q([0,26],$GB[12]*E))).L(...$XA([32,28],$q([0,26],$GB[12]*(E+4)))).L(...$XA([32,28],$q([0,26],$GB[12]*(E+8)))).L(...$XA([32,28],$q([0,26],$GB[12]*E)))}),t.W("#ffcc",1).P().M(6,28).L(2,47).L(6,63).L(10,50).L(6,28).M(58,28).L(54,52).L(58,63).L(62,53).L(58,28).F("#fffc").P().A(32,28,26).W(rand.$e(15,2,17,2,68,4),4)})),E.$f(this.$S.$5,0,0,64,64),E}},"$b"),$UA("$x",[["$S",null]],{$EA(E){}},"$b"),$UA("$FA",[["$OA",null],["$N",[]],["$B",()=>{}]],{},"$b"),new Map),$S=($UA("$KA",[["$i",()=>new $mA],["O",()=>rand()],["$FA",null]],{$EA(i,E){i.$B(()=>{this.$5A(i);var E,t,T,s=$d((this.O+bar%.5*2)%1,64);i.$B(()=>i.T(-1.5,-2).S(1/32,1/32).$EA(this.$i)),i.$B(()=>i.T(1.5,-1.75).S(-1/32,1/32).$EA(this.$i)),$vA.has(s)||(E=$jA(128,256),t=$JA(s),T=$JA((s+.25)%1),E.S(64,64).T(1,4).P().M(1,-1.5).A(0,-1.5,1,0,$GB[2]).B(-1,-2.5-T/2,0+t,-2.5-T,0-t/2,-3.5).B(0-t,-2.5-T,1,-2.5-T/2,1,-1.5).F(i.$F(0,-1.25,.5+T/8,0,0,4-T/4,["#ff0a","#e206","#d004"])),$vA.set(s,E)),i.$f($vA.get(s).$5,-1,-4,2,4)})},$4(E){return!(this.$u[0].$yB.filter(E=>$L(E,$9B)).find(E=>!E.$IB)||!this.$FA)},$C(E){var t=this["$FA"];t&&($aB.$tA.push(t),$aB.shell.$0(t),DJ.$cA($j($aB.shell.$tA,(E,t)=>E?t+1:null).filter(E=>E)),this.$FA=0,$IA("$Y"),$IA("$v"))}},"$b"),$UA("$VB",[["$aA",13],["$1",0],["$tA",[]],["$BB",[]],["$GC",[]],["$2B",[]],["$LA",()=>$gB(256,E=>$gB(256,E=>null))],["$oA",[]],["$j",null],["$wA",null],["$uB",[]],["$yB",[]],["$LC",[]],["$TC",[]],["$QC",null],["$7B",null]],{$zB(E){this.$j=this.$j||$fB({$UB:256,$4B:256,os:!0}),this.$wA=this.$wA||$fB({$UB:256,$4B:256,os:!0}),this.$aA=E,rand.$aA(E);var[E,t]=rand.$rB([$YB,$pB]),[T,s]=rand.$rB([rand.$rB([$NB,$pA,$A]),rand.$rB([$2,$BA,$jB])]);this.$tA=[$9B,E,...T,$x,...s,t,...rand.$rB([$BC,$WC]),$LB],this.$QC=$QC(),this.$7B=$7B();this.$BB=$gB(28,E=>(new $u).$zB(12).$XA([96,0,0]).$q(E*$GB[28]-$GB[4])),this.$GC=$gB(13,E=>{E=E<10?(new $u).$zB(18).$XA([80,0,0]).$q($GB[10]*(E+2.5)):(new $u).$zB(18).$XA([0,16*(E-11)*2.5,0]);return E.$QC=$QC(),E.$7B=$7B(),E}),this.$2B=$gB(3,E=>[$o((new $u).$zB(16).$XA([0,56,0]).$q($GB[16]*(2*E+2)),{$7B:$7B()}),$o((new $u).$zB(16).$XA([0,56,0]).$q($GB[16]*(2*E+10)),{$7B:$7B()})]).flat();const i=this.$GC[this.$tA.indexOf($pA)];E=this.$2B.find(E=>E.$DA(i).$h()<E.$cB+i.$cB);const A=this.$GC[this.$tA.indexOf($BA)];T=this.$2B.find(E=>E.$DA(A).$h()<E.$cB+A.$cB);$GA([[E,$pA,$yA],[T,$BA,$4A]],([T,t,s])=>{T.$yB.push(...$gB(7,E=>$o((new t).$XA([0,12,0]).$q($GB[7]*(E+rand()/8)).$XA(T),{$u:[T]}))),$gB(32,E=>{const t=new $b(0,-T.$cB,0).$q($GB[32]*(E+rand.$w()/4));this.$GC.filter(E=>t.$z().$XA(T).$DA(E).$h()<=E.$cB+.05).length<1?((E=(new s).$zB().$XA(T).$XA(t)).$u.push(T),T.$LC.push(E),this.$LC.push(E)):((E=(new $8A).$zB().$XA(T).$XA(t)).$u.push(T),T.$yB.push(E),this.$yB.push(E))})}),this.$oA=[...this.$BB,...this.$GC,...this.$2B],$GA(this.$BB,(T,E)=>{T.$YA="moon "+E,$GA(T.$bB,t=>{var E;this.$oA.filter(E=>t.$z().$XA(T).$DA(E).$h()<=E.$cB+.05).length<2&&((E=(new $4A).$zB().$XA(T).$XA(t)).$u.push(T),T.$LC.push(E),this.$LC.push(E))});E=$o(new $3B,{x:T.x,y:T.y,$FB:E}).$lB(0,0,.5);T.$LC.push(E),this.$LC.push(E)}),$GA(this.$GC,(s,E)=>{var t=(new $KA).$XA(s);t.$FA=this.$tA[E],s.$yB.push(t),t.$u.push(s),$gB(3,E=>{var E=$GB[3]*(E+rand.$w()/8),t=10+rand.$g(2),T=(new $9B).$XA(new $b(0,t,0).$q(E).$XA(s)),t=(new $jB).$XA(new $b(0,t+2,0).$q(E+$GB[32]*rand.$bA()).$XA(s));$GA(([])=>E=>{var{x:t,y:T}=this.$n();$o(E,{x:t,y:T})}),s.$yB.push(T,t),$GA([t,T],E=>E.$u.push(s))}),12!==E&&$gB(32,E=>{const t=new $b(0,-s.$cB,0).$q($GB[32]*(E+rand.$w()/4));this.$oA.filter(E=>t.$z().$XA(s).$DA(E).$h()<=E.$cB+.05).length<2&&((E=(new(rand.bit()?$yA:$y)).$zB().$XA(s).$XA(t)).$u.push(s),s.$LC.push(E),this.$LC.push(E))})}),this.$yB.push(...$j(this.$oA,E=>E.$yB).flat().sort($PC)),this.$j.$B(s=>{s.E().center(),$GA(this.$oA.filter(E=>!this.$2B.includes(E)),T=>{s.P(),$GA(T.$bB,(E,t)=>(t?s.L:s.M)(E[0]+T.x,E[1]+T.y)),s.C().F(s.$F(0,90,90,0,0,256,["#242","#262"])).O(.25).W(s.$F(0,184,276,0,0,256,["#353","#484"]),1).O(1)})});const n=this["$wA"],e=(n.P().A(128,128,108).W("#202",16).C().P().A(128,102,40).F(this.$wA.$F(128,128,32,128,128,256,["hwb(250deg 14% 57%)","hwb(220deg 65% 12%)"])).P().A(128,164,22).F(this.$wA.$F(128,164,16,128,160,30,["#fff8","#fff4"])),n.P(),$GA(this.$2B,E=>n.M(E.x+128,E.y+128).A(E.x+128,E.y+128,16)),n.F(n.$F(128,128,48,128,108,192,["#141","#263"])),this.$wA.$f(this.$j.$5,0,0,256,256),$o(new $WA,{$cB:10}));return $GA(this.$BB,(t,E)=>{$o(e,{$FB:E}),this.$wA.$B(E=>{E.T(128+t.x,128+t.y).O(.875).P().A(0,0,t.$cB).F(t.$rA).O(.125),e.$EA(E)})}),this.$wA.$B(E=>{E.center(),$GA(this.$LC.filter(E=>!(E instanceof $3B)),E=>this.$wA.P().A(E.x,E.y+.5,1.25).F(E.$rA))}),$GA([...this.$yB,...this.$LC,$aB],E=>{E.y=$nB(E.y),E.x=$nB(E.x),this.$LA[E.y+128][E.x+128]=E,$L(E,$jB)&&(this.$LA[E.y+128][E.x+127]=E,this.$LA[E.y+128][E.x+129]=E)}),this},$9A(){},$SA(){},$lB(t){const T=this.$oA.filter(E=>$h($DA(E,$aB))<E.$cB);return(T.find(E=>!$aB.$u.includes(E))||$aB.$u.find(E=>!T.includes(E)))&&($aB.$u=T,DJ?.$xA?.((T.find(E=>E.$QC)||this).$QC,(T.find(E=>E.$7B)||this).$7B)),$GA(this.$oA,E=>E.$lB(t)),this},$EA(t){this.$TC.length=0;var T=-t.$U/$p,s=t.$T/$p;let i=1;const A=max(0,$JB($ZB.y));for(let E=A;E<=min(256,$JB($ZB.y+132));E+=1){i&&t.O(1-i);const A=new $b($ZB.x,E-128,0).$qB(0);var n=A[2];if(0===n)break;var e=n*$p*2,r=max(0,$wA($ZB.x+128-t.$U/e)-4);min(256-r,ceil(t.$T/e)+8);t.$f(this.$wA.$5,$ZB.x+128-t.$U/e,E,t.$T/e,1,T,(A[1]-t.$I)/$p,s,2*n),$GA($eA(this.$LA[E].filter(E=>E),$PC),E=>{E.$EA(t),E.$4?.($aB)&&this.$TC.unshift(E)}),i&&(t.O(1),i=max(0,i-n/4))}return t.$5}},"$b"),$fB());let moon=new $WA,sun=$s(32,"#ffd"),rand=$HB(13),stars=$gB(91,()=>[rand.$w(),rand.$w()]),shell=$LB(),$aB=$o(new $9B,{x:0,y:104,z:0,shell:shell,$UC:-1,$rA:"#840",$hB:"#620"}),$CB=new $b,world=($CB.$2A=$2A().M(-2,-2).L(2,2).L(-2,2).L(2,-2).C(),(new $VB).$zB(13)),entities=[],$NC=20,$wB=-2,$SC=4,$HC=-1/8,$ZB=new $b($aB.x,$aB.y+$SC,$aB.z+$HC);const $iA=t=>{$8B||(D+=t*$6A,$NA=D%$6/$6,measure=$wA(D/4e3),bar=D%4e3/4e3,beat=$wA(8*bar),$t=$wA(D/250),$RA!==$t&&$IA("tick"),$RA=$t,step=D%$3/$3,$QA.change&&$aB.$EC.unshift($o(new $hA,{$t:$t,$oB:$QA.$XA})),$QA.shift?$aB.$RC=4:$aB.$RC=2,world.$lB(t),$aB.$lB(t),$GA(world.$yB,E=>E.$RB?.()),$GA(world.$yB,E=>E.$lB?.(t))),$ZB.x+=($aB.x-$ZB.x)/16,$ZB.y+=($aB.y+($8B?$SC:$NC)-$ZB.y)/16,$ZB.z+=($aB.z-$ZB.z+($8B?$HC:$wB))/16};let $VA=$gB(256,E=>[E,E]).flat().map(E=>E/$p);const $TA=(E=0)=>{performance.now();var t=E-now;now=E,$iA(t*$6A);const{$H:T,$I:e,$J:s,$T:i,$U:r,$V:A,$P:R,$Q:h}=$S;E=$NA,t=E;const I=(E+.5)%1;moon.$FB=D?$wA((28+(D-$FC()*$6)/$6)%28):0;let O=$sB(t)*A;const S=$DC(t);let a=$sB(I)*A;const L=$DC(I);.5<E?O=-a:a=-O;let N;$S.$B(()=>{if($S.E(),$S.ctx.fillStyle=.1<S?"#840":"#202",$S.ctx.fillRect(0,0,i,T),$S.center(),.25<L){const n=s-L*s*2;$GA(stars,([E,t])=>{var T=E*r,s=(t-I)*e,i=$M($h([a,n],[T,s]),4*moon.$cB),A=1+.5*sin((7.3*t+now%$6/$6+1.1*E)*$0B),t=(1+A)**2*max(0,sin(7.3*t+now/$6*130+11*E)**3);$S.O(max(0,1-moon.$B()/2-(i<.25?1:1-i))).P().A(T,s,A).F("#ffd").C(),$S.P().M(T,s-t).L(T,s+t).M(T-t,s).L(T+t,s).W("#ffd",.5)}),N=`rgba(204,204,255,${$d(.1*moon.$B())})`,$S.O(max(0,L)).P().A(a,n,2*h).C().F($S.$F(a,n,R*moon.$B(),a,n,2*R,[`rgba(204,204,255,${$d(.05+.2*moon.$B())})`,N,N,"rgba(24,0,24,0)"])).T(a,n),moon.$EA($S),N="#ccf6"}.25<S&&($S.O(max(0,S)),N="#aae6",$S.P().A(O,s-S*s*2,2*h).C().F($S.$F(O,s-S*s*2,sun.R*max(S,0),O,s-S*s*2,h,["#fff","#aae","#aaec","rgba(170,170,238,0)"])).$f(sun.$f,O-sun.R,s-S*s*2-sun.R,sun.D,sun.D))}),$S.$B(()=>{$S.T(r,e),$S.S($p,$p),world.$EA($S)}),$S.$B(()=>$S.T($CB.x-2,$CB.y-2).S(4,4).R($0B*$JA(now%4e3/4e3)).$C("#280c",$CB.$2A)),$CB.$iB=$8B?null:world.$TC.find(E=>$S.ctx.isPointInPath(E.$IC(),$CB.x,$CB.y)),$CB.$iB&&$S.$B(()=>{var E=$CB.$iB.$IC();$S.ctx.setLineDash([13,7]),$S.ctx.lineDashOffset=now/1e3*20,$S.$W("#280",1,E)});const n=$aB.$KC.length;$GA($aB.$KC,(t,E)=>{const T=($S.$T-128)/(n+1)*(E+1)+32,s=$S.$H-128;$S.$B(E=>t.$EA(E.T(T,s).P().$R(0,0,64,64,4).C().F("#fff4"),!0))}),$8B&&($S.ctx.fillStyle="#0f0",$S.ctx.font="32px monospace",$GA(["wasd + shift = move","esc = pause/resume","mouse = interact",DJ?"- paused -":"click to play"],(E,t)=>$S.ctx.fillText(E,$S.$U-$S.ctx.measureText(E).width/2,32*(t+1)))),requestAnimationFrame($TA)},$QA=($TA(0),{w:0,a:0,s:0,d:0,get change(){return this.w+this.a+this.s+this.d},get $XA(){var{w:E,a:t,s:T,d:s}=this;return{w:E,a:t,s:T,d:s}}}),$6B=($1A("mousedown",()=>$8B=!1),$O("click",()=>$CB.$iB?.$C($aB)),$O("keydown",E=>{$IA("input");E=E.key.toLowerCase();$QA[E]=1,$IA("key-"+E),"escape"===E&&($8B=!$8B,$IA("pause"))}),$O("keyup",E=>$QA[E.key.toLowerCase()]=0),$O("mousedown",()=>$IA("input")),$O("mousemove",({clientX:E,clientY:t})=>$o($CB,{x:E,y:t})),$O("resize",()=>{$S.$eB(min(1920,window.innerWidth),min(1080,window.innerHeight))}),$GA(["visibilitychange","blur"],E=>$O(E,()=>{$GA(Object.keys($QA),E=>$QA[E]=0)})),(E,t,T)=>E.addEventListener(t,T));$GA(["mousedown","mouseup","mousemove","click","keydown","keyup","visibilitychange"],t=>$6B(document,t,(...E)=>$IA(t,...E))),$GA(["resize","blur"],t=>$6B(window,t,(...E)=>$IA(t,...E))),$6B(document,"click",()=>DJ=DJ||$MB()),document.body.appendChild($S.$7A);})()