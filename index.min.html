<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>13 Drums</title><style>html,body{padding:0;margin:0;width:100%;height:100%;background:#202;cursor:none}body{display:flex;align-items:center;justify-content:center}</style><body><script>(()=>{let now=0,$0=500,$3=144e3,D=0,$GA=0,$q=0,$KA=0,measure=0,beat=0,bar=0,step=0,$OB=!0,$ZA=1,$m=32;const{cos,sin,min,max,sqrt,floor:$nA,ceil,round:$wA,imul,abs,PI,sign:$3A}=Math,$WB=(t=0,E=t=>t)=>new Array(t).fill(0).map((t,E)=>E).map(E),$n=([t,E],e)=>[t*cos(e)-E*sin(e),t*sin(e)+E*cos(e)],$QA=([t,E,e],[T,A,s])=>[t+T,E+A,e+s],$y=([t,E,e],[T,A,s])=>[t-T,E-A,e-s],$a=(t,E=1e3)=>$wA(t*E)/E,$L=(t,E)=>t<E?t/E:1,$i=(t,E)=>max(0,$L(t,E)),$K=(t,E,e)=>E<t&&t<e,$5A=(t,E=(t,E)=>t-E)=>t.sort(E),$xA=([t,E],e=1)=>[t*e,E*e],$TA=([t,E],e=1)=>{e/=$e([t,E])||1;return[t*e,E*e]},$e=([t,E],[e=0,T=0]=[])=>sqrt((e-t)**2+(T-E)**2),$0B=t=>(0<t?$nA:ceil)(t),$FB=t=>(t<0?$nA:ceil)(t),$1B=t=>$3A(t)*$wA(abs(t)),$HB=2*PI,$uA=$WB(128,t=>t?$HB/t:0),$l=(...t)=>Object.assign(...t),$AA=(t,E)=>t.forEach?.(E),$g=(t,E)=>t.map(E),$tB=(t,E)=>t.y-E.y||t.z-E.z||t.x-E.x,$9=t=>1+2.70158*(t-1)**3+1.70158*(t-1)**2,$6=t=>t*t*(2.70158*t-1.70158),$7=t=>1-cos(t*PI/2),$BA=t=>-(cos(PI*t)-1)/2,$lA=t=>sin(t*PI),$DA=t=>sin(t*$HB),$4=2.5949095,$5=$HB/4.5,$jB=()=>min(500/$3,.05),$hB=t=>{let E=max(0,sin(t*$HB)),e=$jB();return e<t&&t<=2*e?E+=2*$9((t-e)/e):2*e<t&&t<.5?E+=2:.5<=t&&t<.5+e&&(E+=2-2*$6((t-.5)/e)),E/3},$5B=t=>2*$BA($L(t,.5))-1,_WALK=t=>[(min(2*t,0)-(1-cos(t*$HB)))/2,-$7(-min(sin(t*$HB),0))/2],$bA=t=>_WALK(t),$vA=(t=0)=>{let T=0|t;return let=fn=()=>{var t=(T=T+2654435769|0)^T>>>16,t=imul(t,569420461);return t^=t>>>15,(((t=imul(t,1935289751))^t>>15)>>>0)/4294967296*2},$l(fn,{$2A:t=>void 0!==t?T=0|t:T,$d:(t=1)=>$wA(fn()*t),$t:()=>1-2*fn(),$3A:()=>$FB(fn.$t()),bit:()=>$wA(fn()),bool:()=>!!$wA(fn()),$4B:t=>t.slice().sort(fn.$t),$WA:t=>t[$0B(fn()*t.length)],$b:(t,E,e,T,A,s)=>`hwb(${$wA(t+fn.$t()*E)} ${$wA(e+fn.$t()*T)}% ${$wA(A+fn.$t()*s)}%)`,$W:(t,E,e=1)=>[t+fn.$t()*e,E+fn.$t()*e],$B:(t,E)=>{var e=T;return T=0|(t??T),E(),T=e,t??e}})},$7A=new Map,$o=t=>($7A.has(t)||$7A.set(t,new Set),$7A.get(t)),$N=(t,E)=>$o(t).add(E),$h=(t,E)=>$o(t).delete(E),$CA=(t,...E)=>$AA([...$o(t)],t=>t(...E)),$UA=(E,e)=>{let T=(...t)=>{$h(E,T),e(...t)};$N(E,T)};let $A=0;const Q=[32.7,36.71,41.2,43.65,49,55,61.74,65.41,73.42,87.31,98,110,130.81,174.61,196].map(t=>2*t),$CB=32/27,$4A=(t=0,E=0,e=16)=>{let T=t?e/t:0;return $5A($WB(t,t=>$nA(t*T+E+e)%e))},$uB=()=>{let e=Q.slice(1,-1);return[[Q[0],.3,0,[0,3,8,11,14]],...$WB(13,t=>{let E=rand.$WA(e);return e=e.filter(t=>t!==E),[E,.2*rand(),rand.$t(),$4A(1+rand.$d(),rand.$d(15))]})]},$NB=()=>[Q[0],...rand.$4B(Q.slice(1,9))].slice(0,8).map(t=>2*t),$X=(t,e,E,T,A,s=6)=>{const i=t.createOscillator();var n=t.createGain(),r=t.createStereoPanner();i.frequency.setValueAtTime(E/$CB,A),$AA($4A(s,2),(t,E)=>i.frequency.exponentialRampToValueAtTime(E%2?e*$CB:e/$CB,A+E/8)),n.gain.setValueAtTime(.1*E,A),n.gain.exponentialRampToValueAtTime(.5*E,A),n.gain.exponentialRampToValueAtTime(E,A+.325),n.gain.exponentialRampToValueAtTime(.01,A+2),r.pan.setValueAtTime(T,A),r.pan.exponentialRampToValueAtTime(-T,A+2),i.connect(n),n.connect(r),r.connect(t.destination),i.start(A),i.stop(A+2)},$s=(t,E,e,T,A,s,i)=>{var n=t.createOscillator(),r=t.createGain(),R=t.createStereoPanner(),O=t.createDynamicsCompressor(),s=s||e;n.frequency.setValueAtTime(E,A),n.frequency.exponentialRampToValueAtTime(E/1.5,A+.5),r.gain.setValueAtTime(.01,A),r.gain.exponentialRampToValueAtTime(s,A+1/32),r.gain.exponentialRampToValueAtTime(s/5,A+1/16),r.gain.linearRampToValueAtTime(0,A+.5),R.pan.setValueAtTime(i??T,A),O.threshold.setValueAtTime(-50,A),O.knee.setValueAtTime(40,A),O.ratio.setValueAtTime(12,A),O.attack.setValueAtTime(0,A),O.release.setValueAtTime(.25,A),n.connect(r),r.connect(R),R.connect(O),O.connect(t.destination),n.start(A),n.stop(A+.51)},$TB=(t,E,e=0,T)=>{var A=.04+.03*rand(),s=1/8+rand()/16,i=t.createOscillator(),n=t.createGain(),r=t.createStereoPanner();i.type="triangle",i.frequency.setValueAtTime(E,T),n.gain.setValueAtTime(A,T),n.gain.exponentialRampToValueAtTime(A/2,T+1/32),n.gain.linearRampToValueAtTime(0,T+s),r.pan.setValueAtTime(e,T),i.connect(n),n.connect(r),r.connect(t.destination),i.start(T),i.stop(T+s)},$zA=()=>{let i=new AudioContext,E=-$a(D/4e3,10)%1,n=E,e=[0],r=[],T=[];var t=(t,E)=>{r=t||$uB(),T=E||$NB()},A=()=>{var t=i.currentTime;if(!(t+.25<n||n<0)){$X(i,T[0]||2*Q[rand.$d(6)],.3,.5*rand.$t(),n,$nA(n-E)%3+4),T.push(T.shift());const s=1-$7($L(e.length-1,13))/2;$AA(e,t=>{const[E,e,T,A]=r[t];$AA(A,t=>$s(i,E,e*s,T,.25*t+n))}),n+=4}};return setInterval(A,100),$N("rattle",(t=0)=>{$TB(i,T[7-(beat+measure%8)%8]||Q[0],"number"==typeof t?t:0,i.currentTime)}),$N("beat",()=>{var[,t,E,,]=r[0];$s(i,Q[14],t,E,i.currentTime)}),$N("aah",()=>{console.log("Playing $X"),$X(i,2*(T[7-(beat+measure%8)%8]||Q[0]),.3,.5*rand.$t(),i.currentTime,6)}),$N("pause",()=>{"running"===i.state&&$OB?i.suspend():"suspended"!==i.state||$OB||i.resume()}),t(),A(),{fresh:t,n:n,get track(){return r},get voices(){return e},get melody(){return T},sing:(t=[],E)=>{e=[0,...t],T=E||T}}},$VA=($VB=({$DB:t=min(1920,window.innerWidth),$LB:E=min(1080,window.innerHeight),os:T=!1}={})=>{let A=T?null:document.createElement("canvas"),s=(A&&(A.width=t,A.height=E),T?new OffscreenCanvas(t,E):A.transferControlToOffscreen()),n=s.getContext("2d");s.width=t,s.height=E;const r={get $S(){return s.width},get $T(){return s.width/2},get $U(){return s.width/3},get $H(){return s.height},$I:s.height/2,get $J(){return s.height/3},get $O(){return min(r.$J,r.$U)},get Rm(){return min(r.$H,r.$S)},get $P(){return max(r.$H,r.$S)},$2:s,$0A:A,ctx:n,$UB:(t,E)=>{var e;T||(e=document.createElement("canvas"),A.replaceWith(e),(A=e).width=t,e.height=E,s=A.transferControlToOffscreen(),n=s.getContext("2d"),$l(r,{$2:s,ctx:n,$0A:A})),s.width=t,s.height=E,r.$I=s.height/2},$B:t=>(n.save(),t(r),n.restore(),r),E:()=>(n.clearRect(0,0,r.$S,r.$H),r),center:()=>(r.T(r.$T,r.$I),r),$D:(t="none")=>(n.filter=t,r),T:(t,E)=>(n.translate(t,E),r),R:(t,E)=>(n.rotate(t,E),r),$Q:(...t)=>(n.roundRect(...t),r),M:(...t)=>(n.moveTo(...t),r),L:(...t)=>(n.lineTo(...t),r),A:(t=0,E=0,e=1,T=0,A=$uA[1],s=!1)=>(n.arc(t,E,e,T,A,s),r),B:(...t)=>(n.bezierCurveTo(...t),r),P:t=>(n.beginPath(),t?.match(/[MLABCTREOSFW](?:\s*-?\d+(?:\.\d+)?|\s*#[a-f0-9]{3,8}|\s*hwb\([^)]+?\))*/g).forEach(t=>{var[t,...E]=t.includes("(")?[t[0],t.slice(1).trim()]:t.split(" ");r[t](...$g(E,t=>"#"===t[0]||t.includes("(")?t:parseFloat(t,10)))}),r),C:()=>(n.closePath(),r),O:t=>(n.globalAlpha=t,r),S:(t=1,E=1)=>(n.scale(t,E),r),$G:(e,T)=>$AA(T,(t,E)=>e.addColorStop(E/T.length,t)),$E:(t,E,e,T,A)=>{t=n.createLinearGradient(t,E,e,T);return r.$G(t,A),t},$F:(t,E,e,T,A,s,i)=>{t=n.createRadialGradient(t,E,e,T,A,s);return r.$G(t,i),t},F:t=>(n.fillStyle=t,n.fill(),r),$C:(t,E)=>(n.fillStyle=t,n.fill(E),r),W:(t,E)=>(n.strokeStyle=t,n.lineWidth=E,n.stroke(),r),$V:(t,E,e)=>(n.strokeStyle=t,n.lineWidth=E,n.stroke(e),r),$c:(...t)=>(n.drawImage(...t),r)};return r.E(),r.$z=t=>t.$z(r),r},()=>{const i=new Path2D;return i.M=(...t)=>(i.moveTo(...t),i),i.L=(...t)=>(i.lineTo(...t),i),i.A=(t=0,E=0,e=1,T=0,A=$uA[1],s=!1)=>(i.arc(t,E,e,T,A,s),i),i.$=(...t)=>(i.arcTo(...t),i),i.B=(...t)=>(i.bezierCurveTo(...t),i),i.Q=(...t)=>(i.quadraticBezierCurveTo(...t),i),i.C=()=>(i.closePath(),i),i}),$aA=(t,E)=>$VB({$DB:t,$LB:E||t,os:!0}),$p=(t=32,E="#840")=>{const e=$aA(3*t),T=t/4,A=1.4*t;return e.$B(()=>{e.E().center().P().A(0,0,t).C().F(E).P().M(-A,-T).L(A,-T).M(-A,T).L(A,T).M(-T,-A).L(-T,A).M(T,-A).L(T,A).W(E,3)}),{R:1.5*t,D:3*t,get $c(){return e.$2}}},$NA=(Array.$bB=()=>[],(a,d,m={},p="$8")=>{const dd=window[p].$bB?.()??[],o=dd.length,dv=$g(d,([,t])=>"function"==typeof t?t.toString().replace(/^\(\) ?=> ?/,""):JSON.stringify(t)).join(","),e=`window.${a}=class ${a} extends ${p}{`+`static $bB=()=>[...${p}.$bB(),${dv}];`+`constructor(...x){super(...(x.length ? x : ${a}.$bB()))}`+"*[Symbol.iterator]() {for(let i = 0,l=this.length;i<l;i++){yield this[i]}}"+$g(d,([t],E)=>`  get ${t}(){return this[${E+o}]} set ${t}(x){return this[${E+o}]=x}`).join("")+$g(Object.values(m),t=>t.toString()).join("")+"};";return eval(e)}),$IA=($NA("$8",[["x",0],["y",0],["z",0],["$Z",0],["$r",[]],["$2A",null]],{$u(){return new this.constructor(...this)},$QA(t){return[this.x,this.y,this.z]=$QA(this,t),this},$n(t){return[this.x,this.y]=$n(this,t),this},$y(t){return new $8(...$y(this,t))},$j(){return $g([this.x,this.y,this.z],$wA)},$TA(t=1){return[this.x,this.y]=$TA([this.x,this.y],t),this},$xA(t=1){return this.$TA(this.$e()*t),this},$e(){return $e([this.x,this.y])},$YA(t){var[E,e,T]=this.$zB();return t.S(T,T),t.T(E,e),this},$zB(){var[t,E,e]=this.$y($GB),T=E<0?4/-E*5:0;return[t*=4,E=4*e*T,T]},$3B(t=1){var[E,e,T]=this.$zB(),A=(E*=T*$m,e*=T*$m,t?2*-$m*T:0);return new $8(E+$R.$T,e+$R.$I+A,2*T*(t?$m:1))},$mB(){var[t,E,e]=this.$3B();return $VA().A(t,E,abs(e)).C()},$ZB(){},$BB(){},$z(){},$1(){},$eB(){}},"Array"),$NA("$A",[["$HA",null],["$M",[]],["$B",()=>{}]]),$NA("$8A",[["$q",0],["$2B",{}],["$YB",null],["$AB",null],["$6A",null],["$ZB",null]],{},"Array"),{w:0,a:0,s:0,d:0}),$yA=($NA("$Y",[["shell",null],["$B",0],["$sA",0],["$nB",1],["$yB",1],["$gB",()=>new $8],["$oA",()=>new $8],["$8B",()=>new $8(1,1,0)],["$iB",[]],["w",0],["a",0],["s",0],["d",0],["$vB",2],["$oB",[]],["$jA",[]],["$fB",0],["$qB",[0,0,0]]],{$IB(){return this.$B?abs(this.$B):0},$6B(){var t=this.$sA%1;return t*=this.$gB.$e?.()||$K(t,1/32,31/32)?1:0,(this.$nB<0?1-t:t)%1},$hA(){return this.$6B()?$L(this.$6B()%.5,.5)%1:1-bar%.5*2%1},$ZB(t){t/=1e3;let{w:E,a:e,s:T,d:A}=this;var s=$wA(this.x)+128,i=$wA(this.y)+128,n=this.$iB.filter(t=>t.$q<=$q),n=(n.length?($AA(n,t=>{var E,e,T;t.$AB=t.$AB||t.$q,t.$YB?$e(this,t.$YB)>1/16?(t.$q=$q,[e,T]=(E=$TA($y(t.$YB,this),1)).map(abs),$l(t.$2B,E[0]<0?{a:e,d:0}:{a:0,d:e},E[1]<0?{w:T,s:0}:{w:0,s:T})):(t.$6A=t.$q,t.$2B={w:0,a:0,s:0,d:0}):(t.$q=-1,t.$6A=$q),$l(this,t.$2B)}),n.length&&({w:E,a:e,s:T,d:A}=this),this.$iB=this.$iB.filter(t=>!t.$6A||t.$6A>$q||t.$q>$q)):$l(this,{w:0,a:0,s:0,d:0}),this.$oA=new $8(A-e,T-E,0),this.$nB=$3A(this.$oA.x||this.$nB),this.$yB=$3A(this.$oA.y||this.$yB),new $8(...this.$oA)),r=new $8(...this.$gB),R=this.$hA();if(0===n.$e()&&$K(r.$e(),1/16,R)&&n.$QA(new $8(...this.$8B).$TA((1-R)/2)),n.$TA(4*t),this.$oA.$e()){const T=.75+$L(n.$u().$TA(2).$QA(r.$u().$TA(1)).$e(),3)/4;r.$xA(T)}r.$QA(n),r.$TA(min(r.$e(),this.$vB));var O,n=(this.$gB=r).$e(),a=new $8(...r);a.$TA(a.$e()*t);const I=$QA(this,a);this.$r.length&&!this.$r.find(t=>$e($y(t,I))<t.$SB)&&a.$xA(-.5);let h=$wA(this.x+a.x)+128,S=$wA(this.y+a.y)+128;if(s===h&&i===S||((O=world.$FA[S][h])&&O!==this&&(a.$xA(-.5),h=$wA(this.x+a.x)+128,S=$wA(this.y+a.y)+128),world.$FA[i][s]=null,world.$FA[S][h]=this),this.$QA(a),this.$sA+=a.$e(),this.$B=n*this.$nB,this.$8B=n?r.$u().$TA(1):this.$8B,this.$oA.$e()<.25&&r.$e()&&r.$xA(this.$hA()<1/8?0:$i(1-2*t,1)),0===r.$e()&&this.$6B()&&R&&(r.$xA(0),this.$sA=$wA(2*this.$sA)/2),this===$QB){const T=$nA(this.$sA/.25);T>this.$fB&&$CA("rattle",this.$8B.x/-2),this.$fB=T}this.$qB=this.$3B()}},"$8"),({$x:E=512,$jA:A=[]}={})=>{const s=$aA(E),T=E/2,i=E/12,e={R:T,$x:E,$jA:A,$z:(t=s)=>(t.$B(()=>{let e=5.6*i;t===s&&t.E().center(),t.P().A(0,0,T).C().F(t.$F(0,2*i,4*i,0,0,E,["#242","#262"])),s.P().A(0,0,e),$WB(28,t=>{var[t,E]=$n([1,0],$uA[28]*(t-.5)-$uA[4]);s.M(t*e,E*e).L(t*T,E*T)}),s.W(s.$F(0,2*i,3*i,0,0,E,["#3536","#4846"]),2),$WB(13,t=>{let E=0,e=(t-11)*i*2.25;var T;t<10&&(T=$uA[10]*(t-2),[E,e]=$n([4.5*i,0],T)),s.P().A(E,e,i).C().F("rgba(127,127,127,0.25)"),A[t]&&s.P().A(E,e,i).C().F("#aa9")})}),e),add(t){return A.push(t),e.$z(),e},get $c(){return s.$2}};return e.$z(),e}),$sB=new Map,$mA=($NA("$PB",[["$gA",()=>`hwb(${$wA(30+10*rand.$t()-2)} ${$wA(0+10*rand())}% ${$wA(47+10*rand())}%)`],["$XB",()=>`hwb(${$wA(30+2*rand.$t()-2)} 0% ${$wA(67+4*rand())}%)`]],{$VA(t,E,e,T,A){var s,i,n,r,R,O,[t,E,e,T,A]=[$a(t,4),$a(E,64),e,T,$a(A[0],4)],T=[t,E,e,T,A].join();return $sB.has(T)||(s=$DA(E)/8,i=t?t/8:$DA(E)/16,n=$lA(E)/8,abs(t/16),[E,r]=[t?$bA(E):[0,0],t?$bA(1-E):[0,0]],[[E,r],[R,O]]=[E,r],A=sqrt(abs(A)/(abs(t)||1)),$sB.set(T,$VA().A(0+i*A,n-3,1,$HB[4],$HB).M(0+i*A,n-2).L(2+R/3,s*e-1.5).L(1+E/16,s*e-1).L(1+E*A,r).L(0,n-1).L(-1-R*A,O).L(R/16-1,-1-s*e).L(-2-E/3,-1.5-s*e).C())),$sB.get(T)},$z(i,n=bar%.5*2,r=!0){i.$B(()=>{r&&this.$YA(i);var t=this.$6B()%.5,t=t?$L(t%.5,.5):1-n,E=this["$B"];let e=E?E/8:$DA(t)/16,T=$lA(t)/8,A=abs(E/16);const s=sqrt(abs(this.$gB[0])/(abs(E)||1));this.shell&&0<this.$yB&&i.P().A(0-e*s/2,-1.75-T/2+A,7/8).C().W("#242",1/16).F("#131");E=this.$VA(this.$B,t,this.$nB,this.$yB,this.$gB);i.$V(this.$XB,1/8,E).$C(this.$gA,E),this.shell&&(this.$yB<0||$OB)&&i.$B(()=>{i.P().A(0-e*s/2,-1.75-T/2+A,7/8).C(),i.W("#242",1/16),i.T(0-e*s/2,-1.75-T/2+A),i.R(this.$gB[0]/16),i.$c(shell.$c,-1,-1,2,2)})})},$BB(){var t,E,e,T;this.$iB?.length||(t=$q%576,t=$q-t,E=this.$r[0],e=$y(E,this),T=$e(e),this.$iB=[$l(new $8A,{$q:16+t+rand.$d(16),$YB:$QA($TA(e,-2),E)}),$l(new $8A,{$q:64+t+rand.$d(16),$YB:this.$j()}),$l(new $8A,{$q:288+t+rand.$d(16),$YB:$QA($xA(e,(T-2)/T),this)}),$l(new $8A,{$q:416+t+rand.$d(16),$YB:this.$j()}),$l(new $8A,{$q:575+t})].filter(t=>t.$q>=$q))}},"$Y"),$NA("$w",[],{$z(s){s.$B(()=>{this.$YA(s),s.S(this.$nB,1);var t=this.$B,[E,e]=t?$bA(this.$hA()):[0,0],[T,A]=t?$bA(1-this.$hA()):[0,0],[[T,A],[E,e]]=0<this.$nB?[[E,e],[T,A]]:[[T,A],[E,e]],t=sqrt(abs(this.$gB[0])/(abs(t)||1));s.P().M(1,A/4-2).L(0-E*t,0+e).L(0,A/4-1).C().M(-1,e/4-1).L(T*t-1,0+A).L(-2,e/4-1.5).C().F("#520"),s.P().M(1,A/4-3).L(2,A/4-2).L(1,A/4-2).L(1+T*t,0+A).L(0,A/4-1).L(-1,e/4-1).L(-2-E*t,0+e).L(-2,e/4-1.5).L(-1.75,e/4-1.75).L(-2,e/4-2).L(0,A/4-2).L(.5,A/4-2.5).L(0,A/4-3).C().W("#620",1/8).F("#840"),s.P().A(1,A/4-4,1,$uA[2],1,!0).W("#620",.125)})}},"$Y"),$NA("$eA",[],{$z(s,t,E,e){s.$B(()=>{this.$YA(s),s.S(this.$nB,1);var t=this.$B,[E,e]=t?$bA(this.$hA()):[0,0],[T,A]=t?$bA(1-this.$hA()):[0,0],[[T,A],[E,e]]=0<this.$nB?[[E,e],[T,A]]:[[T,A],[E,e]],t=sqrt(abs(this.$gB[0])/(abs(t)||1));s.P().M(1,A/4-2).L(0-E*t,0+e).L(0,A/4-1).C().M(-1,e/4-1).L(T*t-1,0+A).L(-2,e/4-1.5).C().F("#520"),s.P().M(2,A/4-2).L(2,A/4-1).L(1.5,A/4-.5).L(1,A/4-1).L(1+T*t,0+A).L(0,A/4-1).L(-1,e/4-1).L(-2-E*t,0+e).L(-2,e/4-1.5).L(-1.75,e/4-1.75).L(-2,e/4-2).L(0,A/4-3).L(1,A/4-2.25).L(1.5,A/4-2.5).C().stroke("#620",1/8).F("#840"),s.P().A(2,A/4-2.25,.75,$uA[2],$uA[2]+$uA[7]).stroke("#620",.125)})}},"$Y"),$NA("$PA",[["$tA",0],["$SB",32],["$gA","#ccf"],["$XB","#ccf4"]],{$z(i){i.$B(()=>{var t,E,{$tA:e,$SB:T}=this,A=T-1,s=1.3*T;e&&(t=$0B(cos($uA[28]*e)*s),E=e<14?t:-s,e=14<e?-t:s,i.P().M(0,A).B(e,T,e,-T,0,-A).B(E,-T,E,T,0,A).C().F(this.$gA)),i.P().A(0,0,A).C().W(this.$XB,T/16)})},$pA(){return abs(sin($uA[2]*this.$tA/28))}},"$8"),$NA("$r",[["$gA",()=>`hwb(${120+rand.$d(25)} ${10+rand.$d(5)}% ${$wA(65+rand.$d(5))}%)`],["$SB",16],["$RB",[]],["$cB",[]],["$pB",[]],["$9B",0],["$iA",null]],{$dB(E=16){this.$SB=E;rand();return this.$RB=$WB(16,t=>new $8(0,-E,0).$n($uA[16]*(t+rand()/4))),this},$ZB(E){var t=this.$SB+1,[e]=new $8(-t,-t,0).$QA(this).$3B(),[t]=new $8(t,-t,0).$QA(this).$3B();this.$9B=t<=0||e>=$R.$S?0:1,$AA(this.$pB,t=>t.$ZB(E))},$z(n){if(this.$9B)return n.$B(()=>{let i=0,t=new $8;var E=$g(this.$RB,(e,T)=>{t.splice(0,t.length,...e);var[e,A,s]=t.$QA(this).$zB();if(s){i=max(i,s);let t=e*s,E=A*s;return()=>(T?n.L:n.M)(t,E)}return()=>{}});n.P(),$AA(E,t=>t()),n.C().O(.25).F(this.$gA).W(this.$gA,2/32),n.P(`M ${$a(l)} ${$a(u)} L ${$a(r)} ${$a(u)} W #0f0 4`)}),n.$2}},"$8"),$NA("$cA",[["$R",null]],{$z(t){return this.$R||(this.$R=$VB({$DB:64,$LB:64}).P().M(...rand.$W(1,28)).L(...rand.$W(24,24)).L(...rand.$W(21,12)).L(...rand.$W(31,11)).L(...rand.$W(33,23)).L(...rand.$W(47,14)).L(...rand.$W(53,21)).L(...rand.$W(61,31)).L(...rand.$W(52,44)).L(...rand.$W(42,47)).L(...rand.$W(43,43)).L(...rand.$W(39,48)).L(...rand.$W(16,57)).L(...rand.$W(9,54)).L(...rand.$W(3,42)).C().F(rand.$b(15,2,17,2,68,4))),t.$c(this.$R.$2,0,0,64,64),t}},"$8"),$NA("$XA",[["$VA",""],["$R",null],["$DB",0],["$LB",0],["$SA",0],["$gA",()=>rand.$b(150,2,10,6,80,4)]],{$dB(t){return this.$2A=rand.$B(this.$2A,()=>{const s=min(8,this.$Z=t||this.$Z||4*rand()+3),i=ceil(s);let n=0,r=0,R=0;this.$VA=$WB(i,t=>{var E=(s-t)/(s-t+3),e=n-E/.125,T=E*(i-t),A=n+E+.5,t=$L(s-t,i),E=$a(rand.$t()*t*E/2),T=(r=max(T,r),`M ${E} ${$a(e)} L ${$a(-T)} ${$a(A)-rand()*t} L ${$a(R)} ${$a(n+.25)} L ${$a(T)} ${$a(A)-rand()*t} L ${E} `+$a(e));return R=E,n=e,T}).join(" ")+` F ${this.$gA} S #1218`,this.$DB=ceil(2*r),this.$LB=ceil(abs(n)),this.$R=$VB({$DB:this.$DB*$m*4,$LB:this.$LB*$m*4,os:!0}),this.$R.$B(t=>t.S($m,$m).T(this.$DB/2,this.$LB).P(this.$VA))}),this},$z(t){if(this.$R)return t.$B(()=>{this.$YA(t),t.$c(this.$R.$2,-this.$DB/2,-this.$LB,4*this.$DB,4*this.$LB)}),this},$ZB(t){this.$SA=this.$SA||4+rand.$d(284),$q>=this.$SA&&(this.$dB(this.$Z+(rand()+1)/8),this.$SA=$q+576)},$1(t){return 2<this.$Z&&this.$y(t).$e()<=4},$eB(t){console.log("$XA $eB");var E=$l(new $cA);t.$oB.push(E),this.$dB(--this.$Z),$CA("beat")}},"$8"),$NA("$KB",[["$R",null],["$tA",0],["$gA",()=>rand.$b(180,4,33,3,55,4)],["$KA",-1],["$DB",4],["$LB",4],["$fA",!1]],{$dB(){const e=this.$fA,T=(this.$R=this.$R??$aA(this.$DB*$m*4,this.$LB*$m*4),rand.$t()/4);var t=e?-2:-1.5;const A=rand()/8,s=t+A;return this.$R.$B(t=>{var E;t.E().S($m,$m).T(this.$DB/2,this.$LB).P().M(-1.5-T,0).B(-2.5,-3,-1,-3,T,A-2).B(1,-3,2.5,-3,1.5+T,0).C().F(this.$gA).P().M(0,0).B(2*-T,-A,4*T,s,T,s).W("#0002",1/8),t.P().A(T,s,e?.75:1/8).F(`hwb(${$wA((180/28*this.$tA+240+rand.$t()/4)%360)} ${$wA(10+25*rand())}% 5%)`),this.$fA&&(E=$l(new $PA,{$SB:10,$tA:this.$tA,$gA:"#ccf",$XB:"#000a"}),t.O(.5).T(1.25*T,s).S(1/16,1/16),E.$z(t))}),this},$z(t,E){if(this.$R)return E?t.$c(this.$R.$2,0,0,256,256):t.$B(()=>{this.$YA(t),t.$c(this.$R.$2,-this.$DB/2,-this.$LB,4*this.$DB,4*this.$LB)}),t},$ZB(t,E,e){var E=E??moon?.$tA,e=e??$GA;return E!==this.$KA&&.5<=e&&(e=((this.$KA=E)+28-this.$tA)%28<3,this.$fA=e,this.$dB()),this},$1(t){return this.$fA&&this.$y(t).$e()<=2},$eB(t){console.log("$KB $eB");var E=$l(this.$u(),{$R:null});t.$oB.push(E.$dB()),this.$fA=!1,this.$dB(),$CA("aah")}},"$8"),new Map),$R=($NA("$EA",[["$f",()=>new $cA],["O",()=>rand()]],{$z(A,t){A.$B(()=>{this.$YA(A);var t,E,e,T=$a((this.O+bar%.5*2)%1,64);A.$B(()=>A.T(-1.5,-2.125).S(1/32,1/32).$z(this.$f)),A.$B(()=>A.T(1.5,-2).S(-1/32,1/32).$z(this.$f)),$mA.has(T)||(t=$aA(128,256),E=$DA(T),e=$DA((T+.25)%1),t.S(64,64).T(1,4).P().M(1,-1.5).A(0,-1.5,1,0,$uA[2]).B(-1,-2.5-e/2,0+E,-2.5-e,0-E/2,-3.5).B(0-E,-2.5-e,1,-2.5-e/2,1,-1.5).F(A.$F(0,-1.25,.5+e/8,0,0,4-e/4,["#ff0a","#e206","#d004"])),$mA.set(T,t)),A.$c($mA.get(T).$2,-1,-4,2,4)})}},"$8"),$NA("$EB",[["$2A",13],["$Z",0],["$qA",[]],["$jA",[]],["$JB",[]],["$FA",()=>$WB(256,t=>$WB(256,t=>null))],["$dA",[]],["$g",null],["$nA",null],["$7B",[]],["$cB",[]],["$pB",[]],["$xB",[]]],{$dB(t){this.$g=this.$g||$VB({$DB:256,$LB:256,os:!0}),this.$nA=this.$nA||$VB({$DB:256,$LB:256,os:!0}),this.$2A=t,rand.$2A(t);this.$qA=$WB(28,t=>(new $r).$dB(12).$QA([96,0,0]).$n(t*$uA[28]-$uA[4])),this.$jA=$WB(13,t=>t<10?(new $r).$dB(18).$QA([80,0,0]).$n($uA[10]*(t+2.5)):(new $r).$dB(18).$QA([0,16*(t-11)*2.5,0])),this.$dA=[...this.$qA,...this.$jA],$AA(this.$qA,(e,t)=>{e.$RA="moon "+t,$AA(e.$RB,E=>{var t;this.$dA.filter(t=>E.$u().$QA(e).$y(t).$e()<=t.$SB+.05).length<2&&((t=(new $XA).$dB().$QA(e).$QA(E)).$r.push(e),e.$pB.push(t),this.$pB.push(t))});t=$l(new $KB,{x:e.x,y:e.y,$tA:t}).$ZB(0,0,.5);e.$pB.push(t),this.$pB.push(t)}),$AA(this.$jA,(E,t)=>{E.$cB.push((new $EA).$QA(E)),$WB(3,t=>{t=(new $PB).$QA(new $8(0,10+rand.$d(2),0).$n($uA[3]*(t+rand.$t()/8)).$QA(E));E.$cB.push(t),t.$r.push(E)})}),this.$cB.push(...$g(this.$dA,t=>t.$cB).flat().sort($tB)),this.$g.$B(T=>{T.E().center(),$AA(this.$dA,e=>{T.P(),$AA(e.$RB,(t,E)=>(E?T.L:T.M)(t[0]+e.x,t[1]+e.y)),T.C().F(T.$F(0,90,90,0,0,256,["#242","#262"])).O(.25).W(T.$F(0,184,276,0,0,256,["#353","#484"]),1).O(1)})}),this.$nA.P().A(128,128,108).W("#202",16).C().P().A(128,112,48).F(this.$nA.$F(128,128,32,128,128,256,["hwb(250deg 14% 57%)","hwb(220deg 65% 12%)"])),this.$nA.$c(this.$g.$2,0,0,256,256);const e=$l(new $PA,{$SB:10});return $AA(this.$qA,(E,t)=>{$l(e,{$tA:t}),this.$nA.$B(t=>{t.T(128+E.x,128+E.y).O(.875).P().A(0,0,E.$SB).F(E.$gA).O(.125),e.$z(t)})}),this.$nA.$B(t=>{t.center(),$AA(this.$pB.filter(t=>!(t instanceof $KB)),t=>this.$nA.P().A(t.x,t.y+.5,1.25).F(t.$gA))}),$AA([...this.$cB,...this.$pB,$QB],t=>{t.y=$1B(t.y),t.x=$1B(t.x),this.$FA[t.y+128][t.x+128]=t}),this},$1A(){},$LA(){},$ZB(E){return $QB.$r=this.$dA.filter(t=>$e($y(t,$QB))<t.$SB),$AA(this.$dA,t=>t.$ZB(E)),this},$z(E){this.$xB.length=0;var e=-E.$T/$m,T=E.$S/$m;for(let t=0;t<=256&&!(t>$GB.y+132);t+=1){var A=new $8($GB.x,t-128,0).$3B(0),s=A[2];if(0===s)break;var i=s*$m*2,n=max(0,$nA($GB.x+128-E.$T/i)-4);min(256-n,ceil(E.$S/i)+8);E.$c(this.$nA.$2,$GB.x+128-E.$T/i,t,E.$S/i,1,e,(A[1]-E.$I)/$m,T,2*s),$AA($5A(this.$FA[t].filter(t=>t),$tB),t=>{t.$z(E),t.$1?.($QB)&&this.$xB.unshift(t)})}return E.$2}},"$8"),$VB());let moon=new $PA,sun=$p(32,"#ffd"),rand=$vA(13),stars=$WB(91,()=>[rand.$t(),rand.$t()]),shell=$yA(),$QB=$l(new $PB,{x:0,y:104,z:0,shell:shell,$yB:-1,$gA:"#840",$XB:"#620"}),$rA=new $8,world=($rA.$VA=$VA().M(-2,-2).L(2,2).L(-2,2).L(2,-2).C(),(new $EB).$dB(13)),entities=[],$rB=20,$aB=-2,$wB=4,$lB=-1/8,$GB=new $8($QB.x,$QB.y+$wB,$QB.z+$lB);const $9A=E=>{$OB||(D+=E*$ZA,$v=$nA(D/$3),$GA=D%$3/$3,measure=$nA(D/4e3),bar=D%4e3/4e3,beat=$nA(8*bar),$q=$nA(D/250),$KA!==$q&&$CA("tick"),$KA=$q,step=D%$0/$0,$JA.change&&$QB.$iB.unshift($l(new $8A,{$q:$q,$2B:$JA.$QA})),$JA.shift?$QB.$vB=4:$QB.$vB=2,world.$ZB(E),$QB.$ZB(E),$AA(world.$cB,t=>t.$BB?.()),$AA(world.$cB,t=>t.$ZB?.(E))),$GB.x+=($QB.x-$GB.x)/16,$GB.y+=($QB.y+($OB?$wB:$rB)-$GB.y)/16,$GB.z+=($QB.z-$GB.z+($OB?$lB:$aB))/16};let $OA=$WB(256,t=>[t,t]).flat().map(t=>t/$m);const $MA=(t=0)=>{performance.now();var E=t-now;now=t,$9A(E*$ZA);const{$H:e,$I:n,$J:T,$S:A,$T:r,$U:s,$O:R,$P:O}=$R;var t=$GA,E=t;const a=(t+.5)%1;moon.$tA=D?$nA((28+(D-$jB()*$3)/$3)%28):0;let I=$5B(E)*s;const h=$hB(E);let S=$5B(a)*s;const P=$hB(a);.5<t?I=-S:S=-I;let L;$R.$B(()=>{if($R.E(),$R.ctx.fillStyle=.1<h?"#840":"#202",$R.ctx.fillRect(0,0,A,e),$R.center(),.25<P){const i=T-P*T*2;$AA(stars,([t,E])=>{var e=t*r,T=(E-a)*n,A=$L($e([S,i],[e,T]),4*moon.$SB),s=1+.5*sin((7.3*E+now%$3/$3+1.1*t)*$HB),E=(1+s)**2*max(0,sin(7.3*E+now/$3*130+11*t)**3);$R.O(max(0,1-moon.$pA()/2-(A<.25?1:1-A))).P().A(e,T,s).F("#ffd").C(),$R.P().M(e,T-E).L(e,T+E).M(e-E,T).L(e+E,T).W("#ffd",.5)}),L=`rgba(204,204,255,${$a(.1*moon.$pA())})`,$R.O(max(0,P)).P().A(S,i,2*O).C().F($R.$F(S,i,R*moon.$pA(),S,i,2*R,[`rgba(204,204,255,${$a(.05+.2*moon.$pA())})`,L,L,"rgba(24,0,24,0)"])).T(S,i),moon.$z($R),L="#ccf6"}.25<h&&($R.O(max(0,h)),L="#aae6",$R.P().A(I,T-h*T*2,2*O).C().F($R.$F(I,T-h*T*2,sun.R*max(h,0),I,T-h*T*2,O,["#fff","#aae","#aaec","rgba(170,170,238,0)"])).$c(sun.$c,I-sun.R,T-h*T*2-sun.R,sun.D,sun.D))}),$R.$B(()=>{$R.T(r,n),$R.S($m,$m),world.$z($R)}),$R.$B(()=>$R.T($rA.x-2,$rA.y-2).S(4,4).R($HB*$DA(now%4e3/4e3)).$C("#2808",$rA.$VA)),$rA.$YB=$OB?null:world.$xB.find(t=>$R.ctx.isPointInPath(t.$mB(),$rA.x,$rA.y)),$rA.$YB&&$R.$B(()=>{var t=$rA.$YB.$mB();$R.ctx.setLineDash([13,7]),$R.ctx.lineDashOffset=now/1e3*20,$R.$V("#280",1,t)});const i=$QB.$oB.length;$AA($QB.$oB,(E,t)=>{const e=($R.$S-128)/(i+1)*(t+1)+64,T=$R.$H-128;$R.$B(t=>E.$z(t.T(e,T).P().$Q(0,0,64,64,4).C().F("#fff4"),!0))}),$A||($R.ctx.fillStyle="#0f0",$R.ctx.font="32px monospace",E="Click to begin",$R.ctx.fillText(E,$R.$T-$R.ctx.measureText(E).width/2,$R.$J)),requestAnimationFrame($MA)},$JA=($MA(0),{w:0,a:0,s:0,d:0,get change(){return this.w+this.a+this.s+this.d},get $QA(){var{w:t,a:E,s:e,d:T}=this;return{w:t,a:E,s:e,d:T}}}),$MB=($UA("mousedown",()=>{$OB=!1,$A=$zA()}),$N("click",()=>$rA.$YB?.$eB($QB)),$N("keydown",t=>{$CA("input");t=t.key.toLowerCase();$JA[t]=1,$CA("key-"+t),"escape"===t&&($OB=!$OB,$CA("pause"))}),$N("keyup",t=>$JA[t.key.toLowerCase()]=0),$N("mousedown",()=>$CA("input")),$N("mousemove",({clientX:t,clientY:E})=>$l($rA,{x:t,y:E})),$N("resize",()=>{$R.$UB(min(1920,window.innerWidth),min(1080,window.innerHeight))}),$AA(["visibilitychange","blur"],t=>$N(t,()=>{$AA(Object.keys($JA),t=>$JA[t]=0)})),(t,E,e)=>t.addEventListener(E,e));$AA(["mousedown","mouseup","mousemove","click","keydown","keyup","visibilitychange"],E=>$MB(document,E,(...t)=>$CA(E,...t))),$AA(["resize","blur"],E=>$MB(window,E,(...t)=>$CA(E,...t))),document.body.appendChild($R.$0A);})()</script></body>