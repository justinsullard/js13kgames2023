<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>13 Drums</title><style>html,body{padding:0;margin:0;width:100%;height:100%;background:#202;cursor:none}canvas{width:100%;height:100%}</style><body><script>(()=>{let now=0,$9F=500,$91=144e3,D=0,$92=0,$6B=0,$13=0,$62=0,measure=0,beat=0,bar=0,step=0,$48=!0,$35=1,$39=32;const{cos,sin,min,max,sqrt,pow,floor,ceil,round,imul,abs,PI,sign,atan2}=Math,$1B=(t=0,E=t=>t)=>new Array(t).fill(0).map((t,E)=>E).map(E),$2E=([t,E],e)=>[t*cos(e)-E*sin(e),t*sin(e)+E*cos(e)],$52=([t,E,e],[s,i,n])=>[t+s,E+i,e+n],$8C=([t,E,e],[s,i,n])=>[t-s,E-i,e-n],$79=(t,E=1e3)=>round(t*E)/E,$4E=(t,E)=>t<E?t/E:1,$40=(t,E)=>max(0,$4E(t,E)),$68=(t,E,e)=>E<t&&t<e,$23=(t,E=(t,E)=>t-E)=>t.sort(E),$4F=([t,E],e=1)=>{e/=$60([t,E])||1;return[t*e,E*e]},$60=([t,E],[e=0,s=0]=[])=>sqrt((e-t)**2+(s-E)**2),$1=t=>(0<t?floor:ceil)(t),$2=t=>(t<0?floor:ceil)(t),$0=t=>sign(t)*round(abs(t)),$98=2*PI,$42=$1B(128,t=>t?$98/t:0),$3A=(...t)=>Object.assign(...t),$86=(t,E)=>t.forEach?.(E),$59=(t,E)=>t.map(E),$29=(t,E)=>t.y-E.y||t.z-E.z||t.x-E.x,$7B=t=>1+2.70158*(t-1)**3+1.70158*(t-1)**2,$82=t=>t*t*(2.70158*t-1.70158),$80=t=>1-cos(t*PI/2),$81=t=>-(cos(PI*t)-1)/2,$83=t=>sin(t*PI),$7A=t=>sin(t*$98),$85=2.5949095,$84=$98/4.5,$26=()=>min(500/$91,.05),$30=t=>{let E=max(0,sin(t*$98)),e=$26();return e<t&&t<=2*e?E+=2*$7B((t-e)/e):2*e<t&&t<.5?E+=2:.5<=t&&t<.5+e&&(E+=2-2*$82((t-.5)/e)),E/3},$25=t=>2*$81($4E(t,.5))-1,$5F=(t,E,e)=>E+(E-e)*t,_WALK=t=>[(min(2*t,0)-(1-cos(t*$98)))/2,-$80(-min(sin(t*$98),0))/2],$7=t=>_WALK(t),$36=(t=0)=>{let E=0|t;return let=fn=()=>{var t=(E=E+2654435769|0)^E>>>16,t=imul(t,569420461);return t^=t>>>15,(((t=imul(t,1935289751))^t>>15)>>>0)/4294967296*2},$3A(fn,{seed:t=>void 0!==t?E=0|t:E,$66:(t=1)=>round(fn()*t),$A1:()=>1-2*fn(),sign:()=>$2(fn.$A1()),bit:()=>round(fn()),bool:()=>!!round(fn()),shuffle:t=>t.slice().sort(fn.$A1),pick:t=>t[$1(fn()*t.length)]})},$17=new Map,$18=t=>($17.has(t)||$17.set(t,new Set),$17.get(t)),$4C=(t,E)=>$18(t).add(E),$4D=(t,E)=>$18(t).delete(E),$7F=(t,...E)=>$86([...$18(t)],t=>t(...E)),$4B=(E,e)=>{let s=(...t)=>{$4D(E,s),e(...t)};$4C(E,s)};let $8A=0;const Q=[32.7,36.71,41.2,43.65,49,55,61.74,65.41,73.42,87.31,98,110,130.81,174.61,196].map(t=>2*t),$11=32/27,$24=(t=0,E=0,e=16)=>{let s=t?e/t:0;return $23($1B(t,t=>floor(t*s+E+e)%e))},$21=()=>{let e=Q.slice(1,-1);return[[Q[0],.4,0,[0,3,8,11,14]],...$1B(13,t=>{let E=rand.pick(e);return e=e.filter(t=>t!==E),[E,.2*rand(),rand.$A1(),$24(1+rand.$66(),rand.$66(15))]})]},$58=()=>[Q[0],...rand.shuffle(Q.slice(1,9))].slice(0,8).map(t=>2*t),$A8=(t,e,E,s,i,n=6)=>{const A=t.createOscillator();var T=t.createGain(),r=t.createStereoPanner();A.frequency.setValueAtTime(E/$11,i),$86($24(n,2),(t,E)=>A.frequency.exponentialRampToValueAtTime(E%2?e*$11:e/$11,i+E/8)),T.gain.setValueAtTime(.1*E,i),T.gain.exponentialRampToValueAtTime(.5*E,i),T.gain.exponentialRampToValueAtTime(E,i+.325),T.gain.exponentialRampToValueAtTime(.01,i+2),r.pan.setValueAtTime(s,i),r.pan.exponentialRampToValueAtTime(-s,i+2),A.connect(T),T.connect(r),r.connect(t.destination),A.start(i),A.stop(i+2)},$A2=(t,E,e,s,i,n,A)=>{var T=t.createOscillator(),r=t.createGain(),a=t.createStereoPanner(),R=t.createDynamicsCompressor(),n=n||e;T.frequency.setValueAtTime(E,i),T.frequency.exponentialRampToValueAtTime(E/1.5,i+.5),r.gain.setValueAtTime(.1,i),r.gain.exponentialRampToValueAtTime(n,i+1/32),r.gain.exponentialRampToValueAtTime(n/5,i+.1/16),r.gain.linearRampToValueAtTime(0,i+.5),a.pan.setValueAtTime(A??s,i),R.threshold.setValueAtTime(-50,i),R.knee.setValueAtTime(40,i),R.ratio.setValueAtTime(12,i),R.attack.setValueAtTime(0,i),R.release.setValueAtTime(.25,i),T.connect(r),r.connect(a),a.connect(R),R.connect(t.destination),T.start(i),T.stop(i+.51)},$34=(t,E,e=0,s)=>{var i=.05+.03*rand(),n=1/8+rand()/16,A=t.createOscillator(),T=t.createGain(),r=t.createStereoPanner();A.type="triangle",A.frequency.setValueAtTime(E,s),T.gain.setValueAtTime(i/2,s),T.gain.exponentialRampToValueAtTime(i,s+n/2),T.gain.exponentialRampToValueAtTime(.01,s+n),r.pan.setValueAtTime(e,s),A.connect(T),T.connect(r),r.connect(t.destination),A.start(s),A.stop(s+n)},$22=()=>{let n=new AudioContext,t=-$79(D/4e3,10)%1,A=t,e=[0],T=[],s=[];var E=(t,E)=>{T=t||$21(),s=E||$58()},i=()=>{n.currentTime+.25<A||A<0||($A8(n,s[0]||2*Q[rand.$66(6)],.3,.5*rand.$A1(),A,floor(A-t)%3+4),s.push(s.shift()),$86(e,t=>{const[E,e,s,i]=T[t];$86(i,t=>$A2(n,E,e,s,.25*t+A))}),A+=4)};return setInterval(i,100),$4C("rattle",(t=0)=>{$34(n,($10%2?rand.pick(s.slice(0,3)):s[7-(beat+measure%8)%8])||Q[0],"number"==typeof t?t:0,n.currentTime)}),$4C("beat",()=>{var[,t,E,,]=T[0];$A2(n,Q[14],t,E,n.currentTime)}),$4C("pause",()=>{"running"===n.state&&$48?n.suspend():"suspended"!==n.state||$48||n.resume()}),E(),i(),{fresh:E,n:A,get track(){return T},get voices(){return e},get melody(){return s},sing:(t=[],E)=>{e=[0,...t],s=E||s}}},$49=($2A=({$6:t=window.innerWidth,$6C:E=window.innerHeight,os:s=!1}={})=>{let i=s?null:document.createElement("canvas"),n=(i&&(i.width=t,i.height=E),s?new OffscreenCanvas(t,E):i.transferControlToOffscreen()),T=n.getContext("2d");n.width=t,n.height=E;const r={get $A(){return n.width},get $9(){return n.width/2},get $8(){return n.width/3},get $6F(){return n.height},$6E:n.height/2,get $6D(){return n.height/3},get $38(){return min(r.$6D,r.$8)},get Rm(){return min(r.$6F,r.$A)},get $2F(){return max(r.$6F,r.$A)},$94:n,$33:i,ctx:T,$31:(t,E)=>{var e;s||(e=document.createElement("canvas"),i.replaceWith(e),(i=e).width=t,e.height=E,n=i.transferControlToOffscreen(),T=n.getContext("2d"),$3A(r,{$94:n,ctx:T,$33:i})),n.width=t,n.height=E,r.$6E=n.height/2},$89:t=>(T.save(),t(r),T.restore(),r),E:()=>(T.clearRect(0,0,r.$A,r.$6F),r),center:()=>(r.T(r.$9,r.$6E),r),$75:(t="none")=>(T.filter=t,r),T:(t,E)=>(T.translate(t,E),r),R:(t,E)=>(T.rotate(t,E),r),M:(...t)=>(T.moveTo(...t),r),L:(...t)=>(T.lineTo(...t),r),A:(t=0,E=0,e=1,s=0,i=$42[1],n=!1)=>(T.arc(t,E,e,s,i,n),r),B:(...t)=>(T.bezierCurveTo(...t),r),P:t=>(T.beginPath(),t?.match(/[MLABCTREOSFW](?:\s*-?\d+(?:\.\d+)?|\s*#[a-f0-9]{3,8}|\s*hwb\([^)]+?\))*/g).forEach(t=>{var[t,...E]=t.includes("(")?[t[0],t.slice(1).trim()]:t.split(" ");r[t](...$59(E,t=>"#"===t[0]||t.includes("(")?t:parseFloat(t,10)))}),r),C:()=>(T.closePath(),r),O:t=>(T.globalAlpha=t,r),S:(t=1,E=1)=>(T.scale(t,E),r),$70:(e,s)=>$86(s,(t,E)=>e.addColorStop(E/s.length,t)),$73:(t,E,e,s,i)=>{t=T.createLinearGradient(t,E,e,s);return r.$70(t,i),t},$72:(t,E,e,s,i,n,A)=>{t=T.createRadialGradient(t,E,e,s,i,n);return r.$70(t,A),t},F:t=>(T.fillStyle=t,T.fill(),r),$76:(t,E)=>(T.fillStyle=t,T.fill(E),r),W:(t,E)=>(T.strokeStyle=t,T.lineWidth=E,T.stroke(),r),$4:(t,E,e)=>(T.strokeStyle=t,T.lineWidth=E,T.stroke(e),r),$69:(...t)=>T.drawImage(...t)};return r.E(),r},()=>{const A=new Path2D;return A.M=(...t)=>(A.moveTo(...t),A),A.L=(...t)=>(A.lineTo(...t),A),A.A=(t=0,E=0,e=1,s=0,i=$42[1],n=!1)=>(A.arc(t,E,e,s,i,n),A),A.$A3=(...t)=>(A.arcTo(...t),A),A.B=(...t)=>(A.bezierCurveTo(...t),A),A.Q=(...t)=>(A.quadraticBezierCurveTo(...t),A),A.C=()=>(A.closePath(),A),A}),$F=(t,E)=>$2A({$6:t,$6C:E||t,os:!0}),$16=(t=32,E="#840")=>{const e=$F(3*t),s=t/4,i=1.4*t;return e.$89(()=>{e.E().center().P().A(0,0,t).C().F(E).P().M(-i,-s).L(i,-s).M(-i,s).L(i,s).M(-s,-i).L(-s,i).M(s,-i).L(s,i).W(E,3)}),{R:1.5*t,D:3*t,get $69(){return e.$94}}},$5A=(Array.$8E=()=>[],(a,d,m={},p="$7D")=>{const dd=window[p].$8E?.()??[],o=dd.length,dv=$59(d,([,t])=>"function"==typeof t?t.toString().replace(/^\(\) ?=> ?/,""):JSON.stringify(t)).join(","),e=`window.${a}=class ${a} extends ${p}{`+`static $8E=()=>[...${p}.$8E(),${dv}];`+`constructor(...x){super(...(x.length ? x : ${a}.$8E()))}`+"*[Symbol.iterator]() {for(let i = 0,l=this.length;i<l;i++){yield this[i]}}"+$59(d,([t],E)=>`  get ${t}(){return this[${E+o}]} set ${t}(x){return this[${E+o}]=x}`).join("")+$59(Object.values(m),t=>t.toString()).join("")+"};";return eval(e)}),$3=$1B(1280,t=>4/((t+1)/10)*5).reduce((t,E,e)=>t.set((e+1)/10,E),new Map),$6A=($5A("$7D",[["x",0],["y",0],["z",0],["age",0],["$A5",[]],["$32",[]]],{$95(){return new this.constructor(...this)},$52(t){return[this.x,this.y,this.z]=$52(this,t),this},$2E(t){return[this.x,this.y]=$2E(this,t),this},$8C(t){return new $7D(...$8C(this,t))},$3E(){return $59([this.x,this.y,this.z],round)},$4F(t=1){return[this.x,this.y]=$4F([this.x,this.y],t),this},$2C(t=1){return this.$4F(this.$60()*t),this},$60(){return $60([this.x,this.y])},$3D(t){var[E,e,s]=this.$45();return t.S(s,s),t.T(E,e),this},$45(){var[t,E,e]=this.$8C($9E),s=E<0?4/-E*5:0;return[t*=4,E=4*e*s,s]},$3C(t=1){var[E,e,s]=this.$45(),i=(E*=s*$39,e*=s*$39,t?2*-$39*s:0);return new $7D(E+$D.$9,e+$D.$6E+i,2*s*(t?$39:1))},$97(){var[t,E,e]=this.$3C();return $49().A(t,E,abs(e)).C()},$C(t){},$12(){},$88(){}},"Array"),$5A("$14",[["$13",0],["$99",{}],["$15",null],["$1E",null],["$1C",null]],{},"Array"),{w:0,a:0,s:0,d:0}),$27=($5A("$A7",[["shell",null],["$20",0],["$51",0],["$8B",1],["$4A",1],["$56",()=>new $7D],["$67",()=>new $7D],["$E",()=>new $7D(1,1,0)],["$2B",[]],["w",0],["a",0],["s",0],["d",0],["$1F",2],["$65",[]],["$87",[]],["$61",0],["$3B",[0,0,0]]],{$7E(){return this.$20?abs(this.$20):0},$1D(){var t=this.$51%1;return t*=this.$56.$60?.()||$68(t,1/32,31/32)?1:0,(this.$8B<0?1-t:t)%1},$93(){return this.$1D()?$4E(this.$1D()%.5,.5)%1:1-bar%.5*2%1},$C(t){t/=1e3;this.$1D(),this.$7E();let{w:E,a:e,s,d:i}=this;var n=round(this.x)+128,A=round(this.y)+128,T=this.$2B.filter(t=>t.$13<=$13),T=(T.length?($86(T,t=>{var E,e;t.$1E=t.$1E||t.$13,t.$15?($60(this,t.$15),.5<t.$15.$95().$2C(-1).$52(this).$60()?(t.$13=$13,E=abs(this.x-t.$15.x),e=abs(this.y-t.$15.y),E=$4E(E,1)>3/8?1:0,e=$4E(e,1)>3/8?1:0,$3A(t.$99,this.x>t.$15.x?{a:E,d:0}:{a:0,d:E},this.y>t.$15.y?{w:e,s:0}:{w:0,s:e})):(t.$1C=t.$13,this.$2B.push(new $14($13+1,$6A,null),new $14($13+12,$6A,null)))):(t.$13=-1,t.$1C=$13),$3A(this,t.$99)}),T.length&&({w:E,a:e,s,d:i}=this),this.$2B=this.$2B.filter(t=>!t.$1C||t.$1C>$13)):$3A(this,{w:0,a:0,s:0,d:0}),this.$67=new $7D(-e+i,-E+s,0),this.$8B=sign(this.$67.x||this.$8B),this.$4A=sign(this.$67.y||this.$4A),new $7D(...this.$67)),r=new $7D(...this.$56),a=this.$93();if(0===T.$60()&&$68(r.$60(),1/16,a)&&T.$52(new $7D(...this.$E).$4F((1-a)/2)),T.$4F(4*t),this.$67.$60()){const s=.75+$4E(T.$95().$4F(2).$52(r.$95().$4F(1)).$60(),3)/4;r.$2C(s)}r.$52(T),r.$4F(min(r.$60(),this.$1F));var R,T=(this.$56=r).$60(),h=new $7D(...r);h.$4F(h.$60()*t);const P=$52(this,h);this.$A5.length&&!this.$A5.find(t=>$60($8C(t,P))<t.$37)&&h.$2C(-.5);let S=round(this.x+h.x)+128,I=round(this.y+h.y)+128;if(n===S&&A===I||((R=world.$71[I][S])&&R!==this&&(h.$2C(-.5),S=round(this.x+h.x)+128,I=round(this.y+h.y)+128),world.$71[A][n]=null,world.$71[I][S]=this),this.$52(h),this.$51+=h.$60(),this.$20=T*this.$8B,this.$E=T?r.$95().$4F(1):this.$E,this.$67.$60()<.25&&r.$60()&&r.$2C(this.$93()<1/8?0:$40(1-2*t,1)),0===r.$60()&&this.$1D()&&a&&(r.$2C(0),this.$51=round(2*this.$51)/2),this===$41){const s=floor(this.$51/.25);s>this.$61&&$7F("rattle",this.$E.x/-2),this.$61=s}this.$3B=this.$3C()},$12(){var t;this.$2B?.length||(t=this.$A5[0],this.$2B=[new $14($13,{},t.$95().$52(new $7D(0,2+rand.$66(t.$37-2),0).$2E(rand()*$98)))])}},"$7D"),({$8D:E=512,$87:i=[]}={})=>{const n=$F(E),s=E/2,A=E/12,e={R:s,$8D:E,$87:i,$88:(t=n)=>(t.$89(()=>{let e=5.6*A;t===n&&t.E().center(),t.P().A(0,0,s).C().F(t.$72(0,2*A,4*A,0,0,E,["#242","#262"])),n.P().A(0,0,e),$1B(28,t=>{var[t,E]=$2E([1,0],$42[28]*(t-.5)-$42[4]);n.M(t*e,E*e).L(t*s,E*s)}),n.W(n.$72(0,2*A,3*A,0,0,E,["#3536","#4846"]),2),$1B(13,t=>{let E=0,e=(t-11)*A*2.25;var s;t<10&&(s=$42[10]*(t-2),[E,e]=$2E([4.5*A,0],s)),n.P().A(E,e,A).C().F("rgba(127,127,127,0.25)"),i[t]&&n.P().A(E,e,A).C().F("#aa9")})}),t.$94),add(t){i.push(t),e.$88()},get $69(){return n.$94}};return e.$88(),e}),$46=new Map,$D=($5A("$47",[["$96",()=>`hwb(${round(30+10*rand.$A1()-2)} ${round(0+10*rand())}% ${round(47+10*rand())}%)`],["$19",()=>`hwb(${round(30+2*rand.$A1()-2)} 0% ${round(67+4*rand())}%)`]],{$49(t,E,e,s,i){var n,A,T,r,a,R,[t,E,e,s,i]=[$79(t,4),$79(E,64),e,s,$79(i[0],4)],s=[t,E,e,s,i].join();return $46.has(s)||(n=$7A(E)/8,A=t?t/8:$7A(E)/16,T=$83(E)/8,abs(t/16),[E,r]=[t?$7(E):[0,0],t?$7(1-E):[0,0]],[[E,r],[a,R]]=[E,r],i=sqrt(abs(i)/(abs(t)||1)),$46.set(s,$49().A(0+A*i,T-3,1,$98[4],$98).M(0+A*i,T-2).L(2+a/3,n*e-1.5).L(1+E/16,n*e-1).L(1+E*i,r).L(0,T-1).L(-1-a*i,R).L(a/16-1,-1-n*e).L(-2-E/3,-1.5-n*e).C())),$46.get(s)},$88(A,T=bar%.5*2,r=!0){A.$89(()=>{r&&this.$3D(A);var t=this.$1D()%.5,t=t?$4E(t%.5,.5):1-T,E=this["$20"];let e=E?E/8:$7A(t)/16,s=$83(t)/8,i=abs(E/16);const n=sqrt(abs(this.$56[0])/(abs(E)||1));this.shell&&0<this.$4A&&A.P().A(0-e*n/2,-1.75-s/2+i,7/8).C().W("#242",1/16).F("#131");E=this.$49(this.$20,t,this.$8B,this.$4A,this.$56);A.$4(this.$19,1/8,E).$76(this.$96,E),this.shell&&(this.$4A<0||$48)&&A.$89(()=>{var t,E;A.P().A(0-e*n/2,-1.75-s/2+i,7/8).C(),this===$41&&A.F("#554"),A.W("#242",1/16),A.T(0-e*n/2,-1.75-s/2+i),A.R(this.$56[0]/16),A.$69(this===$41?world.$59.$94:shell.$69,-1,-1,2,2),this===$41&&([t,E]=$59($41.$3E(),t=>t/128),A.P().A(t,E,1/32).C().F(this.$96))})})}},"$A7"),$5A("$8F",[],{$88(n){n.$89(()=>{this.$3D(n),n.S(this.$8B,1);var t=this.$20,[E,e]=t?$7(this.$93()):[0,0],[s,i]=t?$7(1-this.$93()):[0,0],[[s,i],[E,e]]=0<this.$8B?[[E,e],[s,i]]:[[s,i],[E,e]],t=sqrt(abs(this.$56[0])/(abs(t)||1));n.P().M(1,i/4-2).L(0-E*t,0+e).L(0,i/4-1).C().M(-1,e/4-1).L(s*t-1,0+i).L(-2,e/4-1.5).C().F("#520"),n.P().M(1,i/4-3).L(2,i/4-2).L(1,i/4-2).L(1+s*t,0+i).L(0,i/4-1).L(-1,e/4-1).L(-2-E*t,0+e).L(-2,e/4-1.5).L(-1.75,e/4-1.75).L(-2,e/4-2).L(0,i/4-2).L(.5,i/4-2.5).L(0,i/4-3).C().W("#620",1/8).F("#840"),n.P().A(1,i/4-4,1,$42[2],1,!0).W("#620",.125)})}},"$A7"),$5A("$A0",[],{$88(n,t,E,e){n.$89(()=>{this.$3D(n),n.S(this.$8B,1);var t=this.$20,[E,e]=t?$7(this.$93()):[0,0],[s,i]=t?$7(1-this.$93()):[0,0],[[s,i],[E,e]]=0<this.$8B?[[E,e],[s,i]]:[[s,i],[E,e]],t=sqrt(abs(this.$56[0])/(abs(t)||1));n.P().M(1,i/4-2).L(0-E*t,0+e).L(0,i/4-1).C().M(-1,e/4-1).L(s*t-1,0+i).L(-2,e/4-1.5).C().F("#520"),n.P().M(2,i/4-2).L(2,i/4-1).L(1.5,i/4-.5).L(1,i/4-1).L(1+s*t,0+i).L(0,i/4-1).L(-1,e/4-1).L(-2-E*t,0+e).L(-2,e/4-1.5).L(-1.75,e/4-1.75).L(-2,e/4-2).L(0,i/4-3).L(1,i/4-2.25).L(1.5,i/4-2.5).C().stroke("#620",1/8).F("#840"),n.P().A(2,i/4-2.25,.75,$42[2],$42[2]+$42[7]).stroke("#620",.125)})}},"$A7"),$5A("$55",[["$44",0],["$37",32],["$96","#ccf"],["$19","#ccf4"]],{$88(A){A.$89(()=>{var t,E,{$44:e,$37:s}=this,i=s-1,n=1.3*s;e&&(t=$1(cos($42[28]*e)*n),E=e<14?t:-n,e=14<e?-t:n,A.P().M(0,i).B(e,s,e,-s,0,-i).B(E,-s,E,s,0,i).C().F(this.$96)),A.P().A(0,0,i).C().W(this.$19,s/16)})},$5E(){return abs(sin($42[2]*this.$44/28))}},"$7D"),$5A("$A5",[["$96",()=>`hwb(${120+rand.$66(25)} ${10+rand.$66(5)}% ${round(65+rand.$66(5))}%)`],["$37",16],["$3F",[]],["$7C",[]],["$63",[]],["$B",0],["$90",null]],{$74(E=16){this.$37=E;rand();return this.$3F=$1B(16,t=>new $7D(0,-E,0).$2E($42[16]*(t+rand()/4))),this},$C(E){var t=this.$37+1,[e]=new $7D(-t,-t,0).$52(this).$3C(),[t]=new $7D(t,-t,0).$52(this).$3C();this.$B=t<=0||e>=$D.$A?0:1,$86(this.$63,t=>t.$C?.(E))},$88(T){if(this.$B)return T.$89(()=>{let A=0,t=new $7D;var E=$59(this.$3F,(e,s)=>{t.splice(0,t.length,...e);var[e,i,n]=t.$52(this).$45();if(n){A=max(A,n);let t=e*n,E=i*n;return()=>(s?T.L:T.M)(t,E)}return()=>{}});T.P(),$86(E,t=>t()),T.C().O(.25).F(this.$96).W(this.$96,2/32),T.P(`M ${$79(l)} ${$79(u)} L ${$79(r)} ${$79(u)} W #0f0 4`)}),T.$94}},"$7D"),$5A("$43",[["$49",""],["$D",null],["$6",0],["$6C",0],["$96",()=>`hwb(${round(150+2*rand.$A1())} ${round(7+5*rand())}% ${round(80+4*rand.$A1())}%)`]],{$74(t){const n=this.$A6=t||this.$A6||4*rand()+3,A=ceil(n);let T=0,r=0,a=0;return this.$49=$1B(A,t=>{var E=(n-t)/(n-t+3),e=T-E/.125,s=E*(A-t),i=T+E+.5,t=$4E(n-t,A),E=$79(rand.$A1()*t*E/2),s=(r=max(s,r),`M ${E} ${$79(e)} L ${$79(-s)} ${$79(i)-rand()*t} L ${$79(a)} ${$79(T+.25)} L ${$79(s)} ${$79(i)-rand()*t} L ${E} `+$79(e));return a=E,T=e,s}).join(" ")+` F ${this.$96} S #1218`,this.$6=ceil(2*r),this.$6C=ceil(abs(T)),this.$D=$2A({$6:this.$6*$39*4,$6C:this.$6C*$39*4,os:!0}),this.$D.$89(t=>t.S($39,$39).T(this.$6/2,this.$6C).P(this.$49)),this},$88(t){if(this.$D)return t.$89(()=>{this.$3D(t),t.$69(this.$D.$94,-this.$6/2,-this.$6C,4*this.$6,4*this.$6C)}),this}},"$7D"),$5A("$77",[["$D",null],["$44",0],["$96","#373"],["$62",-1],["$6",4],["$6C",2]],{$74(){const E=abs((moon.$44+28-this.$44)%28)<3;return this.$D=this.$D??$F(this.$6*$39*4,this.$6C*$39*4),this.$D.E(),this.$D.$89(t=>{t.S($39,$39).T(this.$6/2,this.$6C).P().M(0,0).L(0,(E,-1)).W(this.$96,.25).P().A(-.25,rand.$A1()/8-.5,E?3/8:.25).A(.25,rand.$A1()/8-.5,E?3/8:.25).F(this.$96),t.P().A(0,(E?-1.25:-1)+rand()/8,E?.5:1/8).F(`hwb(${round((180/28*this.$44+240+rand.$A1()/4)%360)} ${round(10+25*rand())}% 5%)`)}),this},$88(t){if(this.$D)return t.$89(()=>{this.$3D(t),t.$69(this.$D.$94,-this.$6/2,-this.$6C,4*this.$6,4*this.$6C)}),this},$C(){return moon.$44!==this.$62&&.5<=$6B&&(this.$74(),this.$62=moon.$44),this}},"$7D"),$5A("$5",[["$28",13],["$A6",0],["$55",[]],["$87",[]],["$71",()=>$1B(256,t=>$1B(256,t=>null))],["$A4",[]],["$59",null],["$78",null],["$1A",[]],["$7C",[]],["$63",[]]],{$74(t){this.$59=this.$59||$2A({$6:256,$6C:256,os:!0}),this.$78=this.$78||$2A({$6:256,$6C:256,os:!0}),this.$28=t,rand.seed(t),console.log("Generating world and setting seed",t,rand.seed());this.$54=$1B(28,t=>(new $A5).$74(12).$52([96,0,0]).$2E(t*$42[28]-$42[4])),this.$87=$1B(13,t=>t<10?(new $A5).$74(18).$52([80,0,0]).$2E($42[10]*(t+2.5)):(new $A5).$74(18).$52([0,16*(t-11)*2.5,0])),this.$A4=[...this.$54,...this.$87],$86(this.$54,(e,t)=>{e.$50="moon "+t,$86(e.$3F,E=>{var t;this.$A4.filter(t=>E.$95().$52(e).$8C(t).$60()<=t.$37+.05).length<2&&((t=(new $43).$74().$52(e).$52(E)).$A5.push(e),e.$63.push(t),this.$63.push(t))});t=$3A(new $77,{x:e.x,y:e.y,$44:t}).$74();e.$63.push(t),this.$63.push(t)}),$86(this.$87,(E,t)=>{$1B(3,t=>{t=(new $47).$52(E.$95().$52(new $7D(0,6+rand.$66(6),0).$2E($42[3]*(t+rand.$A1()/8))));E.$7C.push(t),t.$A5.push(E)})}),this.$7C.push(...$59(this.$A4,t=>t.$7C).flat().sort($29)),this.$59.$89(s=>{s.E().center(),$86(this.$A4,e=>{s.P(),$86(e.$3F,(t,E)=>(E?s.L:s.M)(t[0]+e.x,t[1]+e.y)),s.C().F(s.$72(0,90,90,0,0,256,["#242","#262"])).O(.25).W(s.$72(0,184,276,0,0,256,["#353","#484"]),1).O(1)})}),this.$78.P().A(128,128,108).W("#202",16).C().P().A(128,112,48).F(this.$78.$72(128,128,32,128,128,256,["hwb(250deg 14% 57%)","hwb(220deg 65% 12%)"])),this.$78.$69(this.$59.$94,0,0,256,256);const e=$3A(new $55,{$37:10});return $86(this.$54,(E,t)=>{$3A(e,{$44:t}),this.$78.$89(t=>{t.T(128+E.x,128+E.y).O(.875).P().A(0,0,E.$37).F(E.$96).O(.125),e.$88(t)})}),this.$78.$89(t=>{t.center(),console.log(`Plotting ${this.$63.length} landscape items`),$86(this.$63.filter(t=>!(t instanceof $77)),t=>this.$78.P().A(t.x,t.y+.5,1.25).F(t.$96))}),$86([...this.$7C,...this.$63,$41],t=>{t.y=$0(t.y),t.x=$0(t.x),this.$71[t.y+128][t.x+128]=t}),this},$2D(){},$5C(){},$C(E){return $41.$A5=this.$A4.filter(t=>$60($8C(t,$41))<t.$37),$86(this.$A4,t=>t.$C(E)),this},$88(E){var e=-E.$9/$39,s=E.$A/$39;for(let t=0;t<=256&&!(t>$9E.y+132);t+=1){var i=new $7D($9E.x,t-128,0).$3C(0),n=i[2];if(0===n)break;var A=n*$39*2,T=max(0,floor($9E.x+128-E.$9/A)-4);min(256-T,ceil(E.$A/A)+8);E.$69(this.$78.$94,$9E.x+128-E.$9/A,t,E.$A/A,1,e,(i[1]-E.$6E)/$39,s,2*n),$86($23(this.$71[t].filter(t=>t),$29),t=>t.$88(E))}return E.$94}},"$7D"),$2A());let moon=new $55,sun=$16(32,"#ffd"),rand=$36(13),stars=$1B(91,()=>[rand.$A1(),rand.$A1()]),shell=$27(),$41=$3A(new $47,{x:0,y:104,z:0,shell:shell,$4A:-1,$96:"#840",$19:"#620"}),$53=new $7D,world=($53.$49=$49().M(-2,-2).L(2,2).L(-2,2).L(2,-2).C(),(new $5).$74(Date.now())),entities=[],$9D=20,$9B=-2,$9C=4,$9A=-1/8,$9E=new $7D($41.x,$41.y+$9C,$41.z+$9A);const $10=E=>{$48||(D+=E*$35,$92=floor(D/$91),$6B=D%$91/$91,measure=floor(D/4e3),bar=D%4e3/4e3,beat=floor(8*bar),$13=floor(D/250),$62!==$13&&$7F("tick"),$62=$13,step=D%$9F/$9F,$64.change&&$41.$2B.unshift($3A(new $14,{$13:$13,$99:$64.$52})),$64.shift?$41.$1F=4:$41.$1F=2,world.$C(E),$41.$C(E),$86(world.$7C,t=>t.$C?.(E))),$9E.x+=($41.x-$9E.x)/16,$9E.y+=($41.y+($48?$9C:$9D)-$9E.y)/16,$9E.z+=($41.z-$9E.z+($48?$9A:$9B))/16};let $57=$1B(256,t=>[t,t]).flat().map(t=>t/$39);const $5B=(t=0)=>{performance.now();var E=t-now;now=t,$10(E*$35);const{$6F:e,$6E:T,$6D:s,$A:i,$9:r,$8:n,$38:a,$2F:R}=$D;t=$6B,E=t;const h=(t+.5)%1;moon.$44=D?floor((28+(D-$26()*$91)/$91)%28):0;let P=$25(E)*n;const S=$30(E);let I=$25(h)*n;const O=$30(h);.5<t?P=-I:I=-P;let o;$D.$89(()=>{if($D.E(),$D.ctx.fillStyle=.1<S?"#840":"#202",$D.ctx.fillRect(0,0,i,e),$D.center(),.25<O){const A=s-O*s*2;$86(stars,([t,E])=>{var e=t*r,s=(E-h)*T,i=$4E($60([I,A],[e,s]),4*moon.$37),n=1+.5*sin((7.3*E+now%$91/$91+1.1*t)*$98),E=(1+n)**2*max(0,sin(7.3*E+now/$91*130+11*t)**3);$D.O(max(0,1-moon.$5E()/2-(i<.25?1:1-i))).P().A(e,s,n).F("#ffd").C(),$D.P().M(e,s-E).L(e,s+E).M(e-E,s).L(e+E,s).W("#ffd",.5)}),o=`rgba(204,204,255,${$79(.1*moon.$5E())})`,$D.O(max(0,O)).P().A(I,A,2*R).C().F($D.$72(I,A,a*moon.$5E(),I,A,2*a,[`rgba(204,204,255,${$79(.05+.2*moon.$5E())})`,o,o,"rgba(24,0,24,0)"])).T(I,A),moon.$88($D),o="#ccf6"}.25<S&&($D.O(max(0,S)),o="#aae6",$D.P().A(P,s-S*s*2,2*R).C().F($D.$72(P,s-S*s*2,sun.R*max(S,0),P,s-S*s*2,R,["#fff","#aae","#aaec","rgba(170,170,238,0)"])).$69(sun.$69,P-sun.R,s-S*s*2-sun.R,sun.D,sun.D))}),$D.$89(()=>{$D.T(r,T),$D.S($39,$39),world.$88($D)}),$D.$89(()=>$D.T($53.x-2,$53.y-2).S(4,4).R($98*$7A(now%4e3/4e3)).$76("#2808",$53.$49)),requestAnimationFrame($5B)},$64=($5B(0),{w:0,a:0,s:0,d:0,get change(){return this.w+this.a+this.s+this.d},get $52(){var{w:t,a:E,s:e,d:s}=this;return{w:t,a:E,s:e,d:s}}}),$5D=($4B("mousedown",()=>{$48=!1,$8A=$22()}),$4C("keydown",t=>{$7F("input");t=t.key.toLowerCase();$64[t]=1,$7F("key-"+t),"escape"===t&&($48=!$48,$7F("pause"))}),$4C("keyup",t=>$64[t.key.toLowerCase()]=0),$4C("mousedown",()=>$7F("input")),$4C("mousemove",({clientX:t,clientY:E})=>$3A($53,{x:t,y:E})),$4C("resize",()=>{$D.$31(window.innerWidth,window.innerHeight)}),$86(["visibilitychange","blur"],t=>$4C(t,()=>{$48=!0,$7F("pause"),$86(Object.keys($64),t=>$64[t]=0)})),(t,E,e)=>t.addEventListener(E,e));$86(["mousedown","mouseup","mousemove","keydown","keyup","visibilitychange"],E=>$5D(document,E,(...t)=>$7F(E,...t))),$86(["resize","blur"],E=>$5D(window,E,(...t)=>$7F(E,...t))),document.body.appendChild($D.$33);})()</script></body>