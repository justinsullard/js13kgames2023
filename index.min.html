<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>13 Drums</title><style>html,body{padding:0;margin:0;width:100%;height:100%;background:#202;cursor:none}canvas{width:100%;height:100%}</style><body><script>(()=>{let now=0,$A3=500,$94=144e3,D=0,$6C=0,$13=0,$61=0,measure=0,beat=0,bar=0,$47=!0,$34=1,$38=32;const{cos,sin,min,max,sqrt,floor,ceil,round,imul,abs,PI,sign}=Math,$1B=(t=0,E=t=>t)=>new Array(t).fill(0).map((t,E)=>E).map(E),$2E=([t,E],e)=>[t*cos(e)-E*sin(e),t*sin(e)+E*cos(e)],$52=([t,E,e],[s,i,A])=>[t+s,E+i,e+A],$8F=([t,E,e],[s,i,A])=>[t-s,E-i,e-A],$7A=(t,E=1e3)=>round(t*E)/E,$4E=(t,E)=>t<E?t/E:1,$3F=(t,E)=>max(0,$4E(t,E)),$68=(t,E,e)=>E<t&&t<e,$23=(t,E=(t,E)=>t-E)=>t.sort(E),$4F=([t,E],e=1)=>{e/=$5F([t,E])||1;return[t*e,E*e]},$5F=([t,E],[e=0,s=0]=[])=>sqrt((e-t)**2+(s-E)**2),$1=t=>(0<t?floor:ceil)(t),$2=t=>(t<0?floor:ceil)(t),$0=t=>sign(t)*round(abs(t)),$9B=2*PI,$41=$1B(128,t=>t?$9B/t:0),$39=(...t)=>Object.assign(...t),$88=(t,E)=>t.forEach?.(E),$59=(t,E)=>t.map(E),$29=(t,E)=>t.y-E.y||t.z-E.z||t.x-E.x,$7D=t=>1+2.70158*(t-1)**3+1.70158*(t-1)**2,$84=t=>t*t*(2.70158*t-1.70158),$82=t=>1-cos(t*PI/2),$83=t=>-(cos(PI*t)-1)/2,$85=t=>sin(t*PI),$7C=t=>sin(t*$9B),$87=2.5949095,$86=$9B/4.5,$26=()=>min(500/$94,.05),$30=t=>{let E=max(0,sin(t*$9B)),e=$26();return e<t&&t<=2*e?E+=2*$7D((t-e)/e):2*e<t&&t<.5?E+=2:.5<=t&&t<.5+e&&(E+=2-2*$84((t-.5)/e)),E/3},$25=t=>2*$83($4E(t,.5))-1,_WALK=t=>[(min(2*t,0)-(1-cos(t*$9B)))/2,-$82(-min(sin(t*$9B),0))/2],$7=t=>_WALK(t),$35=(t=0)=>{let E=0|t;return let=fn=()=>{var t=(E=E+2654435769|0)^E>>>16,t=imul(t,569420461);return t^=t>>>15,(((t=imul(t,1935289751))^t>>15)>>>0)/4294967296*2},$39(fn,{seed:t=>void 0!==t?E=0|t:E,$66:(t=1)=>round(fn()*t),$A6:()=>1-2*fn(),sign:()=>$2(fn.$A6()),bit:()=>round(fn()),bool:()=>!!round(fn()),shuffle:t=>t.slice().sort(fn.$A6),pick:t=>t[$1(fn()*t.length)]})},$17=new Map,$18=t=>($17.has(t)||$17.set(t,new Set),$17.get(t)),$4B=(t,E)=>$18(t).add(E),$4D=(t,E)=>$18(t).delete(E),$81=(t,...E)=>$88([...$18(t)],t=>t(...E)),$4A=(E,e)=>{let s=(...t)=>{$4D(E,s),e(...t)};$4B(E,s)};let $8D=0;const Q=[32.7,36.71,41.2,43.65,49,55,61.74,65.41,73.42,87.31,98,110,130.81,174.61,196].map(t=>2*t),$11=32/27,$24=(t=0,E=0,e=16)=>{let s=t?e/t:0;return $23($1B(t,t=>floor(t*s+E+e)%e))},$21=()=>{let e=Q.slice(1,-1);return[[Q[0],.4,0,[0,3,8,11,14]],...$1B(13,t=>{let E=rand.pick(e);return e=e.filter(t=>t!==E),[E,.2*rand(),rand.$A6(),$24(1+rand.$66(),rand.$66(15))]})]},$58=()=>[Q[0],...rand.shuffle(Q.slice(1,9))].slice(0,8).map(t=>2*t),$AD=(t,e,E,s,i,A=6)=>{const n=t.createOscillator();var T=t.createGain(),r=t.createStereoPanner();n.frequency.setValueAtTime(E/$11,i),$88($24(A,2),(t,E)=>n.frequency.exponentialRampToValueAtTime(E%2?e*$11:e/$11,i+E/8)),T.gain.setValueAtTime(.1*E,i),T.gain.exponentialRampToValueAtTime(.5*E,i),T.gain.exponentialRampToValueAtTime(E,i+.325),T.gain.exponentialRampToValueAtTime(.01,i+2),r.pan.setValueAtTime(s,i),r.pan.exponentialRampToValueAtTime(-s,i+2),n.connect(T),T.connect(r),r.connect(t.destination),n.start(i),n.stop(i+2)},$A7=(t,E,e,s,i,A,n)=>{var T=t.createOscillator(),r=t.createGain(),R=t.createStereoPanner(),a=t.createDynamicsCompressor(),A=A||e;T.frequency.setValueAtTime(E,i),T.frequency.exponentialRampToValueAtTime(E/1.5,i+.5),r.gain.setValueAtTime(.1,i),r.gain.exponentialRampToValueAtTime(A,i+1/32),r.gain.exponentialRampToValueAtTime(A/5,i+.1/16),r.gain.linearRampToValueAtTime(0,i+.5),R.pan.setValueAtTime(n??s,i),a.threshold.setValueAtTime(-50,i),a.knee.setValueAtTime(40,i),a.ratio.setValueAtTime(12,i),a.attack.setValueAtTime(0,i),a.release.setValueAtTime(.25,i),T.connect(r),r.connect(R),R.connect(a),a.connect(t.destination),T.start(i),T.stop(i+.51)},$33=(t,E,e=0,s)=>{var i=.05+.03*rand(),A=1/8+rand()/16,n=t.createOscillator(),T=t.createGain(),r=t.createStereoPanner();n.type="triangle",n.frequency.setValueAtTime(E,s),T.gain.setValueAtTime(i/2,s),T.gain.exponentialRampToValueAtTime(i,s+A/2),T.gain.exponentialRampToValueAtTime(.01,s+A),r.pan.setValueAtTime(e,s),n.connect(T),T.connect(r),r.connect(t.destination),n.start(s),n.stop(s+A)},$22=()=>{let A=new AudioContext,t=-$7A(D/4e3,10)%1,n=t,e=[0],T=[],s=[];var E=(t,E)=>{T=t||$21(),s=E||$58()},i=()=>{A.currentTime+.25<n||n<0||($AD(A,s[0]||2*Q[rand.$66(6)],.3,.5*rand.$A6(),n,floor(n-t)%3+4),s.push(s.shift()),$88(e,t=>{const[E,e,s,i]=T[t];$88(i,t=>$A7(A,E,e,s,.25*t+n))}),n+=4)};return setInterval(i,100),$4B("rattle",(t=0)=>{$33(A,($10%2?rand.pick(s.slice(0,3)):s[7-(beat+measure%8)%8])||Q[0],"number"==typeof t?t:0,A.currentTime)}),$4B("beat",()=>{var[,t,E,,]=T[0];$A7(A,Q[14],t,E,A.currentTime)}),$4B("pause",()=>{"running"===A.state&&$47?A.suspend():"suspended"!==A.state||$47||A.resume()}),E(),i(),{fresh:E,n:n,get track(){return T},get voices(){return e},get melody(){return s},sing:(t=[],E)=>{e=[0,...t],s=E||s}}},$48=($2A=({$6:t=window.innerWidth,$6D:E=window.innerHeight,os:s=!1}={})=>{let i=s?null:document.createElement("canvas"),A=(i&&(i.width=t,i.height=E),s?new OffscreenCanvas(t,E):i.transferControlToOffscreen()),T=A.getContext("2d");A.width=t,A.height=E;const r={get $A(){return A.width},get $9(){return A.width/2},get $8(){return A.width/3},get $70(){return A.height},$6F:A.height/2,get $6E(){return A.height/3},get $37(){return min(r.$6E,r.$8)},get Rm(){return min(r.$70,r.$A)},get $2F(){return max(r.$70,r.$A)},$97:A,$32:i,ctx:T,$31:(t,E)=>{var e;s||(e=document.createElement("canvas"),i.replaceWith(e),(i=e).width=t,e.height=E,A=i.transferControlToOffscreen(),T=A.getContext("2d"),$39(r,{$97:A,ctx:T,$32:i})),A.width=t,A.height=E,r.$6F=A.height/2},$8C:t=>(T.save(),t(r),T.restore(),r),E:()=>(T.clearRect(0,0,r.$A,r.$70),r),center:()=>(r.T(r.$9,r.$6F),r),$76:(t="none")=>(T.filter=t,r),T:(t,E)=>(T.translate(t,E),r),R:(t,E)=>(T.rotate(t,E),r),M:(...t)=>(T.moveTo(...t),r),L:(...t)=>(T.lineTo(...t),r),A:(t=0,E=0,e=1,s=0,i=$41[1],A=!1)=>(T.arc(t,E,e,s,i,A),r),B:(...t)=>(T.bezierCurveTo(...t),r),P:t=>(T.beginPath(),t?.match(/[MLABCTREOSFW](?:\s*-?\d+(?:\.\d+)?|\s*#[a-f0-9]{3,8}|\s*hwb\([^)]+?\))*/g).forEach(t=>{var[t,...E]=t.includes("(")?[t[0],t.slice(1).trim()]:t.split(" ");r[t](...$59(E,t=>"#"===t[0]||t.includes("(")?t:parseFloat(t,10)))}),r),C:()=>(T.closePath(),r),O:t=>(T.globalAlpha=t,r),S:(t=1,E=1)=>(T.scale(t,E),r),$71:(e,s)=>$88(s,(t,E)=>e.addColorStop(E/s.length,t)),$74:(t,E,e,s,i)=>{t=T.createLinearGradient(t,E,e,s);return r.$71(t,i),t},$73:(t,E,e,s,i,A,n)=>{t=T.createRadialGradient(t,E,e,s,i,A);return r.$71(t,n),t},F:t=>(T.fillStyle=t,T.fill(),r),$77:(t,E)=>(T.fillStyle=t,T.fill(E),r),W:(t,E)=>(T.strokeStyle=t,T.lineWidth=E,T.stroke(),r),$4:(t,E,e)=>(T.strokeStyle=t,T.lineWidth=E,T.stroke(e),r),$69:(...t)=>T.drawImage(...t)};return r.E(),r},()=>{const n=new Path2D;return n.M=(...t)=>(n.moveTo(...t),n),n.L=(...t)=>(n.lineTo(...t),n),n.A=(t=0,E=0,e=1,s=0,i=$41[1],A=!1)=>(n.arc(t,E,e,s,i,A),n),n.$A8=(...t)=>(n.arcTo(...t),n),n.B=(...t)=>(n.bezierCurveTo(...t),n),n.Q=(...t)=>(n.quadraticBezierCurveTo(...t),n),n.C=()=>(n.closePath(),n),n}),$F=(t,E)=>$2A({$6:t,$6D:E||t,os:!0}),$16=(t=32,E="#840")=>{const e=$F(3*t),s=t/4,i=1.4*t;return e.$8C(()=>{e.E().center().P().A(0,0,t).C().F(E).P().M(-i,-s).L(i,-s).M(-i,s).L(i,s).M(-s,-i).L(-s,i).M(s,-i).L(s,i).W(E,3)}),{R:1.5*t,D:3*t,get $69(){return e.$97}}},$5A=(Array.$91=()=>[],(a,d,m={},p="$7F")=>{const dd=window[p].$91?.()??[],o=dd.length,dv=$59(d,([,t])=>"function"==typeof t?t.toString().replace(/^\(\) ?=> ?/,""):JSON.stringify(t)).join(","),e=`window.${a}=class ${a} extends ${p}{`+`static $91=()=>[...${p}.$91(),${dv}];`+`constructor(...x){super(...(x.length ? x : ${a}.$91()))}`+"*[Symbol.iterator]() {for(let i = 0,l=this.length;i<l;i++){yield this[i]}}"+$59(d,([t],E)=>`  get ${t}(){return this[${E+o}]} set ${t}(x){return this[${E+o}]=x}`).join("")+$59(Object.values(m),t=>t.toString()).join("")+"};";return eval(e)}),$3=$1B(1280,t=>4/((t+1)/10)*5).reduce((t,E,e)=>t.set((e+1)/10,E),new Map),$6A=($5A("$7F",[["x",0],["y",0],["z",0],["age",0],["$AA",[]]],{$98(){return new this.constructor(...this)},$52(t){return[this.x,this.y,this.z]=$52(this,t),this},$2E(t){return[this.x,this.y]=$2E(this,t),this},$8F(t){return new $7F(...$8F(this,t))},$3D(){return $59([this.x,this.y,this.z],round)},$4F(t=1){return[this.x,this.y]=$4F([this.x,this.y],t),this},$2C(t=1){return this.$4F(this.$5F()*t),this},$5F(){return $5F([this.x,this.y])},$3C(t){var[E,e,s]=this.$44();return t.S(s,s),t.T(E,e),this},$44(){var[t,E,e]=this.$8F($A2),s=E<0?4/-E*5:0;return[t*=4,E=4*e*s,s]},$3B(t=1){var[E,e,s]=this.$44(),i=(E*=s*$38,e*=s*$38,t?2*-$38*s:0);return new $7F(E+$D.$9,e+$D.$6F+i,2*s*(t?$38:1))},$9A(){var[t,E,e]=this.$3B();return $48().A(t,E,abs(e)).C()},$C(t){},$12(){},$8B(){}},"Array"),$5A("$8A",[["$6B",null],["$4C",[]],["$8C",()=>{}]]),$5A("$14",[["$13",0],["$9C",{}],["$15",null],["$1E",null],["$1C",null],["$C",()=>{}]],{},"Array"),{w:0,a:0,s:0,d:0}),$27=($5A("$AC",[["shell",null],["$20",0],["$51",0],["$8E",1],["$49",1],["$56",()=>new $7F],["$67",()=>new $7F],["$E",()=>new $7F(1,1,0)],["$2B",[]],["w",0],["a",0],["s",0],["d",0],["$1F",2],["$64",[]],["$89",[]],["$60",0],["$3A",[0,0,0]]],{$80(){return this.$20?abs(this.$20):0},$1D(){var t=this.$51%1;return t*=this.$56.$5F?.()||$68(t,1/32,31/32)?1:0,(this.$8E<0?1-t:t)%1},$96(){return this.$1D()?$4E(this.$1D()%.5,.5)%1:1-bar%.5*2%1},$C(t){t/=1e3;this.$1D(),this.$80();let{w:E,a:e,s,d:i}=this;var A=round(this.x)+128,n=round(this.y)+128,T=this.$2B.filter(t=>t.$13<=$13),T=(T.length?($88(T,t=>{var E,e;t.$1E=t.$1E||t.$13,t.$15?($5F(this,t.$15),.5<t.$15.$98().$2C(-1).$52(this).$5F()?(t.$13=$13,E=abs(this.x-t.$15.x),e=abs(this.y-t.$15.y),E=$4E(E,1)>3/8?1:0,e=$4E(e,1)>3/8?1:0,$39(t.$9C,this.x>t.$15.x?{a:E,d:0}:{a:0,d:E},this.y>t.$15.y?{w:e,s:0}:{w:0,s:e})):(t.$1C=t.$13,this.$2B.push(new $14($13+1,$6A,null),new $14($13+12,$6A,null)))):(t.$13=-1,t.$1C=$13),$39(this,t.$9C)}),T.length&&({w:E,a:e,s,d:i}=this),this.$2B=this.$2B.filter(t=>!t.$1C||t.$1C>$13)):$39(this,{w:0,a:0,s:0,d:0}),this.$67=new $7F(-e+i,-E+s,0),this.$8E=sign(this.$67.x||this.$8E),this.$49=sign(this.$67.y||this.$49),new $7F(...this.$67)),r=new $7F(...this.$56),R=this.$96();if(0===T.$5F()&&$68(r.$5F(),1/16,R)&&T.$52(new $7F(...this.$E).$4F((1-R)/2)),T.$4F(4*t),this.$67.$5F()){const s=.75+$4E(T.$98().$4F(2).$52(r.$98().$4F(1)).$5F(),3)/4;r.$2C(s)}r.$52(T),r.$4F(min(r.$5F(),this.$1F));var a,T=(this.$56=r).$5F(),h=new $7F(...r);h.$4F(h.$5F()*t);const O=$52(this,h);this.$AA.length&&!this.$AA.find(t=>$5F($8F(t,O))<t.$36)&&h.$2C(-.5);let P=round(this.x+h.x)+128,I=round(this.y+h.y)+128;if(A===P&&n===I||((a=world.$72[I][P])&&a!==this&&(h.$2C(-.5),P=round(this.x+h.x)+128,I=round(this.y+h.y)+128),world.$72[n][A]=null,world.$72[I][P]=this),this.$52(h),this.$51+=h.$5F(),this.$20=T*this.$8E,this.$E=T?r.$98().$4F(1):this.$E,this.$67.$5F()<.25&&r.$5F()&&r.$2C(this.$96()<1/8?0:$3F(1-2*t,1)),0===r.$5F()&&this.$1D()&&R&&(r.$2C(0),this.$51=round(2*this.$51)/2),this===$40){const s=floor(this.$51/.25);s>this.$60&&$81("rattle",this.$E.x/-2),this.$60=s}this.$3A=this.$3B()},$12(){var t;this.$2B?.length||(t=this.$AA[0],this.$2B=[new $14($13,{},t.$98().$52(new $7F(0,2+rand.$66(t.$36-2),0).$2E(rand()*$9B)))])}},"$7F"),({$90:E=512,$89:i=[]}={})=>{const A=$F(E),s=E/2,n=E/12,e={R:s,$90:E,$89:i,$8B:(t=A)=>(t.$8C(()=>{let e=5.6*n;t===A&&t.E().center(),t.P().A(0,0,s).C().F(t.$73(0,2*n,4*n,0,0,E,["#242","#262"])),A.P().A(0,0,e),$1B(28,t=>{var[t,E]=$2E([1,0],$41[28]*(t-.5)-$41[4]);A.M(t*e,E*e).L(t*s,E*s)}),A.W(A.$73(0,2*n,3*n,0,0,E,["#3536","#4846"]),2),$1B(13,t=>{let E=0,e=(t-11)*n*2.25;var s;t<10&&(s=$41[10]*(t-2),[E,e]=$2E([4.5*n,0],s)),A.P().A(E,e,n).C().F("rgba(127,127,127,0.25)"),i[t]&&A.P().A(E,e,n).C().F("#aa9")})}),t.$97),add(t){i.push(t),e.$8B()},get $69(){return A.$97}};return e.$8B(),e}),$45=new Map,$D=($5A("$46",[["$99",()=>`hwb(${round(30+10*rand.$A6()-2)} ${round(0+10*rand())}% ${round(47+10*rand())}%)`],["$19",()=>`hwb(${round(30+2*rand.$A6()-2)} 0% ${round(67+4*rand())}%)`]],{$48(t,E,e,s,i){var A,n,T,r,R,a,[t,E,e,s,i]=[$7A(t,4),$7A(E,64),e,s,$7A(i[0],4)],s=[t,E,e,s,i].join();return $45.has(s)||(A=$7C(E)/8,n=t?t/8:$7C(E)/16,T=$85(E)/8,abs(t/16),[E,r]=[t?$7(E):[0,0],t?$7(1-E):[0,0]],[[E,r],[R,a]]=[E,r],i=sqrt(abs(i)/(abs(t)||1)),$45.set(s,$48().A(0+n*i,T-3,1,$9B[4],$9B).M(0+n*i,T-2).L(2+R/3,A*e-1.5).L(1+E/16,A*e-1).L(1+E*i,r).L(0,T-1).L(-1-R*i,a).L(R/16-1,-1-A*e).L(-2-E/3,-1.5-A*e).C())),$45.get(s)},$8B(n,T=bar%.5*2,r=!0){n.$8C(()=>{r&&this.$3C(n);var t=this.$1D()%.5,t=t?$4E(t%.5,.5):1-T,E=this["$20"];let e=E?E/8:$7C(t)/16,s=$85(t)/8,i=abs(E/16);const A=sqrt(abs(this.$56[0])/(abs(E)||1));this.shell&&0<this.$49&&n.P().A(0-e*A/2,-1.75-s/2+i,7/8).C().W("#242",1/16).F("#131");E=this.$48(this.$20,t,this.$8E,this.$49,this.$56);n.$4(this.$19,1/8,E).$77(this.$99,E),this.shell&&(this.$49<0||$47)&&n.$8C(()=>{var t,E;n.P().A(0-e*A/2,-1.75-s/2+i,7/8).C(),this===$40&&n.F("#554"),n.W("#242",1/16),n.T(0-e*A/2,-1.75-s/2+i),n.R(this.$56[0]/16),n.$69(this===$40?world.$59.$97:shell.$69,-1,-1,2,2),this===$40&&([t,E]=$59($40.$3D(),t=>t/128),n.P().A(t,E,1/32).C().F(this.$99))})})}},"$AC"),$5A("$92",[],{$8B(A){A.$8C(()=>{this.$3C(A),A.S(this.$8E,1);var t=this.$20,[E,e]=t?$7(this.$96()):[0,0],[s,i]=t?$7(1-this.$96()):[0,0],[[s,i],[E,e]]=0<this.$8E?[[E,e],[s,i]]:[[s,i],[E,e]],t=sqrt(abs(this.$56[0])/(abs(t)||1));A.P().M(1,i/4-2).L(0-E*t,0+e).L(0,i/4-1).C().M(-1,e/4-1).L(s*t-1,0+i).L(-2,e/4-1.5).C().F("#520"),A.P().M(1,i/4-3).L(2,i/4-2).L(1,i/4-2).L(1+s*t,0+i).L(0,i/4-1).L(-1,e/4-1).L(-2-E*t,0+e).L(-2,e/4-1.5).L(-1.75,e/4-1.75).L(-2,e/4-2).L(0,i/4-2).L(.5,i/4-2.5).L(0,i/4-3).C().W("#620",1/8).F("#840"),A.P().A(1,i/4-4,1,$41[2],1,!0).W("#620",.125)})}},"$AC"),$5A("$A5",[],{$8B(A,t,E,e){A.$8C(()=>{this.$3C(A),A.S(this.$8E,1);var t=this.$20,[E,e]=t?$7(this.$96()):[0,0],[s,i]=t?$7(1-this.$96()):[0,0],[[s,i],[E,e]]=0<this.$8E?[[E,e],[s,i]]:[[s,i],[E,e]],t=sqrt(abs(this.$56[0])/(abs(t)||1));A.P().M(1,i/4-2).L(0-E*t,0+e).L(0,i/4-1).C().M(-1,e/4-1).L(s*t-1,0+i).L(-2,e/4-1.5).C().F("#520"),A.P().M(2,i/4-2).L(2,i/4-1).L(1.5,i/4-.5).L(1,i/4-1).L(1+s*t,0+i).L(0,i/4-1).L(-1,e/4-1).L(-2-E*t,0+e).L(-2,e/4-1.5).L(-1.75,e/4-1.75).L(-2,e/4-2).L(0,i/4-3).L(1,i/4-2.25).L(1.5,i/4-2.5).C().stroke("#620",1/8).F("#840"),A.P().A(2,i/4-2.25,.75,$41[2],$41[2]+$41[7]).stroke("#620",.125)})}},"$AC"),$5A("$55",[["$43",0],["$36",32],["$99","#ccf"],["$19","#ccf4"]],{$8B(n){n.$8C(()=>{var t,E,{$43:e,$36:s}=this,i=s-1,A=1.3*s;e&&(t=$1(cos($41[28]*e)*A),E=e<14?t:-A,e=14<e?-t:A,n.P().M(0,i).B(e,s,e,-s,0,-i).B(E,-s,E,s,0,i).C().F(this.$99)),n.P().A(0,0,i).C().W(this.$19,s/16)})},$5E(){return abs(sin($41[2]*this.$43/28))}},"$7F"),$5A("$AA",[["$99",()=>`hwb(${120+rand.$66(25)} ${10+rand.$66(5)}% ${round(65+rand.$66(5))}%)`],["$36",16],["$3E",[]],["$7E",[]],["$62",[]],["$B",0],["$93",null]],{$75(E=16){this.$36=E;rand();return this.$3E=$1B(16,t=>new $7F(0,-E,0).$2E($41[16]*(t+rand()/4))),this},$C(E){var t=this.$36+1,[e]=new $7F(-t,-t,0).$52(this).$3B(),[t]=new $7F(t,-t,0).$52(this).$3B();this.$B=t<=0||e>=$D.$A?0:1,$88(this.$62,t=>t.$C?.(E))},$8B(T){if(this.$B)return T.$8C(()=>{let n=0,t=new $7F;var E=$59(this.$3E,(e,s)=>{t.splice(0,t.length,...e);var[e,i,A]=t.$52(this).$44();if(A){n=max(n,A);let t=e*A,E=i*A;return()=>(s?T.L:T.M)(t,E)}return()=>{}});T.P(),$88(E,t=>t()),T.C().O(.25).F(this.$99).W(this.$99,2/32),T.P(`M ${$7A(l)} ${$7A(u)} L ${$7A(r)} ${$7A(u)} W #0f0 4`)}),T.$97}},"$7F"),$5A("$42",[["$48",""],["$D",null],["$6",0],["$6D",0],["$99",()=>`hwb(${round(150+2*rand.$A6())} ${round(7+5*rand())}% ${round(80+4*rand.$A6())}%)`]],{$75(t){const A=this.$AB=t||this.$AB||4*rand()+3,n=ceil(A);let T=0,r=0,R=0;return this.$48=$1B(n,t=>{var E=(A-t)/(A-t+3),e=T-E/.125,s=E*(n-t),i=T+E+.5,t=$4E(A-t,n),E=$7A(rand.$A6()*t*E/2),s=(r=max(s,r),`M ${E} ${$7A(e)} L ${$7A(-s)} ${$7A(i)-rand()*t} L ${$7A(R)} ${$7A(T+.25)} L ${$7A(s)} ${$7A(i)-rand()*t} L ${E} `+$7A(e));return R=E,T=e,s}).join(" ")+` F ${this.$99} S #1218`,this.$6=ceil(2*r),this.$6D=ceil(abs(T)),this.$D=$2A({$6:this.$6*$38*4,$6D:this.$6D*$38*4,os:!0}),this.$D.$8C(t=>t.S($38,$38).T(this.$6/2,this.$6D).P(this.$48)),this},$8B(t){if(this.$D)return t.$8C(()=>{this.$3C(t),t.$69(this.$D.$97,-this.$6/2,-this.$6D,4*this.$6,4*this.$6D)}),this}},"$7F"),$5A("$78",[["$D",null],["$43",0],["$99","#263"],["$61",-1],["$6",4],["$6D",4],["$A4",!1]],{$75(t){const e=this.$A4,s=(this.$D=this.$D??$F(this.$6*$38*4,this.$6D*$38*4),rand.$A6()/4);var E=e?-2:-1.5;const i=rand()/8,A=E+i;return this.$D.$8C(t=>{var E;t.E().S($38,$38).T(this.$6/2,this.$6D).P().M(-1.5-s,0).B(-2.5,-3,-1,-3,s,i-2).B(1,-3,2.5,-3,1.5+s,0).C().F(this.$99).P().M(0,0).B(2*-s,-i,4*s,A,s,A).W("#0002",1/8),t.P().A(s,A,e?.75:1/8).F(`hwb(${round((180/28*this.$43+240+rand.$A6()/4)%360)} ${round(10+25*rand())}% 5%)`),this.$A4&&(E=$39(new $55,{$36:10,$43:this.$43,$99:"#000",$19:"#fff0"}),t.O(.25).T(s,A).S(1/16,1/16),E.$8B(t))}),this},$8B(t){if(this.$D)return t.$8C(()=>{this.$3C(t),t.$69(this.$D.$97,-this.$6/2,-this.$6D,4*this.$6,4*this.$6D)}),this},$C(t,E,e){var E=E??moon?.$43,e=e??$6C;return E!==this.$61&&.5<=e&&(e=((this.$61=E)+28-this.$43)%28<3,this.$A4=e,this.$75(E)),this},$9D(){return this.$A4},$65(){var t=$39(this.$98(),{$D:null});$40.$64.push(t.$75()),this.$A4}},"$7F"),$5A("$7B",[],{},"$7F"),$5A("$5",[["$28",13],["$AB",0],["$55",[]],["$89",[]],["$72",()=>$1B(256,t=>$1B(256,t=>null))],["$A9",[]],["$59",null],["$79",null],["$1A",[]],["$7E",[]],["$62",[]]],{$75(t){this.$59=this.$59||$2A({$6:256,$6D:256,os:!0}),this.$79=this.$79||$2A({$6:256,$6D:256,os:!0}),this.$28=t,rand.seed(t),console.log("Generating world and setting seed",t,rand.seed());this.$54=$1B(28,t=>(new $AA).$75(12).$52([96,0,0]).$2E(t*$41[28]-$41[4])),this.$89=$1B(13,t=>t<10?(new $AA).$75(18).$52([80,0,0]).$2E($41[10]*(t+2.5)):(new $AA).$75(18).$52([0,16*(t-11)*2.5,0])),this.$A9=[...this.$54,...this.$89],$88(this.$54,(e,t)=>{e.$50="moon "+t,$88(e.$3E,E=>{var t;this.$A9.filter(t=>E.$98().$52(e).$8F(t).$5F()<=t.$36+.05).length<2&&((t=(new $42).$75().$52(e).$52(E)).$AA.push(e),e.$62.push(t),this.$62.push(t))});t=$39(new $78,{x:e.x,y:e.y,$43:t}).$C(0,0,.5);e.$62.push(t),this.$62.push(t)}),$88(this.$89,(E,t)=>{$1B(3,t=>{t=(new $46).$52(E.$98().$52(new $7F(0,6+rand.$66(6),0).$2E($41[3]*(t+rand.$A6()/8))));E.$7E.push(t),t.$AA.push(E)})}),this.$7E.push(...$59(this.$A9,t=>t.$7E).flat().sort($29)),this.$59.$8C(s=>{s.E().center(),$88(this.$A9,e=>{s.P(),$88(e.$3E,(t,E)=>(E?s.L:s.M)(t[0]+e.x,t[1]+e.y)),s.C().F(s.$73(0,90,90,0,0,256,["#242","#262"])).O(.25).W(s.$73(0,184,276,0,0,256,["#353","#484"]),1).O(1)})}),this.$79.P().A(128,128,108).W("#202",16).C().P().A(128,112,48).F(this.$79.$73(128,128,32,128,128,256,["hwb(250deg 14% 57%)","hwb(220deg 65% 12%)"])),this.$79.$69(this.$59.$97,0,0,256,256);const e=$39(new $55,{$36:10});return $88(this.$54,(E,t)=>{$39(e,{$43:t}),this.$79.$8C(t=>{t.T(128+E.x,128+E.y).O(.875).P().A(0,0,E.$36).F(E.$99).O(.125),e.$8B(t)})}),this.$79.$8C(t=>{t.center(),console.log(`Plotting ${this.$62.length} landscape items`),$88(this.$62.filter(t=>!(t instanceof $78)),t=>this.$79.P().A(t.x,t.y+.5,1.25).F(t.$99))}),$88([...this.$7E,...this.$62,$40],t=>{t.y=$0(t.y),t.x=$0(t.x),this.$72[t.y+128][t.x+128]=t}),this},$2D(){},$5C(){},$C(E){return $40.$AA=this.$A9.filter(t=>$5F($8F(t,$40))<t.$36),$88(this.$A9,t=>t.$C(E)),this},$8B(E){var e=-E.$9/$38,s=E.$A/$38;for(let t=0;t<=256&&!(t>$A2.y+132);t+=1){var i=new $7F($A2.x,t-128,0).$3B(0),A=i[2];if(0===A)break;var n=A*$38*2,T=max(0,floor($A2.x+128-E.$9/n)-4);min(256-T,ceil(E.$A/n)+8);E.$69(this.$79.$97,$A2.x+128-E.$9/n,t,E.$A/n,1,e,(i[1]-E.$6F)/$38,s,2*A),$88($23(this.$72[t].filter(t=>t),$29),t=>t.$8B(E))}return E.$97}},"$7F"),$2A());let moon=new $55,sun=$16(32,"#ffd"),rand=$35(13),stars=$1B(91,()=>[rand.$A6(),rand.$A6()]),shell=$27(),$40=$39(new $46,{x:0,y:104,z:0,shell:shell,$49:-1,$99:"#840",$19:"#620"}),$53=new $7F,world=($53.$48=$48().M(-2,-2).L(2,2).L(-2,2).L(2,-2).C(),(new $5).$75(13)),entities=[],$A1=20,$9F=-2,$A0=4,$9E=-1/8,$A2=new $7F($40.x,$40.y+$A0,$40.z+$9E);const $10=E=>{$47||(D+=E*$34,$95=floor(D/$94),$6C=D%$94/$94,measure=floor(D/4e3),bar=D%4e3/4e3,beat=floor(8*bar),$13=floor(D/250),$61!==$13&&$81("tick"),$61=$13,step=D%$A3/$A3,$63.change&&$40.$2B.unshift($39(new $14,{$13:$13,$9C:$63.$52})),$63.shift?$40.$1F=4:$40.$1F=2,world.$C(E),$40.$C(E),$88(world.$7E,t=>t.$C?.(E))),$A2.x+=($40.x-$A2.x)/16,$A2.y+=($40.y+($47?$A0:$A1)-$A2.y)/16,$A2.z+=($40.z-$A2.z+($47?$9E:$9F))/16};let $57=$1B(256,t=>[t,t]).flat().map(t=>t/$38);const $5B=(t=0)=>{performance.now();var E=t-now;now=t,$10(E*$34);const{$70:e,$6F:T,$6E:s,$A:i,$9:r,$8:A,$37:R,$2F:a}=$D;t=$6C,E=t;const h=(t+.5)%1;moon.$43=D?floor((28+(D-$26()*$94)/$94)%28):0;let O=$25(E)*A;const P=$30(E);let I=$25(h)*A;const S=$30(h);.5<t?O=-I:I=-O;let L;$D.$8C(()=>{if($D.E(),$D.ctx.fillStyle=.1<P?"#840":"#202",$D.ctx.fillRect(0,0,i,e),$D.center(),.25<S){const n=s-S*s*2;$88(stars,([t,E])=>{var e=t*r,s=(E-h)*T,i=$4E($5F([I,n],[e,s]),4*moon.$36),A=1+.5*sin((7.3*E+now%$94/$94+1.1*t)*$9B),E=(1+A)**2*max(0,sin(7.3*E+now/$94*130+11*t)**3);$D.O(max(0,1-moon.$5E()/2-(i<.25?1:1-i))).P().A(e,s,A).F("#ffd").C(),$D.P().M(e,s-E).L(e,s+E).M(e-E,s).L(e+E,s).W("#ffd",.5)}),L=`rgba(204,204,255,${$7A(.1*moon.$5E())})`,$D.O(max(0,S)).P().A(I,n,2*a).C().F($D.$73(I,n,R*moon.$5E(),I,n,2*R,[`rgba(204,204,255,${$7A(.05+.2*moon.$5E())})`,L,L,"rgba(24,0,24,0)"])).T(I,n),moon.$8B($D),L="#ccf6"}.25<P&&($D.O(max(0,P)),L="#aae6",$D.P().A(O,s-P*s*2,2*a).C().F($D.$73(O,s-P*s*2,sun.R*max(P,0),O,s-P*s*2,a,["#fff","#aae","#aaec","rgba(170,170,238,0)"])).$69(sun.$69,O-sun.R,s-P*s*2-sun.R,sun.D,sun.D))}),$D.$8C(()=>{$D.T(r,T),$D.S($38,$38),world.$8B($D)}),$D.$8C(()=>$D.T($53.x-2,$53.y-2).S(4,4).R($9B*$7C(now%4e3/4e3)).$77("#2808",$53.$48)),requestAnimationFrame($5B)},$63=($5B(0),{w:0,a:0,s:0,d:0,get change(){return this.w+this.a+this.s+this.d},get $52(){var{w:t,a:E,s:e,d:s}=this;return{w:t,a:E,s:e,d:s}}}),$5D=($4A("mousedown",()=>{$47=!1,$8D=$22()}),$4B("keydown",t=>{$81("input");t=t.key.toLowerCase();$63[t]=1,$81("key-"+t),"escape"===t&&($47=!$47,$81("pause"))}),$4B("keyup",t=>$63[t.key.toLowerCase()]=0),$4B("mousedown",()=>$81("input")),$4B("mousemove",({clientX:t,clientY:E})=>$39($53,{x:t,y:E})),$4B("resize",()=>{$D.$31(window.innerWidth,window.innerHeight)}),$88(["visibilitychange","blur"],t=>$4B(t,()=>{$47=!0,$81("pause"),$88(Object.keys($63),t=>$63[t]=0)})),(t,E,e)=>t.addEventListener(E,e));$88(["mousedown","mouseup","mousemove","keydown","keyup","visibilitychange"],E=>$5D(document,E,(...t)=>$81(E,...t))),$88(["resize","blur"],E=>$5D(window,E,(...t)=>$81(E,...t))),document.body.appendChild($D.$32);})()</script></body>