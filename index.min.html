<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>13 Drums</title><style>html,body{padding:0;margin:0;width:100%;height:100%;background:#202;cursor:none}canvas{width:100%;height:100%}</style><body><script>(()=>{let now=0,$A6=500,$97=144e3,D=0,$6F=0,$13=0,$64=0,measure=0,beat=0,bar=0,step=0,$49=!0,$35=1,$39=32;const{cos,sin,min,max,sqrt,floor,ceil,round,imul,abs,PI,sign}=Math,$1B=(t=0,E=t=>t)=>new Array(t).fill(0).map((t,E)=>E).map(E),$2F=([t,E],e)=>[t*cos(e)-E*sin(e),t*sin(e)+E*cos(e)],$55=([t,E,e],[s,i,n])=>[t+s,E+i,e+n],$92=([t,E,e],[s,i,n])=>[t-s,E-i,e-n],$7D=(t,E=1e3)=>round(t*E)/E,$50=(t,E)=>t<E?t/E:1,$40=(t,E)=>max(0,$50(t,E)),$6B=(t,E,e)=>E<t&&t<e,$23=(t,E=(t,E)=>t-E)=>t.sort(E),$51=([t,E],e=1)=>{e/=$62([t,E])||1;return[t*e,E*e]},$62=([t,E],[e=0,s=0]=[])=>sqrt((e-t)**2+(s-E)**2),$1=t=>(0<t?floor:ceil)(t),$2=t=>(t<0?floor:ceil)(t),$0=t=>sign(t)*round(abs(t)),$9E=2*PI,$42=$1B(128,t=>t?$9E/t:0),$3A=(...t)=>Object.assign(...t),$8B=(t,E)=>t.forEach?.(E),$5C=(t,E)=>t.map(E),$2A=(t,E)=>t.y-E.y||t.z-E.z||t.x-E.x,$80=t=>1+2.70158*(t-1)**3+1.70158*(t-1)**2,$87=t=>t*t*(2.70158*t-1.70158),$85=t=>1-cos(t*PI/2),$86=t=>-(cos(PI*t)-1)/2,$88=t=>sin(t*PI),$7F=t=>sin(t*$9E),$8A=2.5949095,$89=$9E/4.5,$26=()=>min(500/$97,.05),$31=t=>{let E=max(0,sin(t*$9E)),e=$26();return e<t&&t<=2*e?E+=2*$80((t-e)/e):2*e<t&&t<.5?E+=2:.5<=t&&t<.5+e&&(E+=2-2*$87((t-.5)/e)),E/3},$25=t=>2*$86($50(t,.5))-1,_WALK=t=>[(min(2*t,0)-(1-cos(t*$9E)))/2,-$85(-min(sin(t*$9E),0))/2],$7=t=>_WALK(t),$36=(t=0)=>{let s=0|t;return let=fn=()=>{var t=(s=s+2654435769|0)^s>>>16,t=imul(t,569420461);return t^=t>>>15,(((t=imul(t,1935289751))^t>>15)>>>0)/4294967296*2},$3A(fn,{$29:t=>void 0!==t?s=0|t:s,$69:(t=1)=>round(fn()*t),$A9:()=>1-2*fn(),sign:()=>$2(fn.$A9()),bit:()=>round(fn()),bool:()=>!!round(fn()),$27:t=>t.slice().sort(fn.$A9),$44:t=>t[$1(fn()*t.length)],$8F:(t,E)=>{var e=s;return s=0|(t??s),E(),s=e,t??e}})},$17=new Map,$18=t=>($17.has(t)||$17.set(t,new Set),$17.get(t)),$4D=(t,E)=>$18(t).add(E),$4F=(t,E)=>$18(t).delete(E),$84=(t,...E)=>$8B([...$18(t)],t=>t(...E)),$4C=(E,e)=>{let s=(...t)=>{$4F(E,s),e(...t)};$4D(E,s)};let $90=0;const Q=[32.7,36.71,41.2,43.65,49,55,61.74,65.41,73.42,87.31,98,110,130.81,174.61,196].map(t=>2*t),$11=32/27,$24=(t=0,E=0,e=16)=>{let s=t?e/t:0;return $23($1B(t,t=>floor(t*s+E+e)%e))},$21=()=>{let e=Q.slice(1,-1);return[[Q[0],.4,0,[0,3,8,11,14]],...$1B(13,t=>{let E=rand.$44(e);return e=e.filter(t=>t!==E),[E,.2*rand(),rand.$A9(),$24(1+rand.$69(),rand.$69(15))]})]},$5B=()=>[Q[0],...rand.$27(Q.slice(1,9))].slice(0,8).map(t=>2*t),$B0=(t,e,E,s,i,n=6)=>{const A=t.createOscillator();var T=t.createGain(),r=t.createStereoPanner();A.frequency.setValueAtTime(E/$11,i),$8B($24(n,2),(t,E)=>A.frequency.exponentialRampToValueAtTime(E%2?e*$11:e/$11,i+E/8)),T.gain.setValueAtTime(.1*E,i),T.gain.exponentialRampToValueAtTime(.5*E,i),T.gain.exponentialRampToValueAtTime(E,i+.325),T.gain.exponentialRampToValueAtTime(.01,i+2),r.pan.setValueAtTime(s,i),r.pan.exponentialRampToValueAtTime(-s,i+2),A.connect(T),T.connect(r),r.connect(t.destination),A.start(i),A.stop(i+2)},$AA=(t,E,e,s,i,n,A)=>{var T=t.createOscillator(),r=t.createGain(),a=t.createStereoPanner(),R=t.createDynamicsCompressor(),n=n||e;T.frequency.setValueAtTime(E,i),T.frequency.exponentialRampToValueAtTime(E/1.5,i+.5),r.gain.setValueAtTime(.1,i),r.gain.exponentialRampToValueAtTime(n,i+1/32),r.gain.exponentialRampToValueAtTime(n/5,i+.1/16),r.gain.linearRampToValueAtTime(0,i+.5),a.pan.setValueAtTime(A??s,i),R.threshold.setValueAtTime(-50,i),R.knee.setValueAtTime(40,i),R.ratio.setValueAtTime(12,i),R.attack.setValueAtTime(0,i),R.release.setValueAtTime(.25,i),T.connect(r),r.connect(a),a.connect(R),R.connect(t.destination),T.start(i),T.stop(i+.51)},$34=(t,E,e=0,s)=>{var i=.05+.03*rand(),n=1/8+rand()/16,A=t.createOscillator(),T=t.createGain(),r=t.createStereoPanner();A.type="triangle",A.frequency.setValueAtTime(E,s),T.gain.setValueAtTime(i/2,s),T.gain.exponentialRampToValueAtTime(i,s+n/2),T.gain.exponentialRampToValueAtTime(.01,s+n),r.pan.setValueAtTime(e,s),A.connect(T),T.connect(r),r.connect(t.destination),A.start(s),A.stop(s+n)},$22=()=>{let n=new AudioContext,t=-$7D(D/4e3,10)%1,A=t,e=[0],T=[],s=[];var E=(t,E)=>{T=t||$21(),s=E||$5B()},i=()=>{n.currentTime+.25<A||A<0||($B0(n,s[0]||2*Q[rand.$69(6)],.3,.5*rand.$A9(),A,floor(A-t)%3+4),s.push(s.shift()),$8B(e,t=>{const[E,e,s,i]=T[t];$8B(i,t=>$AA(n,E,e,s,.25*t+A))}),A+=4)};return setInterval(i,100),$4D("rattle",(t=0)=>{$34(n,($10%2?rand.$44(s.slice(0,3)):s[7-(beat+measure%8)%8])||Q[0],"number"==typeof t?t:0,n.currentTime)}),$4D("beat",()=>{var[,t,E,,]=T[0];$AA(n,Q[14],t,E,n.currentTime)}),$4D("pause",()=>{"running"===n.state&&$49?n.suspend():"suspended"!==n.state||$49||n.resume()}),E(),i(),{fresh:E,n:A,get track(){return T},get voices(){return e},get melody(){return s},sing:(t=[],E)=>{e=[0,...t],s=E||s}}},$4A=($2B=({$6:t=window.innerWidth,$70:E=window.innerHeight,os:s=!1}={})=>{let i=s?null:document.createElement("canvas"),n=(i&&(i.width=t,i.height=E),s?new OffscreenCanvas(t,E):i.transferControlToOffscreen()),T=n.getContext("2d");n.width=t,n.height=E;const r={get $A(){return n.width},get $9(){return n.width/2},get $8(){return n.width/3},get $73(){return n.height},$72:n.height/2,get $71(){return n.height/3},get $38(){return min(r.$71,r.$8)},get Rm(){return min(r.$73,r.$A)},get $30(){return max(r.$73,r.$A)},$9A:n,$33:i,ctx:T,$32:(t,E)=>{var e;s||(e=document.createElement("canvas"),i.replaceWith(e),(i=e).width=t,e.height=E,n=i.transferControlToOffscreen(),T=n.getContext("2d"),$3A(r,{$9A:n,ctx:T,$33:i})),n.width=t,n.height=E,r.$72=n.height/2},$8F:t=>(T.save(),t(r),T.restore(),r),E:()=>(T.clearRect(0,0,r.$A,r.$73),r),center:()=>(r.T(r.$9,r.$72),r),$79:(t="none")=>(T.filter=t,r),T:(t,E)=>(T.translate(t,E),r),R:(t,E)=>(T.rotate(t,E),r),M:(...t)=>(T.moveTo(...t),r),L:(...t)=>(T.lineTo(...t),r),A:(t=0,E=0,e=1,s=0,i=$42[1],n=!1)=>(T.arc(t,E,e,s,i,n),r),B:(...t)=>(T.bezierCurveTo(...t),r),P:t=>(T.beginPath(),t?.match(/[MLABCTREOSFW](?:\s*-?\d+(?:\.\d+)?|\s*#[a-f0-9]{3,8}|\s*hwb\([^)]+?\))*/g).forEach(t=>{var[t,...E]=t.includes("(")?[t[0],t.slice(1).trim()]:t.split(" ");r[t](...$5C(E,t=>"#"===t[0]||t.includes("(")?t:parseFloat(t,10)))}),r),C:()=>(T.closePath(),r),O:t=>(T.globalAlpha=t,r),S:(t=1,E=1)=>(T.scale(t,E),r),$74:(e,s)=>$8B(s,(t,E)=>e.addColorStop(E/s.length,t)),$77:(t,E,e,s,i)=>{t=T.createLinearGradient(t,E,e,s);return r.$74(t,i),t},$76:(t,E,e,s,i,n,A)=>{t=T.createRadialGradient(t,E,e,s,i,n);return r.$74(t,A),t},F:t=>(T.fillStyle=t,T.fill(),r),$7A:(t,E)=>(T.fillStyle=t,T.fill(E),r),W:(t,E)=>(T.strokeStyle=t,T.lineWidth=E,T.stroke(),r),$4:(t,E,e)=>(T.strokeStyle=t,T.lineWidth=E,T.stroke(e),r),$6C:(...t)=>T.drawImage(...t)};return r.E(),r},()=>{const A=new Path2D;return A.M=(...t)=>(A.moveTo(...t),A),A.L=(...t)=>(A.lineTo(...t),A),A.A=(t=0,E=0,e=1,s=0,i=$42[1],n=!1)=>(A.arc(t,E,e,s,i,n),A),A.$AB=(...t)=>(A.arcTo(...t),A),A.B=(...t)=>(A.bezierCurveTo(...t),A),A.Q=(...t)=>(A.quadraticBezierCurveTo(...t),A),A.C=()=>(A.closePath(),A),A}),$F=(t,E)=>$2B({$6:t,$70:E||t,os:!0}),$16=(t=32,E="#840")=>{const e=$F(3*t),s=t/4,i=1.4*t;return e.$8F(()=>{e.E().center().P().A(0,0,t).C().F(E).P().M(-i,-s).L(i,-s).M(-i,s).L(i,s).M(-s,-i).L(-s,i).M(s,-i).L(s,i).W(E,3)}),{R:1.5*t,D:3*t,get $6C(){return e.$9A}}},$5D=(Array.$94=()=>[],(a,d,m={},p="$82")=>{const dd=window[p].$94?.()??[],o=dd.length,dv=$5C(d,([,t])=>"function"==typeof t?t.toString().replace(/^\(\) ?=> ?/,""):JSON.stringify(t)).join(","),e=`window.${a}=class ${a} extends ${p}{`+`static $94=()=>[...${p}.$94(),${dv}];`+`constructor(...x){super(...(x.length ? x : ${a}.$94()))}`+"*[Symbol.iterator]() {for(let i = 0,l=this.length;i<l;i++){yield this[i]}}"+$5C(d,([t],E)=>`  get ${t}(){return this[${E+o}]} set ${t}(x){return this[${E+o}]=x}`).join("")+$5C(Object.values(m),t=>t.toString()).join("")+"};";return eval(e)}),$3=$1B(1280,t=>4/((t+1)/10)*5).reduce((t,E,e)=>t.set((e+1)/10,E),new Map),$6D=($5D("$82",[["x",0],["y",0],["z",0],["age",0],["$AD",[]],["$29",null]],{$9B(){return new this.constructor(...this)},$55(t){return[this.x,this.y,this.z]=$55(this,t),this},$2F(t){return[this.x,this.y]=$2F(this,t),this},$92(t){return new $82(...$92(this,t))},$3E(){return $5C([this.x,this.y,this.z],round)},$51(t=1){return[this.x,this.y]=$51([this.x,this.y],t),this},$2D(t=1){return this.$51(this.$62()*t),this},$62(){return $62([this.x,this.y])},$3D(t){var[E,e,s]=this.$46();return t.S(s,s),t.T(E,e),this},$46(){var[t,E,e]=this.$92($A5),s=E<0?4/-E*5:0;return[t*=4,E=4*e*s,s]},$3C(t=1){var[E,e,s]=this.$46(),i=(E*=s*$39,e*=s*$39,t?2*-$39*s:0);return new $82(E+$D.$9,e+$D.$72+i,2*s*(t?$39:1))},$9D(){var[t,E,e]=this.$3C();return $4A().A(t,E,abs(e)).C()},$C(t){},$12(){},$8E(){}},"Array"),$5D("$8D",[["$6E",null],["$4E",[]],["$8F",()=>{}]]),$5D("$14",[["$13",0],["$9F",{}],["$15",null],["$1E",null],["$1C",null],["$C",()=>{}]],{},"Array"),{w:0,a:0,s:0,d:0}),$28=($5D("$AF",[["shell",null],["$20",0],["$54",0],["$91",1],["$4B",1],["$59",()=>new $82],["$6A",()=>new $82],["$E",()=>new $82(1,1,0)],["$2C",[]],["w",0],["a",0],["s",0],["d",0],["$1F",2],["$67",[]],["$8C",[]],["$63",0],["$3B",[0,0,0]]],{$83(){return this.$20?abs(this.$20):0},$1D(){var t=this.$54%1;return t*=this.$59.$62?.()||$6B(t,1/32,31/32)?1:0,(this.$91<0?1-t:t)%1},$99(){return this.$1D()?$50(this.$1D()%.5,.5)%1:1-bar%.5*2%1},$C(t){t/=1e3;this.$1D(),this.$83();let{w:E,a:e,s,d:i}=this;var n=round(this.x)+128,A=round(this.y)+128,T=this.$2C.filter(t=>t.$13<=$13),T=(T.length?($8B(T,t=>{var E,e;t.$1E=t.$1E||t.$13,t.$15?($62(this,t.$15),.5<t.$15.$9B().$2D(-1).$55(this).$62()?(t.$13=$13,E=abs(this.x-t.$15.x),e=abs(this.y-t.$15.y),E=$50(E,1)>3/8?1:0,e=$50(e,1)>3/8?1:0,$3A(t.$9F,this.x>t.$15.x?{a:E,d:0}:{a:0,d:E},this.y>t.$15.y?{w:e,s:0}:{w:0,s:e})):(t.$1C=t.$13,this.$2C.push(new $14($13+1,$6D,null),new $14($13+12,$6D,null)))):(t.$13=-1,t.$1C=$13),$3A(this,t.$9F)}),T.length&&({w:E,a:e,s,d:i}=this),this.$2C=this.$2C.filter(t=>!t.$1C||t.$1C>$13)):$3A(this,{w:0,a:0,s:0,d:0}),this.$6A=new $82(-e+i,-E+s,0),this.$91=sign(this.$6A.x||this.$91),this.$4B=sign(this.$6A.y||this.$4B),new $82(...this.$6A)),r=new $82(...this.$59),a=this.$99();if(0===T.$62()&&$6B(r.$62(),1/16,a)&&T.$55(new $82(...this.$E).$51((1-a)/2)),T.$51(4*t),this.$6A.$62()){const s=.75+$50(T.$9B().$51(2).$55(r.$9B().$51(1)).$62(),3)/4;r.$2D(s)}r.$55(T),r.$51(min(r.$62(),this.$1F));var R,T=(this.$59=r).$62(),h=new $82(...r);h.$51(h.$62()*t);const S=$55(this,h);this.$AD.length&&!this.$AD.find(t=>$62($92(t,S))<t.$37)&&h.$2D(-.5);let P=round(this.x+h.x)+128,O=round(this.y+h.y)+128;if(n===P&&A===O||((R=world.$75[O][P])&&R!==this&&(h.$2D(-.5),P=round(this.x+h.x)+128,O=round(this.y+h.y)+128),world.$75[A][n]=null,world.$75[O][P]=this),this.$55(h),this.$54+=h.$62(),this.$20=T*this.$91,this.$E=T?r.$9B().$51(1):this.$E,this.$6A.$62()<.25&&r.$62()&&r.$2D(this.$99()<1/8?0:$40(1-2*t,1)),0===r.$62()&&this.$1D()&&a&&(r.$2D(0),this.$54=round(2*this.$54)/2),this===$41){const s=floor(this.$54/.25);s>this.$63&&$84("rattle",this.$E.x/-2),this.$63=s}this.$3B=this.$3C()},$12(){var t;this.$2C?.length||(t=this.$AD[0],this.$2C=[new $14($13,{},t.$9B().$55(new $82(0,2+rand.$69(t.$37-2),0).$2F(rand()*$9E)))])}},"$82"),({$93:E=512,$8C:i=[]}={})=>{const n=$F(E),s=E/2,A=E/12,e={R:s,$93:E,$8C:i,$8E:(t=n)=>(t.$8F(()=>{let e=5.6*A;t===n&&t.E().center(),t.P().A(0,0,s).C().F(t.$76(0,2*A,4*A,0,0,E,["#242","#262"])),n.P().A(0,0,e),$1B(28,t=>{var[t,E]=$2F([1,0],$42[28]*(t-.5)-$42[4]);n.M(t*e,E*e).L(t*s,E*s)}),n.W(n.$76(0,2*A,3*A,0,0,E,["#3536","#4846"]),2),$1B(13,t=>{let E=0,e=(t-11)*A*2.25;var s;t<10&&(s=$42[10]*(t-2),[E,e]=$2F([4.5*A,0],s)),n.P().A(E,e,A).C().F("rgba(127,127,127,0.25)"),i[t]&&n.P().A(E,e,A).C().F("#aa9")})}),t.$9A),add(t){i.push(t),e.$8E()},get $6C(){return n.$9A}};return e.$8E(),e}),$47=new Map,$D=($5D("$48",[["$9C",()=>`hwb(${round(30+10*rand.$A9()-2)} ${round(0+10*rand())}% ${round(47+10*rand())}%)`],["$19",()=>`hwb(${round(30+2*rand.$A9()-2)} 0% ${round(67+4*rand())}%)`]],{$4A(t,E,e,s,i){var n,A,T,r,a,R,[t,E,e,s,i]=[$7D(t,4),$7D(E,64),e,s,$7D(i[0],4)],s=[t,E,e,s,i].join();return $47.has(s)||(n=$7F(E)/8,A=t?t/8:$7F(E)/16,T=$88(E)/8,abs(t/16),[E,r]=[t?$7(E):[0,0],t?$7(1-E):[0,0]],[[E,r],[a,R]]=[E,r],i=sqrt(abs(i)/(abs(t)||1)),$47.set(s,$4A().A(0+A*i,T-3,1,$9E[4],$9E).M(0+A*i,T-2).L(2+a/3,n*e-1.5).L(1+E/16,n*e-1).L(1+E*i,r).L(0,T-1).L(-1-a*i,R).L(a/16-1,-1-n*e).L(-2-E/3,-1.5-n*e).C())),$47.get(s)},$8E(A,T=bar%.5*2,r=!0){A.$8F(()=>{r&&this.$3D(A);var t=this.$1D()%.5,t=t?$50(t%.5,.5):1-T,E=this["$20"];let e=E?E/8:$7F(t)/16,s=$88(t)/8,i=abs(E/16);const n=sqrt(abs(this.$59[0])/(abs(E)||1));this.shell&&0<this.$4B&&A.P().A(0-e*n/2,-1.75-s/2+i,7/8).C().W("#242",1/16).F("#131");E=this.$4A(this.$20,t,this.$91,this.$4B,this.$59);A.$4(this.$19,1/8,E).$7A(this.$9C,E),this.shell&&(this.$4B<0||$49)&&A.$8F(()=>{var t,E;A.P().A(0-e*n/2,-1.75-s/2+i,7/8).C(),this===$41&&A.F("#554"),A.W("#242",1/16),A.T(0-e*n/2,-1.75-s/2+i),A.R(this.$59[0]/16),A.$6C(this===$41?world.$5C.$9A:shell.$6C,-1,-1,2,2),this===$41&&([t,E]=$5C($41.$3E(),t=>t/128),A.P().A(t,E,1/32).C().F(this.$9C))})})}},"$AF"),$5D("$95",[],{$8E(n){n.$8F(()=>{this.$3D(n),n.S(this.$91,1);var t=this.$20,[E,e]=t?$7(this.$99()):[0,0],[s,i]=t?$7(1-this.$99()):[0,0],[[s,i],[E,e]]=0<this.$91?[[E,e],[s,i]]:[[s,i],[E,e]],t=sqrt(abs(this.$59[0])/(abs(t)||1));n.P().M(1,i/4-2).L(0-E*t,0+e).L(0,i/4-1).C().M(-1,e/4-1).L(s*t-1,0+i).L(-2,e/4-1.5).C().F("#520"),n.P().M(1,i/4-3).L(2,i/4-2).L(1,i/4-2).L(1+s*t,0+i).L(0,i/4-1).L(-1,e/4-1).L(-2-E*t,0+e).L(-2,e/4-1.5).L(-1.75,e/4-1.75).L(-2,e/4-2).L(0,i/4-2).L(.5,i/4-2.5).L(0,i/4-3).C().W("#620",1/8).F("#840"),n.P().A(1,i/4-4,1,$42[2],1,!0).W("#620",.125)})}},"$AF"),$5D("$A8",[],{$8E(n,t,E,e){n.$8F(()=>{this.$3D(n),n.S(this.$91,1);var t=this.$20,[E,e]=t?$7(this.$99()):[0,0],[s,i]=t?$7(1-this.$99()):[0,0],[[s,i],[E,e]]=0<this.$91?[[E,e],[s,i]]:[[s,i],[E,e]],t=sqrt(abs(this.$59[0])/(abs(t)||1));n.P().M(1,i/4-2).L(0-E*t,0+e).L(0,i/4-1).C().M(-1,e/4-1).L(s*t-1,0+i).L(-2,e/4-1.5).C().F("#520"),n.P().M(2,i/4-2).L(2,i/4-1).L(1.5,i/4-.5).L(1,i/4-1).L(1+s*t,0+i).L(0,i/4-1).L(-1,e/4-1).L(-2-E*t,0+e).L(-2,e/4-1.5).L(-1.75,e/4-1.75).L(-2,e/4-2).L(0,i/4-3).L(1,i/4-2.25).L(1.5,i/4-2.5).C().stroke("#620",1/8).F("#840"),n.P().A(2,i/4-2.25,.75,$42[2],$42[2]+$42[7]).stroke("#620",.125)})}},"$AF"),$5D("$58",[["$45",0],["$37",32],["$9C","#ccf"],["$19","#ccf4"]],{$8E(A){A.$8F(()=>{var t,E,{$45:e,$37:s}=this,i=s-1,n=1.3*s;e&&(t=$1(cos($42[28]*e)*n),E=e<14?t:-n,e=14<e?-t:n,A.P().M(0,i).B(e,s,e,-s,0,-i).B(E,-s,E,s,0,i).C().F(this.$9C)),A.P().A(0,0,i).C().W(this.$19,s/16)})},$61(){return abs(sin($42[2]*this.$45/28))}},"$82"),$5D("$AD",[["$9C",()=>`hwb(${120+rand.$69(25)} ${10+rand.$69(5)}% ${round(65+rand.$69(5))}%)`],["$37",16],["$3F",[]],["$81",[]],["$65",[]],["$B",0],["$96",null]],{$78(E=16){this.$37=E;rand();return this.$3F=$1B(16,t=>new $82(0,-E,0).$2F($42[16]*(t+rand()/4))),this},$C(E){var t=this.$37+1,[e]=new $82(-t,-t,0).$55(this).$3C(),[t]=new $82(t,-t,0).$55(this).$3C();this.$B=t<=0||e>=$D.$A?0:1,$8B(this.$65,t=>t.$C(E))},$8E(T){if(this.$B)return T.$8F(()=>{let A=0,t=new $82;var E=$5C(this.$3F,(e,s)=>{t.splice(0,t.length,...e);var[e,i,n]=t.$55(this).$46();if(n){A=max(A,n);let t=e*n,E=i*n;return()=>(s?T.L:T.M)(t,E)}return()=>{}});T.P(),$8B(E,t=>t()),T.C().O(.25).F(this.$9C).W(this.$9C,2/32),T.P(`M ${$7D(l)} ${$7D(u)} L ${$7D(r)} ${$7D(u)} W #0f0 4`)}),T.$9A}},"$82"),$5D("$43",[["$4A",""],["$D",null],["$6",0],["$70",0],["$52",0],["$9C",()=>`hwb(${round(150+2*rand.$A9())} ${round(7+5*rand())}% ${round(80+4*rand.$A9())}%)`]],{$78(t){return this.$29=rand.$8F(this.$29,()=>{const n=min(8,this.$AE=t||this.$AE||4*rand()+3),A=ceil(n);let T=0,r=0,a=0;this.$4A=$1B(A,t=>{var E=(n-t)/(n-t+3),e=T-E/.125,s=E*(A-t),i=T+E+.5,t=$50(n-t,A),E=$7D(rand.$A9()*t*E/2),s=(r=max(s,r),`M ${E} ${$7D(e)} L ${$7D(-s)} ${$7D(i)-rand()*t} L ${$7D(a)} ${$7D(T+.25)} L ${$7D(s)} ${$7D(i)-rand()*t} L ${E} `+$7D(e));return a=E,T=e,s}).join(" ")+` F ${this.$9C} S #1218`,this.$6=ceil(2*r),this.$70=ceil(abs(T)),this.$D=$2B({$6:this.$6*$39*4,$70:this.$70*$39*4,os:!0}),this.$D.$8F(t=>t.S($39,$39).T(this.$6/2,this.$70).P(this.$4A))}),this},$8E(t){if(this.$D)return t.$8F(()=>{this.$3D(t),t.$6C(this.$D.$9A,-this.$6/2,-this.$70,4*this.$6,4*this.$70)}),this},$C(t){this.$52=this.$52||4+rand.$69(284),$13>=this.$52&&(this.$78(this.$AE+(rand()+1)/8),this.$52=$13+576)}},"$82"),$5D("$7B",[["$D",null],["$45",0],["$9C",()=>`hwb(${round(180+4*rand.$A9())} ${round(30+5*rand())}% ${round(55+4*rand.$A9())}%)`],["$64",-1],["$6",4],["$70",4],["$A7",!1]],{$78(t){const e=this.$A7,s=(this.$D=this.$D??$F(this.$6*$39*4,this.$70*$39*4),rand.$A9()/4);var E=e?-2:-1.5;const i=rand()/8,n=E+i;return this.$D.$8F(t=>{var E;t.E().S($39,$39).T(this.$6/2,this.$70).P().M(-1.5-s,0).B(-2.5,-3,-1,-3,s,i-2).B(1,-3,2.5,-3,1.5+s,0).C().F(this.$9C).P().M(0,0).B(2*-s,-i,4*s,n,s,n).W("#0002",1/8),t.P().A(s,n,e?.75:1/8).F(`hwb(${round((180/28*this.$45+240+rand.$A9()/4)%360)} ${round(10+25*rand())}% 5%)`),this.$A7&&(E=$3A(new $58,{$37:10,$45:this.$45,$9C:"#ccf",$19:"#000a"}),t.O(.5).T(1.25*s,n).S(1/16,1/16),E.$8E(t))}),this},$8E(t){if(this.$D)return t.$8F(()=>{this.$3D(t),t.$6C(this.$D.$9A,-this.$6/2,-this.$70,4*this.$6,4*this.$70)}),this},$C(t,E,e){var E=E??moon?.$45,e=e??$6F;return E!==this.$64&&.5<=e&&(e=((this.$64=E)+28-this.$45)%28<3,this.$A7=e,this.$78(E)),this},$A0(){return this.$A7},$68(){var t=$3A(this.$9B(),{$D:null});$41.$67.push(t.$78()),this.$A7}},"$82"),$5D("$7E",[],{},"$82"),$5D("$5",[["$29",13],["$AE",0],["$58",[]],["$8C",[]],["$75",()=>$1B(256,t=>$1B(256,t=>null))],["$AC",[]],["$5C",null],["$7C",null],["$1A",[]],["$81",[]],["$65",[]]],{$78(t){this.$5C=this.$5C||$2B({$6:256,$70:256,os:!0}),this.$7C=this.$7C||$2B({$6:256,$70:256,os:!0}),this.$29=t,rand.$29(t),console.log("Generating world and setting $29",t,rand.$29());this.$57=$1B(28,t=>(new $AD).$78(12).$55([96,0,0]).$2F(t*$42[28]-$42[4])),this.$8C=$1B(13,t=>t<10?(new $AD).$78(18).$55([80,0,0]).$2F($42[10]*(t+2.5)):(new $AD).$78(18).$55([0,16*(t-11)*2.5,0])),this.$AC=[...this.$57,...this.$8C],$8B(this.$57,(e,t)=>{e.$53="moon "+t,$8B(e.$3F,E=>{var t;this.$AC.filter(t=>E.$9B().$55(e).$92(t).$62()<=t.$37+.05).length<2&&((t=(new $43).$78().$55(e).$55(E)).$AD.push(e),e.$65.push(t),this.$65.push(t))});t=$3A(new $7B,{x:e.x,y:e.y,$45:t}).$C(0,0,.5);e.$65.push(t),this.$65.push(t)}),$8B(this.$8C,(E,t)=>{$1B(3,t=>{t=(new $48).$55(E.$9B().$55(new $82(0,6+rand.$69(6),0).$2F($42[3]*(t+rand.$A9()/8))));E.$81.push(t),t.$AD.push(E)})}),this.$81.push(...$5C(this.$AC,t=>t.$81).flat().sort($2A)),this.$5C.$8F(s=>{s.E().center(),$8B(this.$AC,e=>{s.P(),$8B(e.$3F,(t,E)=>(E?s.L:s.M)(t[0]+e.x,t[1]+e.y)),s.C().F(s.$76(0,90,90,0,0,256,["#242","#262"])).O(.25).W(s.$76(0,184,276,0,0,256,["#353","#484"]),1).O(1)})}),this.$7C.P().A(128,128,108).W("#202",16).C().P().A(128,112,48).F(this.$7C.$76(128,128,32,128,128,256,["hwb(250deg 14% 57%)","hwb(220deg 65% 12%)"])),this.$7C.$6C(this.$5C.$9A,0,0,256,256);const e=$3A(new $58,{$37:10});return $8B(this.$57,(E,t)=>{$3A(e,{$45:t}),this.$7C.$8F(t=>{t.T(128+E.x,128+E.y).O(.875).P().A(0,0,E.$37).F(E.$9C).O(.125),e.$8E(t)})}),this.$7C.$8F(t=>{t.center(),console.log(`Plotting ${this.$65.length} landscape items`),$8B(this.$65.filter(t=>!(t instanceof $7B)),t=>this.$7C.P().A(t.x,t.y+.5,1.25).F(t.$9C))}),$8B([...this.$81,...this.$65,$41],t=>{t.y=$0(t.y),t.x=$0(t.x),this.$75[t.y+128][t.x+128]=t}),this},$2E(){},$5F(){},$C(E){return $41.$AD=this.$AC.filter(t=>$62($92(t,$41))<t.$37),$8B(this.$AC,t=>t.$C(E)),this},$8E(E){var e=-E.$9/$39,s=E.$A/$39;for(let t=0;t<=256&&!(t>$A5.y+132);t+=1){var i=new $82($A5.x,t-128,0).$3C(0),n=i[2];if(0===n)break;var A=n*$39*2,T=max(0,floor($A5.x+128-E.$9/A)-4);min(256-T,ceil(E.$A/A)+8);E.$6C(this.$7C.$9A,$A5.x+128-E.$9/A,t,E.$A/A,1,e,(i[1]-E.$72)/$39,s,2*n),$8B($23(this.$75[t].filter(t=>t),$2A),t=>t.$8E(E))}return E.$9A}},"$82"),$2B());let moon=new $58,sun=$16(32,"#ffd"),rand=$36(13),stars=$1B(91,()=>[rand.$A9(),rand.$A9()]),shell=$28(),$41=$3A(new $48,{x:0,y:104,z:0,shell:shell,$4B:-1,$9C:"#840",$19:"#620"}),$56=new $82,world=($56.$4A=$4A().M(-2,-2).L(2,2).L(-2,2).L(2,-2).C(),(new $5).$78(13)),entities=[],$A4=20,$A2=-2,$A3=4,$A1=-1/8,$A5=new $82($41.x,$41.y+$A3,$41.z+$A1);const $10=E=>{$49||(D+=E*$35,$98=floor(D/$97),$6F=D%$97/$97,measure=floor(D/4e3),bar=D%4e3/4e3,beat=floor(8*bar),$13=floor(D/250),$64!==$13&&$84("tick"),$64=$13,step=D%$A6/$A6,$66.change&&$41.$2C.unshift($3A(new $14,{$13:$13,$9F:$66.$55})),$66.shift?$41.$1F=4:$41.$1F=2,world.$C(E),$41.$C(E),$8B(world.$81,t=>t.$C?.(E))),$A5.x+=($41.x-$A5.x)/16,$A5.y+=($41.y+($49?$A3:$A4)-$A5.y)/16,$A5.z+=($41.z-$A5.z+($49?$A1:$A2))/16};let $5A=$1B(256,t=>[t,t]).flat().map(t=>t/$39);const $5E=(t=0)=>{performance.now();var E=t-now;now=t,$10(E*$35);const{$73:e,$72:T,$71:s,$A:i,$9:r,$8:n,$38:a,$30:R}=$D;t=$6F,E=t;const h=(t+.5)%1;moon.$45=D?floor((28+(D-$26()*$97)/$97)%28):0;let S=$25(E)*n;const P=$31(E);let O=$25(h)*n;const I=$31(h);.5<t?S=-O:O=-S;let L;$D.$8F(()=>{if($D.E(),$D.ctx.fillStyle=.1<P?"#840":"#202",$D.ctx.fillRect(0,0,i,e),$D.center(),.25<I){const A=s-I*s*2;$8B(stars,([t,E])=>{var e=t*r,s=(E-h)*T,i=$50($62([O,A],[e,s]),4*moon.$37),n=1+.5*sin((7.3*E+now%$97/$97+1.1*t)*$9E),E=(1+n)**2*max(0,sin(7.3*E+now/$97*130+11*t)**3);$D.O(max(0,1-moon.$61()/2-(i<.25?1:1-i))).P().A(e,s,n).F("#ffd").C(),$D.P().M(e,s-E).L(e,s+E).M(e-E,s).L(e+E,s).W("#ffd",.5)}),L=`rgba(204,204,255,${$7D(.1*moon.$61())})`,$D.O(max(0,I)).P().A(O,A,2*R).C().F($D.$76(O,A,a*moon.$61(),O,A,2*a,[`rgba(204,204,255,${$7D(.05+.2*moon.$61())})`,L,L,"rgba(24,0,24,0)"])).T(O,A),moon.$8E($D),L="#ccf6"}.25<P&&($D.O(max(0,P)),L="#aae6",$D.P().A(S,s-P*s*2,2*R).C().F($D.$76(S,s-P*s*2,sun.R*max(P,0),S,s-P*s*2,R,["#fff","#aae","#aaec","rgba(170,170,238,0)"])).$6C(sun.$6C,S-sun.R,s-P*s*2-sun.R,sun.D,sun.D))}),$D.$8F(()=>{$D.T(r,T),$D.S($39,$39),world.$8E($D)}),$D.$8F(()=>$D.T($56.x-2,$56.y-2).S(4,4).R($9E*$7F(now%4e3/4e3)).$7A("#2808",$56.$4A)),requestAnimationFrame($5E)},$66=($5E(0),{w:0,a:0,s:0,d:0,get change(){return this.w+this.a+this.s+this.d},get $55(){var{w:t,a:E,s:e,d:s}=this;return{w:t,a:E,s:e,d:s}}}),$60=($4C("mousedown",()=>{$49=!1,$90=$22()}),$4D("keydown",t=>{$84("input");t=t.key.toLowerCase();$66[t]=1,$84("key-"+t),"escape"===t&&($49=!$49,$84("pause"))}),$4D("keyup",t=>$66[t.key.toLowerCase()]=0),$4D("mousedown",()=>$84("input")),$4D("mousemove",({clientX:t,clientY:E})=>$3A($56,{x:t,y:E})),$4D("resize",()=>{$D.$32(window.innerWidth,window.innerHeight)}),$8B(["visibilitychange","blur"],t=>$4D(t,()=>{$49=!0,$84("pause"),$8B(Object.keys($66),t=>$66[t]=0)})),(t,E,e)=>t.addEventListener(E,e));$8B(["mousedown","mouseup","mousemove","keydown","keyup","visibilitychange"],E=>$60(document,E,(...t)=>$84(E,...t))),$8B(["resize","blur"],E=>$60(window,E,(...t)=>$84(E,...t))),document.body.appendChild($D.$33);})()</script></body>