<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>13 Drums</title><style>html,body{padding:0;margin:0;width:100%;height:100%;background:#202;cursor:none}canvas{width:100%;height:100%}</style><body><script>(()=>{let now=0,$1=500,$4=144e3,D=0,$HA=0,$r=0,$LA=0,measure=0,beat=0,bar=0,step=0,$PB=!0,$0A=1,$n=32;const{cos,sin,min,max,sqrt,floor:$oA,ceil,round:$xA,imul,abs,PI,sign:$4A}=Math,$XB=(t=0,E=t=>t)=>new Array(t).fill(0).map((t,E)=>E).map(E),$o=([t,E],e)=>[t*cos(e)-E*sin(e),t*sin(e)+E*cos(e)],$RA=([t,E,e],[T,s,A])=>[t+T,E+s,e+A],$z=([t,E,e],[T,s,A])=>[t-T,E-s,e-A],$b=(t,E=1e3)=>$xA(t*E)/E,$L=(t,E)=>t<E?t/E:1,$j=(t,E)=>max(0,$L(t,E)),$K=(t,E,e)=>E<t&&t<e,$6A=(t,E=(t,E)=>t-E)=>t.sort(E),$UA=([t,E],e=1)=>{e/=$f([t,E])||1;return[t*e,E*e]},$f=([t,E],[e=0,T=0]=[])=>sqrt((e-t)**2+(T-E)**2),$1B=t=>(0<t?$oA:ceil)(t),$GB=t=>(t<0?$oA:ceil)(t),$2B=t=>$4A(t)*$xA(abs(t)),$IB=2*PI,$vA=$XB(128,t=>t?$IB/t:0),$m=(...t)=>Object.assign(...t),$BA=(t,E)=>t.forEach?.(E),$h=(t,E)=>t.map(E),$uB=(t,E)=>t.y-E.y||t.z-E.z||t.x-E.x,$a=t=>1+2.70158*(t-1)**3+1.70158*(t-1)**2,$7=t=>t*t*(2.70158*t-1.70158),$8=t=>1-cos(t*PI/2),$CA=t=>-(cos(PI*t)-1)/2,$mA=t=>sin(t*PI),$EA=t=>sin(t*$IB),$5=2.5949095,$6=$IB/4.5,$lB=()=>min(500/$4,.05),$iB=t=>{let E=max(0,sin(t*$IB)),e=$lB();return e<t&&t<=2*e?E+=2*$a((t-e)/e):2*e<t&&t<.5?E+=2:.5<=t&&t<.5+e&&(E+=2-2*$7((t-.5)/e)),E/3},$6B=t=>2*$CA($L(t,.5))-1,_WALK=t=>[(min(2*t,0)-(1-cos(t*$IB)))/2,-$8(-min(sin(t*$IB),0))/2],$cA=t=>_WALK(t),$wA=(t=0)=>{let T=0|t;return let=fn=()=>{var t=(T=T+2654435769|0)^T>>>16,t=imul(t,569420461);return t^=t>>>15,(((t=imul(t,1935289751))^t>>15)>>>0)/4294967296*2},$m(fn,{$3A:t=>void 0!==t?T=0|t:T,$e:(t=1)=>$xA(fn()*t),$u:()=>1-2*fn(),$4A:()=>$GB(fn.$u()),bit:()=>$xA(fn()),bool:()=>!!$xA(fn()),$5B:t=>t.slice().sort(fn.$u),$XA:t=>t[$1B(fn()*t.length)],$c:(t,E,e,T,s,A)=>`hwb(${$xA(t+fn.$u()*E)} ${$xA(e+fn.$u()*T)}% ${$xA(s+fn.$u()*A)}%)`,$W:(t,E,e=1)=>[t+fn.$u()*e,E+fn.$u()*e],$B:(t,E)=>{var e=T;return T=0|(t??T),E(),T=e,t??e}})},$8A=new Map,$p=t=>($8A.has(t)||$8A.set(t,new Set),$8A.get(t)),$N=(t,E)=>$p(t).add(E),$i=(t,E)=>$p(t).delete(E),$DA=(t,...E)=>$BA([...$p(t)],t=>t(...E)),$VA=(E,e)=>{let T=(...t)=>{$i(E,T),e(...t)};$N(E,T)};let $A=0;const Q=[32.7,36.71,41.2,43.65,49,55,61.74,65.41,73.42,87.31,98,110,130.81,174.61,196].map(t=>2*t),$DB=32/27,$5A=(t=0,E=0,e=16)=>{let T=t?e/t:0;return $6A($XB(t,t=>$oA(t*T+E+e)%e))},$vB=()=>{let e=Q.slice(1,-1);return[[Q[0],.3,0,[0,3,8,11,14]],...$XB(13,t=>{let E=rand.$XA(e);return e=e.filter(t=>t!==E),[E,.2*rand(),rand.$u(),$5A(1+rand.$e(),rand.$e(15))]})]},$OB=()=>[Q[0],...rand.$5B(Q.slice(1,9))].slice(0,8).map(t=>2*t),$Y=(t,e,E,T,s,A=6)=>{const i=t.createOscillator();var n=t.createGain(),r=t.createStereoPanner();i.frequency.setValueAtTime(E/$DB,s),$BA($5A(A,2),(t,E)=>i.frequency.exponentialRampToValueAtTime(E%2?e*$DB:e/$DB,s+E/8)),n.gain.setValueAtTime(.1*E,s),n.gain.exponentialRampToValueAtTime(.5*E,s),n.gain.exponentialRampToValueAtTime(E,s+.325),n.gain.exponentialRampToValueAtTime(.01,s+2),r.pan.setValueAtTime(T,s),r.pan.exponentialRampToValueAtTime(-T,s+2),i.connect(n),n.connect(r),r.connect(t.destination),i.start(s),i.stop(s+2)},$t=(t,E,e,T,s,A,i)=>{var n=t.createOscillator(),r=t.createGain(),R=t.createStereoPanner(),O=t.createDynamicsCompressor(),A=A||e;n.frequency.setValueAtTime(E,s),n.frequency.exponentialRampToValueAtTime(E/1.5,s+.5),r.gain.setValueAtTime(.01,s),r.gain.exponentialRampToValueAtTime(A,s+1/32),r.gain.exponentialRampToValueAtTime(A/5,s+1/16),r.gain.linearRampToValueAtTime(0,s+.5),R.pan.setValueAtTime(i??T,s),O.threshold.setValueAtTime(-50,s),O.knee.setValueAtTime(40,s),O.ratio.setValueAtTime(12,s),O.attack.setValueAtTime(0,s),O.release.setValueAtTime(.25,s),n.connect(r),r.connect(R),R.connect(O),O.connect(t.destination),n.start(s),n.stop(s+.51)},$UB=(t,E,e=0,T)=>{var s=.04+.03*rand(),A=1/8+rand()/16,i=t.createOscillator(),n=t.createGain(),r=t.createStereoPanner();i.type="triangle",i.frequency.setValueAtTime(E,T),n.gain.setValueAtTime(s,T),n.gain.exponentialRampToValueAtTime(s/2,T+1/32),n.gain.linearRampToValueAtTime(0,T+A),r.pan.setValueAtTime(e,T),i.connect(n),n.connect(r),r.connect(t.destination),i.start(T),i.stop(T+A)},$B=()=>{let i=new AudioContext,E=-$b(D/4e3,10)%1,n=E,e=[0],r=[],T=[];var t=(t,E)=>{r=t||$vB(),T=E||$OB()},s=()=>{var t=i.currentTime;if(!(t+.25<n||n<0)){$Y(i,T[0]||2*Q[rand.$e(6)],.3,.5*rand.$u(),n,$oA(n-E)%3+4),T.push(T.shift());const A=1-$8($L(e.length-1,13))/2;$BA(e,t=>{const[E,e,T,s]=r[t];$BA(s,t=>$t(i,E,e*A,T,.25*t+n))}),n+=4}};return setInterval(s,100),$N("rattle",(t=0)=>{$UB(i,T[7-(beat+measure%8)%8]||Q[0],"number"==typeof t?t:0,i.currentTime)}),$N("beat",()=>{var[,t,E,,]=r[0];$t(i,Q[14],t,E,i.currentTime)}),$N("aah",()=>{console.log("Playing $Y"),$Y(i,2*(T[7-(beat+measure%8)%8]||Q[0]),.3,.5*rand.$u(),i.currentTime,6)}),$N("pause",()=>{"running"===i.state&&$PB?i.suspend():"suspended"!==i.state||$PB||i.resume()}),t(),s(),{fresh:t,n:n,get track(){return r},get voices(){return e},get melody(){return T},sing:(t=[],E)=>{e=[0,...t],T=E||T}}},$WA=($WB=({$EB:t=window.innerWidth,$MB:E=window.innerHeight,os:T=!1}={})=>{let s=T?null:document.createElement("canvas"),A=(s&&(s.width=t,s.height=E),T?new OffscreenCanvas(t,E):s.transferControlToOffscreen()),n=A.getContext("2d");A.width=t,A.height=E;const r={get $S(){return A.width},get $T(){return A.width/2},get $U(){return A.width/3},get $H(){return A.height},$I:A.height/2,get $J(){return A.height/3},get $O(){return min(r.$J,r.$U)},get Rm(){return min(r.$H,r.$S)},get $P(){return max(r.$H,r.$S)},$3:A,$1A:s,ctx:n,$VB:(t,E)=>{var e;T||(e=document.createElement("canvas"),s.replaceWith(e),(s=e).width=t,e.height=E,A=s.transferControlToOffscreen(),n=A.getContext("2d"),$m(r,{$3:A,ctx:n,$1A:s})),A.width=t,A.height=E,r.$I=A.height/2},$B:t=>(n.save(),t(r),n.restore(),r),E:()=>(n.clearRect(0,0,r.$S,r.$H),r),center:()=>(r.T(r.$T,r.$I),r),$D:(t="none")=>(n.filter=t,r),T:(t,E)=>(n.translate(t,E),r),R:(t,E)=>(n.rotate(t,E),r),$Q:(...t)=>(n.roundRect(...t),r),M:(...t)=>(n.moveTo(...t),r),L:(...t)=>(n.lineTo(...t),r),A:(t=0,E=0,e=1,T=0,s=$vA[1],A=!1)=>(n.arc(t,E,e,T,s,A),r),B:(...t)=>(n.bezierCurveTo(...t),r),P:t=>(n.beginPath(),t?.match(/[MLABCTREOSFW](?:\s*-?\d+(?:\.\d+)?|\s*#[a-f0-9]{3,8}|\s*hwb\([^)]+?\))*/g).forEach(t=>{var[t,...E]=t.includes("(")?[t[0],t.slice(1).trim()]:t.split(" ");r[t](...$h(E,t=>"#"===t[0]||t.includes("(")?t:parseFloat(t,10)))}),r),C:()=>(n.closePath(),r),O:t=>(n.globalAlpha=t,r),S:(t=1,E=1)=>(n.scale(t,E),r),$G:(e,T)=>$BA(T,(t,E)=>e.addColorStop(E/T.length,t)),$E:(t,E,e,T,s)=>{t=n.createLinearGradient(t,E,e,T);return r.$G(t,s),t},$F:(t,E,e,T,s,A,i)=>{t=n.createRadialGradient(t,E,e,T,s,A);return r.$G(t,i),t},F:t=>(n.fillStyle=t,n.fill(),r),$C:(t,E)=>(n.fillStyle=t,n.fill(E),r),W:(t,E)=>(n.strokeStyle=t,n.lineWidth=E,n.stroke(),r),$V:(t,E,e)=>(n.strokeStyle=t,n.lineWidth=E,n.stroke(e),r),$d:(...t)=>(n.drawImage(...t),r)};return r.E(),r.$A=t=>t.$A(r),r},()=>{const i=new Path2D;return i.M=(...t)=>(i.moveTo(...t),i),i.L=(...t)=>(i.lineTo(...t),i),i.A=(t=0,E=0,e=1,T=0,s=$vA[1],A=!1)=>(i.arc(t,E,e,T,s,A),i),i.$=(...t)=>(i.arcTo(...t),i),i.B=(...t)=>(i.bezierCurveTo(...t),i),i.Q=(...t)=>(i.quadraticBezierCurveTo(...t),i),i.C=()=>(i.closePath(),i),i}),$bA=(t,E)=>$WB({$EB:t,$MB:E||t,os:!0}),$q=(t=32,E="#840")=>{const e=$bA(3*t),T=t/4,s=1.4*t;return e.$B(()=>{e.E().center().P().A(0,0,t).C().F(E).P().M(-s,-T).L(s,-T).M(-s,T).L(s,T).M(-T,-s).L(-T,s).M(T,-s).L(T,s).W(E,3)}),{R:1.5*t,D:3*t,get $d(){return e.$3}}},$OA=(Array.$cB=()=>[],(a,d,m={},p="$9")=>{const dd=window[p].$cB?.()??[],o=dd.length,dv=$h(d,([,t])=>"function"==typeof t?t.toString().replace(/^\(\) ?=> ?/,""):JSON.stringify(t)).join(","),e=`window.${a}=class ${a} extends ${p}{`+`static $cB=()=>[...${p}.$cB(),${dv}];`+`constructor(...x){super(...(x.length ? x : ${a}.$cB()))}`+"*[Symbol.iterator]() {for(let i = 0,l=this.length;i<l;i++){yield this[i]}}"+$h(d,([t],E)=>`  get ${t}(){return this[${E+o}]} set ${t}(x){return this[${E+o}]=x}`).join("")+$h(Object.values(m),t=>t.toString()).join("")+"};";return eval(e)}),$X=$XB(1280,t=>4/((t+1)/10)*5).reduce((t,E,e)=>t.set((e+1)/10,E),new Map),$JA=($OA("$9",[["x",0],["y",0],["z",0],["age",0],["$s",[]],["$3A",null]],{$v(){return new this.constructor(...this)},$RA(t){return[this.x,this.y,this.z]=$RA(this,t),this},$o(t){return[this.x,this.y]=$o(this,t),this},$z(t){return new $9(...$z(this,t))},$l(){return $h([this.x,this.y,this.z],$xA)},$UA(t=1){return[this.x,this.y]=$UA([this.x,this.y],t),this},$yA(t=1){return this.$UA(this.$f()*t),this},$f(){return $f([this.x,this.y])},$ZA(t){var[E,e,T]=this.$C();return t.S(T,T),t.T(E,e),this},$C(){var[t,E,e]=this.$z($HB),T=E<0?4/-E*5:0;return[t*=4,E=4*e*T,T]},$4B(t=1){var[E,e,T]=this.$C(),s=(E*=T*$n,e*=T*$n,t?2*-$n*T:0);return new $9(E+$R.$T,e+$R.$I+s,2*T*(t?$n:1))},$nB(){var[t,E,e]=this.$4B();return $WA().A(t,E,abs(e)).C()},$0B(t){},$CB(){},$A(){},$2(){},$fB(){}},"Array"),$OA("$AA",[["$IA",null],["$M",[]],["$B",()=>{}]]),$OA("$9A",[["$r",0],["$3B",{}],["$ZB",null],["$BB",null],["$7A",null],["$0B",()=>{}]],{},"Array"),{w:0,a:0,s:0,d:0}),$zA=($OA("$Z",[["shell",null],["$AB",0],["$tA",0],["$oB",1],["$zB",1],["$hB",()=>new $9],["$pA",()=>new $9],["$9B",()=>new $9(1,1,0)],["$jB",[]],["w",0],["a",0],["s",0],["d",0],["$wB",2],["$pB",[]],["$lA",[]],["$gB",0],["$rB",[0,0,0]]],{$JB(){return this.$AB?abs(this.$AB):0},$7B(){var t=this.$tA%1;return t*=this.$hB.$f?.()||$K(t,1/32,31/32)?1:0,(this.$oB<0?1-t:t)%1},$iA(){return this.$7B()?$L(this.$7B()%.5,.5)%1:1-bar%.5*2%1},$0B(t){t/=1e3;this.$7B(),this.$JB();let{w:E,a:e,s:T,d:s}=this;var A=$xA(this.x)+128,i=$xA(this.y)+128,n=this.$jB.filter(t=>t.$r<=$r),n=(n.length?($BA(n,t=>{var E,e;t.$BB=t.$BB||t.$r,t.$ZB?($f(this,t.$ZB),.5<t.$ZB.$v().$yA(-1).$RA(this).$f()?(t.$r=$r,E=abs(this.x-t.$ZB.x),e=abs(this.y-t.$ZB.y),E=$L(E,1)>3/8?1:0,e=$L(e,1)>3/8?1:0,$m(t.$3B,this.x>t.$ZB.x?{a:E,d:0}:{a:0,d:E},this.y>t.$ZB.y?{w:e,s:0}:{w:0,s:e})):(t.$7A=t.$r,this.$jB.push(new $9A($r+1,$JA,null),new $9A($r+12,$JA,null)))):(t.$r=-1,t.$7A=$r),$m(this,t.$3B)}),n.length&&({w:E,a:e,s:T,d:s}=this),this.$jB=this.$jB.filter(t=>!t.$7A||t.$7A>$r)):$m(this,{w:0,a:0,s:0,d:0}),this.$pA=new $9(-e+s,-E+T,0),this.$oB=$4A(this.$pA.x||this.$oB),this.$zB=$4A(this.$pA.y||this.$zB),new $9(...this.$pA)),r=new $9(...this.$hB),R=this.$iA();if(0===n.$f()&&$K(r.$f(),1/16,R)&&n.$RA(new $9(...this.$9B).$UA((1-R)/2)),n.$UA(4*t),this.$pA.$f()){const T=.75+$L(n.$v().$UA(2).$RA(r.$v().$UA(1)).$f(),3)/4;r.$yA(T)}r.$RA(n),r.$UA(min(r.$f(),this.$wB));var O,n=(this.$hB=r).$f(),a=new $9(...r);a.$UA(a.$f()*t);const h=$RA(this,a);this.$s.length&&!this.$s.find(t=>$f($z(t,h))<t.$TB)&&a.$yA(-.5);let I=$xA(this.x+a.x)+128,S=$xA(this.y+a.y)+128;if(A===I&&i===S||((O=world.$GA[S][I])&&O!==this&&(a.$yA(-.5),I=$xA(this.x+a.x)+128,S=$xA(this.y+a.y)+128),world.$GA[i][A]=null,world.$GA[S][I]=this),this.$RA(a),this.$tA+=a.$f(),this.$AB=n*this.$oB,this.$9B=n?r.$v().$UA(1):this.$9B,this.$pA.$f()<.25&&r.$f()&&r.$yA(this.$iA()<1/8?0:$j(1-2*t,1)),0===r.$f()&&this.$7B()&&R&&(r.$yA(0),this.$tA=$xA(2*this.$tA)/2),this===$RB){const T=$oA(this.$tA/.25);T>this.$gB&&$DA("rattle",this.$9B.x/-2),this.$gB=T}this.$rB=this.$4B()},$CB(){var t;this.$jB?.length||(t=this.$s[0],this.$jB=[new $9A($r,{},t.$v().$RA(new $9(0,2+rand.$e(t.$TB-2),0).$o(rand()*$IB)))])}},"$9"),({$y:E=512,$lA:s=[]}={})=>{const A=$bA(E),T=E/2,i=E/12,e={R:T,$y:E,$lA:s,$A:(t=A)=>(t.$B(()=>{let e=5.6*i;t===A&&t.E().center(),t.P().A(0,0,T).C().F(t.$F(0,2*i,4*i,0,0,E,["#242","#262"])),A.P().A(0,0,e),$XB(28,t=>{var[t,E]=$o([1,0],$vA[28]*(t-.5)-$vA[4]);A.M(t*e,E*e).L(t*T,E*T)}),A.W(A.$F(0,2*i,3*i,0,0,E,["#3536","#4846"]),2),$XB(13,t=>{let E=0,e=(t-11)*i*2.25;var T;t<10&&(T=$vA[10]*(t-2),[E,e]=$o([4.5*i,0],T)),A.P().A(E,e,i).C().F("rgba(127,127,127,0.25)"),s[t]&&A.P().A(E,e,i).C().F("#aa9")})}),e),add(t){return s.push(t),e.$A(),e},get $d(){return A.$3}};return e.$A(),e}),$tB=new Map,$nA=($OA("$QB",[["$hA",()=>`hwb(${$xA(30+10*rand.$u()-2)} ${$xA(0+10*rand())}% ${$xA(47+10*rand())}%)`],["$YB",()=>`hwb(${$xA(30+2*rand.$u()-2)} 0% ${$xA(67+4*rand())}%)`]],{$WA(t,E,e,T,s){var A,i,n,r,R,O,[t,E,e,T,s]=[$b(t,4),$b(E,64),e,T,$b(s[0],4)],T=[t,E,e,T,s].join();return $tB.has(T)||(A=$EA(E)/8,i=t?t/8:$EA(E)/16,n=$mA(E)/8,abs(t/16),[E,r]=[t?$cA(E):[0,0],t?$cA(1-E):[0,0]],[[E,r],[R,O]]=[E,r],s=sqrt(abs(s)/(abs(t)||1)),$tB.set(T,$WA().A(0+i*s,n-3,1,$IB[4],$IB).M(0+i*s,n-2).L(2+R/3,A*e-1.5).L(1+E/16,A*e-1).L(1+E*s,r).L(0,n-1).L(-1-R*s,O).L(R/16-1,-1-A*e).L(-2-E/3,-1.5-A*e).C())),$tB.get(T)},$A(i,n=bar%.5*2,r=!0){i.$B(()=>{r&&this.$ZA(i);var t=this.$7B()%.5,t=t?$L(t%.5,.5):1-n,E=this["$AB"];let e=E?E/8:$EA(t)/16,T=$mA(t)/8,s=abs(E/16);const A=sqrt(abs(this.$hB[0])/(abs(E)||1));this.shell&&0<this.$zB&&i.P().A(0-e*A/2,-1.75-T/2+s,7/8).C().W("#242",1/16).F("#131");E=this.$WA(this.$AB,t,this.$oB,this.$zB,this.$hB);i.$V(this.$YB,1/8,E).$C(this.$hA,E),this.shell&&(this.$zB<0||$PB)&&i.$B(()=>{i.P().A(0-e*A/2,-1.75-T/2+s,7/8).C(),i.W("#242",1/16),i.T(0-e*A/2,-1.75-T/2+s),i.R(this.$hB[0]/16),i.$d(shell.$d,-1,-1,2,2)})})}},"$Z"),$OA("$x",[],{$A(A){A.$B(()=>{this.$ZA(A),A.S(this.$oB,1);var t=this.$AB,[E,e]=t?$cA(this.$iA()):[0,0],[T,s]=t?$cA(1-this.$iA()):[0,0],[[T,s],[E,e]]=0<this.$oB?[[E,e],[T,s]]:[[T,s],[E,e]],t=sqrt(abs(this.$hB[0])/(abs(t)||1));A.P().M(1,s/4-2).L(0-E*t,0+e).L(0,s/4-1).C().M(-1,e/4-1).L(T*t-1,0+s).L(-2,e/4-1.5).C().F("#520"),A.P().M(1,s/4-3).L(2,s/4-2).L(1,s/4-2).L(1+T*t,0+s).L(0,s/4-1).L(-1,e/4-1).L(-2-E*t,0+e).L(-2,e/4-1.5).L(-1.75,e/4-1.75).L(-2,e/4-2).L(0,s/4-2).L(.5,s/4-2.5).L(0,s/4-3).C().W("#620",1/8).F("#840"),A.P().A(1,s/4-4,1,$vA[2],1,!0).W("#620",.125)})}},"$Z"),$OA("$fA",[],{$A(A,t,E,e){A.$B(()=>{this.$ZA(A),A.S(this.$oB,1);var t=this.$AB,[E,e]=t?$cA(this.$iA()):[0,0],[T,s]=t?$cA(1-this.$iA()):[0,0],[[T,s],[E,e]]=0<this.$oB?[[E,e],[T,s]]:[[T,s],[E,e]],t=sqrt(abs(this.$hB[0])/(abs(t)||1));A.P().M(1,s/4-2).L(0-E*t,0+e).L(0,s/4-1).C().M(-1,e/4-1).L(T*t-1,0+s).L(-2,e/4-1.5).C().F("#520"),A.P().M(2,s/4-2).L(2,s/4-1).L(1.5,s/4-.5).L(1,s/4-1).L(1+T*t,0+s).L(0,s/4-1).L(-1,e/4-1).L(-2-E*t,0+e).L(-2,e/4-1.5).L(-1.75,e/4-1.75).L(-2,e/4-2).L(0,s/4-3).L(1,s/4-2.25).L(1.5,s/4-2.5).C().stroke("#620",1/8).F("#840"),A.P().A(2,s/4-2.25,.75,$vA[2],$vA[2]+$vA[7]).stroke("#620",.125)})}},"$Z"),$OA("$QA",[["$uA",0],["$TB",32],["$hA","#ccf"],["$YB","#ccf4"]],{$A(i){i.$B(()=>{var t,E,{$uA:e,$TB:T}=this,s=T-1,A=1.3*T;e&&(t=$1B(cos($vA[28]*e)*A),E=e<14?t:-A,e=14<e?-t:A,i.P().M(0,s).B(e,T,e,-T,0,-s).B(E,-T,E,T,0,s).C().F(this.$hA)),i.P().A(0,0,s).C().W(this.$YB,T/16)})},$qA(){return abs(sin($vA[2]*this.$uA/28))}},"$9"),$OA("$s",[["$hA",()=>`hwb(${120+rand.$e(25)} ${10+rand.$e(5)}% ${$xA(65+rand.$e(5))}%)`],["$TB",16],["$SB",[]],["$dB",[]],["$qB",[]],["$aB",0],["$jA",null]],{$eB(E=16){this.$TB=E;rand();return this.$SB=$XB(16,t=>new $9(0,-E,0).$o($vA[16]*(t+rand()/4))),this},$0B(E){var t=this.$TB+1,[e]=new $9(-t,-t,0).$RA(this).$4B(),[t]=new $9(t,-t,0).$RA(this).$4B();this.$aB=t<=0||e>=$R.$S?0:1,$BA(this.$qB,t=>t.$0B(E))},$A(n){if(this.$aB)return n.$B(()=>{let i=0,t=new $9;var E=$h(this.$SB,(e,T)=>{t.splice(0,t.length,...e);var[e,s,A]=t.$RA(this).$C();if(A){i=max(i,A);let t=e*A,E=s*A;return()=>(T?n.L:n.M)(t,E)}return()=>{}});n.P(),$BA(E,t=>t()),n.C().O(.25).F(this.$hA).W(this.$hA,2/32),n.P(`M ${$b(l)} ${$b(u)} L ${$b(r)} ${$b(u)} W #0f0 4`)}),n.$3}},"$9"),$OA("$dA",[["$R",null]],{$A(t){return this.$R||(this.$R=$WB({$EB:64,$MB:64}).P().M(...rand.$W(1,28)).L(...rand.$W(24,24)).L(...rand.$W(21,12)).L(...rand.$W(31,11)).L(...rand.$W(33,23)).L(...rand.$W(47,14)).L(...rand.$W(53,21)).L(...rand.$W(61,31)).L(...rand.$W(52,44)).L(...rand.$W(42,47)).L(...rand.$W(43,43)).L(...rand.$W(39,48)).L(...rand.$W(16,57)).L(...rand.$W(9,54)).L(...rand.$W(3,42)).C().F(rand.$c(15,2,17,2,68,4))),t.$d(this.$R.$3,0,0,64,64),t}},"$9"),$OA("$YA",[["$WA",""],["$R",null],["$EB",0],["$MB",0],["$TA",0],["$hA",()=>rand.$c(150,2,10,6,80,4)]],{$eB(t){return this.$3A=rand.$B(this.$3A,()=>{const A=min(8,this.$0=t||this.$0||4*rand()+3),i=ceil(A);let n=0,r=0,R=0;this.$WA=$XB(i,t=>{var E=(A-t)/(A-t+3),e=n-E/.125,T=E*(i-t),s=n+E+.5,t=$L(A-t,i),E=$b(rand.$u()*t*E/2),T=(r=max(T,r),`M ${E} ${$b(e)} L ${$b(-T)} ${$b(s)-rand()*t} L ${$b(R)} ${$b(n+.25)} L ${$b(T)} ${$b(s)-rand()*t} L ${E} `+$b(e));return R=E,n=e,T}).join(" ")+` F ${this.$hA} S #1218`,this.$EB=ceil(2*r),this.$MB=ceil(abs(n)),this.$R=$WB({$EB:this.$EB*$n*4,$MB:this.$MB*$n*4,os:!0}),this.$R.$B(t=>t.S($n,$n).T(this.$EB/2,this.$MB).P(this.$WA))}),this},$A(t){if(this.$R)return t.$B(()=>{this.$ZA(t),t.$d(this.$R.$3,-this.$EB/2,-this.$MB,4*this.$EB,4*this.$MB)}),this},$0B(t){this.$TA=this.$TA||4+rand.$e(284),$r>=this.$TA&&(this.$eB(this.$0+(rand()+1)/8),this.$TA=$r+576)},$2(t){return 2<this.$0&&this.$z(t).$f()<=4},$fB(t){console.log("$YA $fB");var E=$m(new $dA);t.$pB.push(E),this.$eB(--this.$0),$DA("beat")}},"$9"),$OA("$LB",[["$R",null],["$uA",0],["$hA",()=>rand.$c(180,4,33,3,55,4)],["$LA",-1],["$EB",4],["$MB",4],["$gA",!1]],{$eB(){const e=this.$gA,T=(this.$R=this.$R??$bA(this.$EB*$n*4,this.$MB*$n*4),rand.$u()/4);var t=e?-2:-1.5;const s=rand()/8,A=t+s;return this.$R.$B(t=>{var E;t.E().S($n,$n).T(this.$EB/2,this.$MB).P().M(-1.5-T,0).B(-2.5,-3,-1,-3,T,s-2).B(1,-3,2.5,-3,1.5+T,0).C().F(this.$hA).P().M(0,0).B(2*-T,-s,4*T,A,T,A).W("#0002",1/8),t.P().A(T,A,e?.75:1/8).F(`hwb(${$xA((180/28*this.$uA+240+rand.$u()/4)%360)} ${$xA(10+25*rand())}% 5%)`),this.$gA&&(E=$m(new $QA,{$TB:10,$uA:this.$uA,$hA:"#ccf",$YB:"#000a"}),t.O(.5).T(1.25*T,A).S(1/16,1/16),E.$A(t))}),this},$A(t,E){if(this.$R)return E?t.$d(this.$R.$3,0,0,256,256):t.$B(()=>{this.$ZA(t),t.$d(this.$R.$3,-this.$EB/2,-this.$MB,4*this.$EB,4*this.$MB)}),t},$0B(t,E,e){var E=E??moon?.$uA,e=e??$HA;return E!==this.$LA&&.5<=e&&(e=((this.$LA=E)+28-this.$uA)%28<3,this.$gA=e,this.$eB()),this},$2(t){return this.$gA&&this.$z(t).$f()<=2},$fB(t){console.log("$LB $fB");var E=$m(this.$v(),{$R:null});t.$pB.push(E.$eB()),this.$gA=!1,this.$eB(),$DA("aah")}},"$9"),new Map),$R=($OA("$FA",[["$g",()=>new $dA],["O",()=>rand()]],{$A(s,t){s.$B(()=>{this.$ZA(s);var t,E,e,T=$b((this.O+bar%.5*2)%1,64);s.$B(()=>s.T(-1.5,-2.125).S(1/32,1/32).$A(this.$g)),s.$B(()=>s.T(1.5,-2).S(-1/32,1/32).$A(this.$g)),$nA.has(T)||(t=$bA(128,256),E=$EA(T),e=$EA((T+.25)%1),t.S(64,64).T(1,4).P().M(1,-1.5).A(0,-1.5,1,0,$vA[2]).B(-1,-2.5-e/2,0+E,-2.5-e,0-E/2,-3.5).B(0-E,-2.5-e,1,-2.5-e/2,1,-1.5).F(s.$F(0,-1.25,.5+e/8,0,0,4-e/4,["#ff0a","#e206","#d004"])),$nA.set(T,t)),s.$d($nA.get(T).$3,-1,-4,2,4)})}},"$9"),$OA("$FB",[["$3A",13],["$0",0],["$rA",[]],["$lA",[]],["$KB",[]],["$GA",()=>$XB(256,t=>$XB(256,t=>null))],["$eA",[]],["$h",null],["$oA",null],["$8B",[]],["$dB",[]],["$qB",[]],["$yB",[]]],{$eB(t){this.$h=this.$h||$WB({$EB:256,$MB:256,os:!0}),this.$oA=this.$oA||$WB({$EB:256,$MB:256,os:!0}),this.$3A=t,rand.$3A(t);this.$rA=$XB(28,t=>(new $s).$eB(12).$RA([96,0,0]).$o(t*$vA[28]-$vA[4])),this.$lA=$XB(13,t=>t<10?(new $s).$eB(18).$RA([80,0,0]).$o($vA[10]*(t+2.5)):(new $s).$eB(18).$RA([0,16*(t-11)*2.5,0])),this.$eA=[...this.$rA,...this.$lA],$BA(this.$rA,(e,t)=>{e.$SA="moon "+t,$BA(e.$SB,E=>{var t;this.$eA.filter(t=>E.$v().$RA(e).$z(t).$f()<=t.$TB+.05).length<2&&((t=(new $YA).$eB().$RA(e).$RA(E)).$s.push(e),e.$qB.push(t),this.$qB.push(t))});t=$m(new $LB,{x:e.x,y:e.y,$uA:t}).$0B(0,0,.5);e.$qB.push(t),this.$qB.push(t)}),$BA(this.$lA,(E,t)=>{E.$dB.push((new $FA).$RA(E)),$XB(3,t=>{t=(new $QB).$RA(new $9(0,6+rand.$e(6),0).$o($vA[3]*(t+rand.$u()/8)).$RA(E));E.$dB.push(t),t.$s.push(E)})}),this.$dB.push(...$h(this.$eA,t=>t.$dB).flat().sort($uB)),this.$h.$B(T=>{T.E().center(),$BA(this.$eA,e=>{T.P(),$BA(e.$SB,(t,E)=>(E?T.L:T.M)(t[0]+e.x,t[1]+e.y)),T.C().F(T.$F(0,90,90,0,0,256,["#242","#262"])).O(.25).W(T.$F(0,184,276,0,0,256,["#353","#484"]),1).O(1)})}),this.$oA.P().A(128,128,108).W("#202",16).C().P().A(128,112,48).F(this.$oA.$F(128,128,32,128,128,256,["hwb(250deg 14% 57%)","hwb(220deg 65% 12%)"])),this.$oA.$d(this.$h.$3,0,0,256,256);const e=$m(new $QA,{$TB:10});return $BA(this.$rA,(E,t)=>{$m(e,{$uA:t}),this.$oA.$B(t=>{t.T(128+E.x,128+E.y).O(.875).P().A(0,0,E.$TB).F(E.$hA).O(.125),e.$A(t)})}),this.$oA.$B(t=>{t.center(),$BA(this.$qB.filter(t=>!(t instanceof $LB)),t=>this.$oA.P().A(t.x,t.y+.5,1.25).F(t.$hA))}),$BA([...this.$dB,...this.$qB,$RB],t=>{t.y=$2B(t.y),t.x=$2B(t.x),this.$GA[t.y+128][t.x+128]=t}),this},$2A(){},$MA(){},$0B(E){return $RB.$s=this.$eA.filter(t=>$f($z(t,$RB))<t.$TB),$BA(this.$eA,t=>t.$0B(E)),this},$A(E){this.$yB.length=0;var e=-E.$T/$n,T=E.$S/$n;for(let t=0;t<=256&&!(t>$HB.y+132);t+=1){var s=new $9($HB.x,t-128,0).$4B(0),A=s[2];if(0===A)break;var i=A*$n*2,n=max(0,$oA($HB.x+128-E.$T/i)-4);min(256-n,ceil(E.$S/i)+8);E.$d(this.$oA.$3,$HB.x+128-E.$T/i,t,E.$S/i,1,e,(s[1]-E.$I)/$n,T,2*A),$BA($6A(this.$GA[t].filter(t=>t),$uB),t=>{t.$A(E),t.$2?.($RB)&&this.$yB.unshift(t)})}return E.$3}},"$9"),$WB());let moon=new $QA,sun=$q(32,"#ffd"),rand=$wA(13),stars=$XB(91,()=>[rand.$u(),rand.$u()]),shell=$zA(),$RB=$m(new $QB,{x:0,y:104,z:0,shell:shell,$zB:-1,$hA:"#840",$YB:"#620"}),$sA=new $9,world=($sA.$WA=$WA().M(-2,-2).L(2,2).L(-2,2).L(2,-2).C(),(new $FB).$eB(13)),entities=[],$sB=20,$bB=-2,$xB=4,$mB=-1/8,$HB=new $9($RB.x,$RB.y+$xB,$RB.z+$mB);const $aA=E=>{$PB||(D+=E*$0A,$w=$oA(D/$4),$HA=D%$4/$4,measure=$oA(D/4e3),bar=D%4e3/4e3,beat=$oA(8*bar),$r=$oA(D/250),$LA!==$r&&$DA("tick"),$LA=$r,step=D%$1/$1,$KA.change&&$RB.$jB.unshift($m(new $9A,{$r:$r,$3B:$KA.$RA})),$KA.shift?$RB.$wB=4:$RB.$wB=2,world.$0B(E),$RB.$0B(E),$BA(world.$dB,t=>t.$0B?.(E))),$HB.x+=($RB.x-$HB.x)/16,$HB.y+=($RB.y+($PB?$xB:$sB)-$HB.y)/16,$HB.z+=($RB.z-$HB.z+($PB?$mB:$bB))/16};let $PA=$XB(256,t=>[t,t]).flat().map(t=>t/$n);const $NA=(t=0)=>{performance.now();var E=t-now;now=t,$aA(E*$0A);const{$H:e,$I:n,$J:T,$S:s,$T:r,$U:A,$O:R,$P:O}=$R;var t=$HA,E=t;const a=(t+.5)%1;moon.$uA=D?$oA((28+(D-$lB()*$4)/$4)%28):0;let h=$6B(E)*A;const I=$iB(E);let S=$6B(a)*A;const P=$iB(a);.5<t?h=-S:S=-h;let L;$R.$B(()=>{if($R.E(),$R.ctx.fillStyle=.1<I?"#840":"#202",$R.ctx.fillRect(0,0,s,e),$R.center(),.25<P){const i=T-P*T*2;$BA(stars,([t,E])=>{var e=t*r,T=(E-a)*n,s=$L($f([S,i],[e,T]),4*moon.$TB),A=1+.5*sin((7.3*E+now%$4/$4+1.1*t)*$IB),E=(1+A)**2*max(0,sin(7.3*E+now/$4*130+11*t)**3);$R.O(max(0,1-moon.$qA()/2-(s<.25?1:1-s))).P().A(e,T,A).F("#ffd").C(),$R.P().M(e,T-E).L(e,T+E).M(e-E,T).L(e+E,T).W("#ffd",.5)}),L=`rgba(204,204,255,${$b(.1*moon.$qA())})`,$R.O(max(0,P)).P().A(S,i,2*O).C().F($R.$F(S,i,R*moon.$qA(),S,i,2*R,[`rgba(204,204,255,${$b(.05+.2*moon.$qA())})`,L,L,"rgba(24,0,24,0)"])).T(S,i),moon.$A($R),L="#ccf6"}.25<I&&($R.O(max(0,I)),L="#aae6",$R.P().A(h,T-I*T*2,2*O).C().F($R.$F(h,T-I*T*2,sun.R*max(I,0),h,T-I*T*2,O,["#fff","#aae","#aaec","rgba(170,170,238,0)"])).$d(sun.$d,h-sun.R,T-I*T*2-sun.R,sun.D,sun.D))}),$R.$B(()=>{$R.T(r,n),$R.S($n,$n),world.$A($R)}),$R.$B(()=>$R.T($sA.x-2,$sA.y-2).S(4,4).R($IB*$EA(now%4e3/4e3)).$C("#2808",$sA.$WA)),$sA.$ZB=$PB?null:world.$yB.find(t=>$R.ctx.isPointInPath(t.$nB(),$sA.x,$sA.y)),$sA.$ZB&&$R.$B(()=>{var t=$sA.$ZB.$nB();$R.ctx.setLineDash([13,7]),$R.ctx.lineDashOffset=now/1e3*20,$R.$V("#280",1,t)});const i=$RB.$pB.length;$BA($RB.$pB,(E,t)=>{const e=($R.$S-128)/(i+1)*(t+1)+64,T=$R.$H-128;$R.$B(t=>E.$A(t.T(e,T).P().$Q(0,0,64,64,4).C().F("#fff4"),!0))}),$A||($R.ctx.fillStyle="#0f0",$R.ctx.font="32px monospace",E="Click to begin",$R.ctx.fillText(E,$R.$T-$R.ctx.measureText(E).width/2,$R.$J)),requestAnimationFrame($NA)},$KA=($NA(0),{w:0,a:0,s:0,d:0,get change(){return this.w+this.a+this.s+this.d},get $RA(){var{w:t,a:E,s:e,d:T}=this;return{w:t,a:E,s:e,d:T}}}),$NB=($VA("mousedown",()=>{$PB=!1,$A=$B()}),$N("click",()=>$sA.$ZB?.$fB($RB)),$N("keydown",t=>{$DA("input");t=t.key.toLowerCase();$KA[t]=1,$DA("key-"+t),"escape"===t&&($PB=!$PB,$DA("pause"))}),$N("keyup",t=>$KA[t.key.toLowerCase()]=0),$N("mousedown",()=>$DA("input")),$N("mousemove",({clientX:t,clientY:E})=>$m($sA,{x:t,y:E})),$N("resize",()=>{$R.$VB(window.innerWidth,window.innerHeight)}),$BA(["visibilitychange","blur"],t=>$N(t,()=>{$BA(Object.keys($KA),t=>$KA[t]=0)})),(t,E,e)=>t.addEventListener(E,e));$BA(["mousedown","mouseup","mousemove","click","keydown","keyup","visibilitychange"],E=>$NB(document,E,(...t)=>$DA(E,...t))),$BA(["resize","blur"],E=>$NB(window,E,(...t)=>$DA(E,...t))),document.body.appendChild($R.$1A);})()</script></body>